{"Bert Deacon's position was rover.": [{"url": "https://trove.nla.gov.au/newspaper/article/23192526", "page_content": "Word position Original Corrected Automatically move the image to show word locations Word properties X Pos\n\nY Pos\n\nWidth\n\nHeight Mouse: X 0 , Y 0 Remove extra words Cancel\n\nParagraphs Paragraph operations are made directly in the full article text panel located to the left.\n\nParagraph operations include: Adjust the order paragraphs\n\nAdd new blank paragraphs\n\nDuplicate an existing paragraph\n\nRemove a paragraph Cancel\n\nZones Zone operations are made directly in the full article text panel located to the left.\n\nZone operations include: Adjust the order of zones\n\nAdd new blank zone\n\nRemove a zone Zone properties X Pos\n\nY Pos\n\nWidth\n\nHeight Mouse: X 0 , Y 0 Cancel\n\nTables Tables.\n\nComing soon Table properties X Pos\n\nY Pos\n\nWidth\n\nHeight Mouse: X 0 , Y 0 Cancel\n\nIllustrations Illustration properties X Pos\n\nY Pos\n\nWidth\n\nHeight Mouse: X 0 , Y 0 Caption Cancel"}, {"url": "https://blog.csdn.net/sinat_20829389/article/details/114959871", "page_content": "\u4f7f\u7528Hugginface\u7684Transformers\u5e93\u5feb\u901f\u5fae\u8c03BERT\u7b49\u9884\u8bad\u7ec3\u6a21\u578b\uff0c\u4f7f\u5176\u9002\u5e94\u4e0b\u6e38\u4efb\u52a1\uff0c\u672c\u6587\u4ee5Quora\u95ee\u9898\u5bf9\u4efb\u52a1\u4e3a\u4f8b\uff0c\u5bf9\u4e24\u95ee\u9898\u8868\u610f\u662f\u5426\u4e00\u81f4\u8fdb\u884c\u9884\u6d4b\n\n\u4ecb\u7ecd\n\n\u4e4b\u524d\u5199\u4e86\u4e2a\u5fae\u8c03BERT\u7684\u5165\u95e8\u6559\u7a0b\uff0c\u6b65\u9aa4\u6bd4\u8f83\u591a\uff0c\u6211\u540e\u6765\u628a\u5b83\u90fd\u5c01\u88c5\u6210\u51fd\u6570\u4e86\uff0c\u4f46\u7528\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u9ebb\u70e6\uff0c\u800c\u4e14\u6709\u65f6\u5019Transformer\u5e93\u91cc\u4e00\u4e9b\u51fd\u6570\u65b9\u6cd5\u4f1a\u6539\u52a8\uff0c\u8fd9\u5c31\u8fd8\u8981\u5bf9\u4ee3\u7801\u8fdb\u884c\u8c03\u6574\u3002\u6700\u8fd1\u770bTransformers\u7684\u6587\u6863\uff0c\u53d1\u73b0\u5b83\u81ea\u5df1\u5c01\u88c5\u4e86\u4e00\u4e2a Trainer \u51fd\u6570\uff0c\u5f88\u597d\u7528\uff0c\u5206\u4eab\u4e00\u4e0b\n\n\u672c\u6587\u5b8c\u6574\u7684jupyter notebook\u5730\u5740\u4e3a\uff1ahttps://github.com/yxf975/PTMs_learning/blob/main/%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83.ipynb\n\n\u8fd9\u6b21\u4f9d\u7136\u8fd8\u662f\u5728Quora\u95ee\u9898\u5bf9\u6570\u636e\u96c6\u4e0a\u8fdb\u884c\uff0c\u4efb\u52a1\u8fd9\u91cc\u518d\u91cd\u590d\u4e00\u904d\uff0c\u5c31\u662f\u7ed9\u5b9a\u7684\u4e24\u4e2a\u95ee\u9898\uff0c\u9884\u6d4b\u5176\u8868\u8fbe\u7684\u610f\u601d\u662f\u5426\u662f\u76f8\u4f3c\u7684\u3002\u8fd9\u4e2a\u4efb\u52a1\u662f\u5efa\u7acb\u5728\u8fd9\u6837\u7684\u5e94\u7528\u573a\u666f\u4e0b\u7684\uff0c\u5728Quora\u8fd9\u4e2a\u8f6f\u4ef6\u91cc\uff0c\u5f88\u591a\u4eba\u53ef\u80fd\u56de\u95ee\u76f8\u4f3c\u6216\u540c\u6837\u7684\u95ee\u9898\uff0c\u4f46\u5f80\u5f80\u6bcf\u4e2a\u95ee\u9898\u90fd\u9700\u8981\u6765\u5bf9\u5176\u91cd\u590d\u89e3\u7b54\uff0c\u5f88\u4e0d\u6548\u7387\u3002\u56e0\u6b64\u5982\u679c\u6211\u4eec\u6709\u4e2a\u80fd\u5224\u5b9a\u95ee\u9898\u662f\u5426\u76f8\u4f3c\u6216\u4e00\u81f4\u7684\u7b97\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u80fd\u7ed9\u51fa\u4e4b\u524d\u76f8\u4f3c\u95ee\u9898\u7684\u7b54\u6848\uff0c\u63d0\u9ad8\u6548\u7387\u3002\n\n\u5b89\u88c5\u76f8\u5e94\u7684\u5e93\u548c\u5bfc\u5165\u5305\n\n\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\u3002\u9996\u5148\u5148\u5b89\u88c5\u76f8\u5e94\u7684\u5e93\uff0c\u4e00\u4e2a\u662f\u719f\u77e5\u7684Hugginface\u7684transformers\uff0c\u53e6\u4e00\u4e2a\u662fHugginface\u7684nlp\u6570\u636e\u96c6\u5e93\uff0c\u610f\u5473\u7740\u6211\u4eec\u4e4b\u540e\u76f4\u63a5\u7528\u8fd9\u4e2a\u5e93\u8f7d\u5165\u6570\u636e\u3002\n\n!pip install transformers !pip install nlp\n\n\u4e4b\u540e\u5bfc\u5165\u9700\u8981\u7528\u7684\u5305\n\nimport torch import pandas as pd from sklearn . model_selection import train_test_split from transformers import BertForSequenceClassification , Trainer , TrainingArguments , BertTokenizerFast from nlp import load_dataset from nlp import Dataset from sklearn . metrics import accuracy_score , precision_recall_fscore_support , log_loss from scipy . special import softmax\n\n\u8f7d\u5165\u6570\u636e\u96c6\n\n\u8fd9\u91cc\u6709\u4e24\u79cd\u65b9\u60c5\u51b5\uff1a\u4e00\u4e2a\u662f\u8f7d\u5165nlp\u5e93\u91cc\u7684\u6570\u636e\u96c6\uff0c\u8fd8\u6709\u4e00\u4e2a\u5c31\u662f\u4f7f\u7528\u672c\u5730\u7684\u6570\u636e\u96c6\uff0c\u63a5\u4e0b\u6765\u5bf9\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u6765\u5c1d\u8bd5\u4e00\u4e0b\n\n\u8f7d\u5165nlp\u5e93\u91cc\u7684\u6570\u636e\u96c6\n\n\u8f7d\u5165\u6570\u636e\u96c6\uff0c\u4f7f\u7528nlp.load_dataset\u65b9\u6cd5\uff0c\u5177\u4f53\u5b8c\u6574\u7684\u6587\u6863\u5730\u5740\u4e3ahttps://huggingface.co/docs/datasets/v0.3.0/index.html\u3002\n\ntrain_dataset = load_dataset ( 'quora' , split = 'train[:20%]' ) validation_dataset = load_dataset ( 'quora' , split = 'train[30%:35%]' ) test_dataset = load_dataset ( 'quora' , split = 'train[-10%:]' )\n\n\u63a5\u7740\u5bfc\u5165\u9884\u8bad\u7ec3\u6a21\u578b\u7684\u5206\u8bcd\u5668\u548c\u6a21\u578b\uff0c\u8fd9\u91cc\u6211\u7528\u7684\u8fd8\u662fBERT_BASE\u6a21\u578b\n\ntokenizer = BertTokenizerFast . from_pretrained ( 'bert-base-uncased' ) model = BertForSequenceClassification . from_pretrained ( 'bert-base-uncased' , num_labels = 2 , output_hidden_states = False )\n\n\u9884\u5904\u7406\u51fd\u6570\uff0c\u8fd9\u91cc\u662f\u4e3a\u4e86\u63d0\u53d6\u51fa\u6bcf\u6761\u6837\u672c\u4e2d\u7684\u95ee\u9898\u6587\u672c\u5e76\u8fdb\u884c\u5206\u8bcd\u64cd\u4f5c\u4ee5\u53calabel\uff0c\u5177\u4f53\u539f\u6570\u636e\u96c6\u7684\u5f62\u5f0f\u53ef\u4ee5\u81ea\u884c\u67e5\u770b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002\u53e6\u5916\u8fd9\u91cc\u8d85\u53c2\u5e8f\u5217\u957f\u5ea6 max_length \u662f\u5728\u8fd9\u90e8\u5206\u8bbe\u7f6e\u7684\uff0c\u4e3a\u4e86\u8dd1\u7684\u5feb\u4e00\u70b9\u6211\u8bbe\u7f6e\u7684\u5f88\u5c0f\uff0c\u6700\u5927\u4e3a512\u3002\n\ndef preprocess_function ( examples ) : result = tokenizer ( [ examples [ 'questions' ] [ i ] [ 'text' ] [ 0 ] for i in range ( len ( examples [ 'questions' ] ) ) ] , [ examples [ 'questions' ] [ i ] [ 'text' ] [ 1 ] for i in range ( len ( examples [ 'questions' ] ) ) ] , padding = True , truncation = True , max_length = 32 ) result [ \"label\" ] = [ ( 1 if l else 0 ) for l in examples [ \"is_duplicate\" ] ] return result\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u8981\u5c06\u8fd9\u4e9b\u6570\u636e\u8f6c\u5316\u4e3aBERT\u7684\u8f93\u5165\uff0c\u6839\u636e\u8bba\u6587\u4e0aBERT\u8f93\u5165\u5305\u62ecToken Embedding, Segment Embedding \u548c Position Embedding\u3002\u90a3\u4e48\u8fd9\u91cc\u4f1a\u6839\u636e input_ids \u5f97\u5230Token Embedding\uff0c token_type_ids \u5f97\u5230Segment Embedding\uff0c\u81f3\u4e8e\u4f4d\u7f6e\u7f16\u7801\uff0c\u5728BERT\u4e2d\u662f\u5b8c\u5168\u901a\u8fc7\u8bad\u7ec3\u5b66\u4e60\u5f97\u5230\u7684\u3002\u81f3\u4e8e attention_mask \u5e72\u561b\u7528\u7684\uff0c\u56e0\u4e3a\u6bcf\u4e00\u6bb5\u8f93\u5165\u957f\u5ea6\u662f\u56fa\u5b9a\u957f\u5ea6\uff0c\u5982\u679c\u6587\u672c\u4e0d\u591f\u7684\u8bddpadding\u8865\u9f50\uff0c\u56e0\u6b64\u8fd9\u91ccattention mask\u5c31\u662f\u6807\u8bb0\u90a3\u4e00\u90e8\u5206\u662f\u6709\u6587\u5b57\u7684\uff0c\u90a3\u4e00\u90e8\u5206\u662f\u8865\u9f50\u7684\u8f93\u5165\uff0c\u8fd9\u90e8\u5206\u5728\u540e\u7eed\u8ba1\u7b97\u4e0d\u8ba1\u5165\u5728\u5185\u7684\u3002\u8fd9\u4e2aattention mask \u5728transformer\u89e3\u7801\u5668\u4e2d\u771f\u6b63\u4f5c\u7528\u624d\u4f1a\u4f53\u73b0\u51fa\u6765\uff08\u5728XLNet\u4e2d\u4e5f\u5bf9\u5176\u8fdb\u884c\u4e86\u6df1\u5ea6\u5730\u5e94\u7528\uff09\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u6df1\u5165\u4e86\u3002\n\ntrain_dataset = train_dataset . map ( preprocess_function , batched = True , load_from_cache_file = False ) val_dataset = test_dataset . map ( preprocess_function , batched = True , load_from_cache_file = False ) test_dataset = test_dataset . map ( preprocess_function , batched = True , load_from_cache_file = False ) train_dataset . set_format ( 'torch' , columns = [ 'input_ids' , 'attention_mask' , 'token_type_ids' , 'label' ] ) val_dataset . set_format ( 'torch' , columns = [ 'input_ids' , 'attention_mask' , 'token_type_ids' , 'label' ] ) test_dataset . set_format ( 'torch' , columns = [ 'input_ids' , 'attention_mask' , 'token_type_ids' , 'label' ] )\n\n\u8f7d\u5165\u672c\u5730\u6570\u636e\u96c6\n\n\u8fd9\u91cc\u6211\u8f7d\u5165\u6211\u5b58\u5728\u6211\u8c37\u6b4c\u4e91\u76d8\u91cc\u7684quora\u6570\u636e\u96c6\uff08\u8be5\u6587\u4ef6\u5df2\u5171\u4eab\uff0c\u53ef\u76f4\u63a5\u4e0b\u8f7d\uff09\n\n!gdown - - id 1nAEIkp3tGBSIetFxojp2hRigp34L6eyW !unzip quora - question - pairs . zip !unzip train . csv . zip\n\n\u7136\u540e\u7528pandas\u8bfb\u53d6\uff0c\u7136\u540e\u518d\u62c6\u5206\u8bad\u7ec3\u96c6\u548c\u9a8c\u8bc1\u96c6\uff0c\u8fd9\u91cc\u76f4\u63a5\u4e0a\u4ee3\u7801\uff0c\u4e0d\u591a\u8d58\u8ff0\u3002\n\ntrain_data = pd . read_csv ( \"./train.csv\" , index_col = \"id\" , nrows = 20000 ) test_data = pd . read_csv ( \"./test.csv\" , index_col = \"test_id\" , nrows = 1000 ) X_train , X_val , y_train , y_val = train_test_split ( train_data [ [ \"question1\" , \"question2\" ] ] , train_data [ \"is_duplicate\" ] , test_size = 0.2 , random_state = 2020 )\n\n\u7136\u540e\u4f7f\u7528BERT\u5206\u8bcd\u5668\u5bf9\u5176\u8fdb\u884c\u5206\u8bcd\uff0c\u518d\u4f7f\u7528 nlp.Dataset.from_dict \u8f6c\u5316\u4e3a Trainer \u6807\u51c6\u8f93\u5165\n\nmax_len = 64 train_dataset = tokenizer ( X_train [ 'question1' ] . tolist ( ) , X_train [ 'question2' ] . tolist ( ) , padding = True , truncation = True , max_length = max_len ) train_dataset [ 'label' ] = y_train . values val_dataset = tokenizer ( X_val [ 'question1' ] . tolist ( ) , X_val [ 'question2' ] . tolist ( ) , padding = True , truncation = True , max_length = max_len ) val_dataset [ 'label' ] = y_val . values test_dataset = tokenizer ( test_data [ 'question1' ] . tolist ( ) , test_data [ 'question2' ] . tolist ( ) , padding = True , truncation = True , max_length = max_len ) train_dataset = Dataset . from_dict ( train_dataset ) val_dataset = Dataset . from_dict ( val_dataset ) test_dataset = Dataset . from_dict ( test_dataset )\n\n\u8bad\u7ec3\u548c\u9884\u6d4b\n\n\u8bc4\u4f30\u51fd\u6570\n\ndef compute_metrics ( pred ) : labels = pred . label_ids preds = pred . predictions . argmax ( - 1 ) precision , recall , f1 , _ = precision_recall_fscore_support ( labels , preds , average = 'binary' ) acc = accuracy_score ( labels , preds ) return { 'accuracy' : acc , 'f1' : f1 , 'precision' : precision , 'recall' : recall }\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u8bbe\u7f6eBERT\u8bad\u7ec3\u53c2\u6570\u7684\u90e8\u5206\n\ntraining_args = TrainingArguments ( output_dir = './results' , overwrite_output_dir = True , num_train_epochs = 5 , per_device_train_batch_size = 32 , per_device_eval_batch_size = 32 , learning_rate = 5e - 5 , load_best_model_at_end = True , metric_for_best_model = \"accuracy\" , weight_decay = 0.01 , warmup_steps = 500 , evaluation_strategy = \"steps\" , logging_strategy = \"steps\" , save_strategy = 'no' , logging_steps = 100 , seed = 2020 , logging_dir = './logs' )\n\n\u7136\u540e\u5c06\u8fd9\u4e9b\u8bad\u7ec3\u53c2\u6570\uff0c\u6a21\u578b\uff0c\u6570\u636e\u7b49\u76f4\u63a5\u6254\u8fdb Trainer \u51fd\u6570\u4e2d\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u8bad\u7ec3\u4e86\u3002\u8fd9\u5c31\u5f88\u591a\u6b65\u9aa4\u5c01\u88c5\u8d77\u6765\u4e86\uff0c\u7136\u540e\u53c2\u6570\u8fd8\u90fd\u53ef\u4ee5\u8fdb\u884c\u8bbe\u7f6e\uff0c\u7701\u53bb\u5f88\u591a\u9ebb\u70e6\u800c\u4e14\u6548\u679c\u4e00\u6837\u3002\n\ntrainer = Trainer ( model = model , args = training_args , compute_metrics = compute_metrics , train_dataset = train_dataset , eval_dataset = test_dataset\uff0c tokenizer = tokenizer )\n\n\u8bad\u7ec3\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u6bcf500\u4e2abatch\u4f1a\u8f93\u51fa\u4e00\u6b21loss\n\ntrainer . train ( )\n\n\u8bad\u7ec3\u671f\u95f4\u6253\u5370\u51fa\u6765\u7684\u8bad\u7ec3\u4fe1\u606f\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n\n\n\n\u9a8c\u8bc1\u90e8\u5206\uff0c\u8f93\u51fa\u5728\u9a8c\u8bc1\u96c6\u4e0a\u7684\u4e00\u4e9b\u53c2\u6570\u548c\u8bc4\u4f30\u5206\u6570\u7b49\n\ntrainer . evaluate ( )\n\n\u4e4b\u540e\u53ef\u4ee5\u8fdb\u884c\u53ef\u89c6\u5316\u8bad\u7ec3\u65f6\u7684\u6570\u636e\n\n% load_ext tensorboard % tensorboard - - logdir logs\n\n\u7ed3\u679c\u5982\u56fe\u6240\u793a\uff0c\u5f53\u7136\u8fd9\u4e2a\u4e5f\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\uff0c\u8be6\u60c5\u53ef\u4ee5\u67e5\u770b\u6587\u6863\uff1ahttps://pytorch.org/docs/stable/tensorboard.html\n\n\u7136\u540e\u9884\u6d4b\u4e5f\u4e00\u6837\u5f88\u7b80\u5355\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5 \u6839\u636e\u9884\u6d4b\u7ed3\u679c\u6bd4\u5bf9\u4e00\u4e0b\u771f\u5b9e\u7ed3\u679c\uff0c\u8fd9\u91cc\u4e5f\u4e0d\u591a\u8d58\u8ff0\u4e86\u3002\n\npred = trainer . predict ( test_dataset = test_dataset ) . predictions prob = softmax ( pred , axis = 1 ) pred_label = pred . argmax ( - 1 )\n\n\u8fd9\u6837\u57fa\u672c\u5c31\u7ed3\u675f\u4e86\uff0c\u5f53\u7136\u5982\u679c\u60f3\u8981\u6a21\u578b\u8bad\u7ec3\u5730\u66f4\u597d\uff0c\u80af\u5b9a\u9700\u8981\u8c03\u53c2\u3002 \u5bf9\u6b64 Trainer \u63d0\u4f9b\u5bfb\u627e\u6700\u4f18\u53c2\u6570\u7684\u65b9\u6cd5\n\n\u67e5\u627e\u6700\u4f18\u53c2\u6570\n\n\u9996\u5148\u9700\u8981\u5b89\u88c5\u4e00\u4e0b optuna \u5305\uff0c optuna \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u8d85\u53c2\u6570\u81ea\u52a8\u4f18\u5316\u6846\u67b6\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u7528\u5b83\u6765\u4f18\u5316 Trainer \u7684\u53c2\u6570\n\n! pip install optuna\n\n\u4e3a\u4e86\u6bd4\u8f83\u4e0d\u540c\u7684\u53c2\u6570\u4e0b\u6a21\u578b\u7684\u8bad\u7ec3\u6548\u679c\uff0c\u6bcf\u6b21\u90fd\u9700\u8981\u521d\u59cb\u5316\u539f\u59cb\u6a21\u578b\u3002\u56e0\u6b64\u9700\u8981\u5b9a\u4e49\u4e00\u4e2a\u6a21\u578b\u521d\u59cb\u5316\u51fd\u6570\uff1a\n\ndef model_init ( ) : return BertForSequenceClassification . from_pretrained ( \"bert-base-uncased\" , num_labels = 2 )\n\n\u7136\u540e\u521d\u59cb\u53c2\u6570\u8bbe\u7f6e\uff0c\u8ddf\u524d\u9762\u662f\u4e00\u6837\u7684\uff1a\n\ndef compute_metrics ( pred ) : labels = pred . label_ids preds = pred . predictions . argmax ( - 1 ) precision , recall , f1 , _ = precision_recall_fscore_support ( labels , preds , average = 'binary' ) acc = accuracy_score ( labels , preds ) return { 'accuracy' : acc , 'f1' : f1 , 'precision' : precision , 'recall' : recall } training_args = TrainingArguments ( output_dir = './results' , overwrite_output_dir = True , num_train_epochs = 5 , per_device_train_batch_size = 32 , per_device_eval_batch_size = 32 , learning_rate = 5e - 5 , load_best_model_at_end = True , metric_for_best_model = \"accuracy\" , weight_decay = 0.01 , warmup_steps = 50 , evaluation_strategy = \"steps\" , logging_strategy = \"no\" , save_strategy = 'no' , logging_steps = 100 , seed = 2020 , logging_dir = './logs' ) trainer = Trainer ( model_init = model_init , args = training_args , compute_metrics = compute_metrics , train_dataset = train_dataset , eval_dataset = val_dataset , tokenizer = tokenizer )\n\n\u9009\u62e9\u9700\u8981\u8c03\u7684\u53c2\u6570\uff0c\u4f8b\u5982\u6211\u8fd9\u91cc\u9009\u62e9 weight_decay \u548c warmup_steps \u4e24\u4e2a\u53c2\u6570\uff0c\u5e76\u4e3a\u5176\u9009\u62e9\u90e8\u5206\u5019\u9009\u7684\u503c\uff0c\u5176\u5b9e\u8fd9\u5c31\u8ddfgridsearchcv\u7f51\u683c\u8c03\u53c2\u662f\u7c7b\u4f3c\u7684\u3002\n\nimport optuna def default_hp_space_optuna ( trial ) : return { \"weight_decay\" : trial . suggest_categorical ( \"weight_decay\" , [ 0.01 , 0.03 , 0.05 , 0.1 , 0.2 ] ) , \"warmup_steps\" : trial . suggest_categorical ( \"warmup_steps\" , [ 20 , 40 , 50 , 60 , 100 , 200 ] ) , }\n\n\u4e4b\u540e\u5f00\u59cb\u67e5\u627e\n\nbest_run = trainer . hyperparameter_search ( hp_space = lambda x : default_hp_space_optuna ( x ) , backend = \"optuna\" , n_trials = 10 , direction = \"maximize\" )\n\n\u8fd0\u884c\u65f6\u4f1a\u8f93\u51fa\u4e00\u7cfb\u5217\u9009\u53d6\u4e0d\u540c\u53c2\u6570\u65f6\u5019\u8bad\u7ec3\u7684\u7ed3\u679c\uff0c\u8fd0\u884c\u5b8c\u4e4b\u540e\uff0c \u67e5\u770b best_run \uff0c \u8f93\u51fa\u4e3a\u6700\u4f18\u7684\u53c2\u6570\n\nprint ( best_run )\n\n\u7136\u540e\u66f4\u65b0\u6a21\u578b\u53c2\u6570\uff0c\u91cd\u65b0\u8bad\u7ec3\u6a21\u578b\u5373\u53ef\u3002\n\nfor n , v in best_run . hyperparameters . items ( ) : setattr ( trainer . args , n , v ) trainer . train ( )\n\n\u597d\u4e86\uff0c\u5927\u6982\u5c31\u662f\u8fd9\u6837\u4e86\uff0c\u5176\u4e2d\u53ef\u80fd\u8fd8\u6709\u5f88\u591a\u7ec6\u8282\u8fd8\u6ca1\u6709\u5c55\u5f00\uff0c\u4e4b\u540e\u4f1a\u6162\u6162\u8865\u5145\u3002\u6700\u8fd1\u6211\u4f1a\u5177\u4f53\u5199\u4e00\u7bc7BERT\u7684\u539f\u7406\uff08\u62d6\u4e86\u597d\u4e45\u4e86\uff0c\u6700\u8fd1\u4e00\u5b9a\u5199\u5b8c\uff09\uff0c\u8bf7\u6301\u7eed\u5173\u6ce8~~\u53e6\u5916\u6b22\u8fce\u4ea4\u6d41\u8ba8\u8bba^^\n\n\u53c2\u8003\u8d44\u6599"}, {"url": "https://www.carltonfc.com.au/news/712053/moment-24-deacons-brownlow-medal", "page_content": "24. 1947 - Bert Deacon's Brownlow Medal\n\nVIEW THE 25 GREATEST MOMENTS HUB HERE\n\nThe man who would be Carlton\u2019s first Brownlow Medallist deftly adjusted the dial of his trusty bakelite radio. Flicking the knob with those long fingers famously used for plucking the pigskin of a Saturday afternoon, Bert Deacon pierced the crackle when he found station 3DB.It was early on the evening of Wednesday, September 3, 1947, and Bert and his dear wife, Jean, having already kissed goodnight to their baby boy Brian, pulled up a couple of armchairs at their modest home in Preston\u2019s Hawker Avenue. There they lent a collective ear to the station\u2019s broadcast of what would prove an historic medal count.As the votes were being cast, Deacon fully anticipated Richmond\u2019s Bill Morris to emerge with the gong ... not that he and his better half particularly cared. \u201cBert hadn\u2019t thought about the Brownlow Medal and I didn\u2019t even know what a Brownlow Medal was. I was a country bumpkin,\u201d said Jean, in an interview with this reporter a few months prior to her death in August 2009.\u201cWe had some friends, Jack Costello and his girlfriend Carol, who ran the Preston Hotel in High Street, who also came around to listen. When Bert\u2019s name was announced the visitors went out to their car and returned with beer and sandwiches, and by the time reporters turned up there was a beer and sandwich waiting. The other thing I remember that night was that Bert\u2019s brother-in-law (former St Kilda footballer William Maslen), who lived in Coburg at the time, rode his bike across to shake hands with him.\u201dWith votes awarded by field umpires on a basis of three for first preference, two for second and one for third, Deacon accrued four first preferences, three seconds and five thirds to emerge the victor with 23 votes. He overhauled St Kilda\u2019s Harold Bray by two votes.As The Herald\u2019s famed football writer Alf Brown declared. \u201cGreat consistency \u2013 he was awarded votes in 12 out of 18 games \u2013 helped Deacon to win the trophy. He scored four first votes and was equal first with Bill Morris (Richmond) after the first votes had been counted. With three seconds he crept to second place after the second votes had been counted \u2013 Bray led 21 to 18 \u2013 and with five third votes he won the medal from Bray, who did not score a point when the third votes were counted,\u201d Brown wrote.The record books show that Deacon represented Carlton in 106 senior matches from 1942 through to 1949, including the famous \u201cBloodbath\u201d Grand Final against South Melbourne in 1945 and the last gasp Grand Final victory over Essendon in \u201947. He also represented the Big V in 1947, \u201948 and \u201949 and was barely 50 matches into his senior career when he won the coveted Brownlow.The late Jim Clark, one of the last surviving members of the premiership teams of which Deacon was such an integral part, was recently asked to declare the best Carlton footballer he ever played alongside. \u201cOh easy,\u201d came the reply. \u201cBerty Deacon ... class .... one of the greatest ever. He was a Preston boy, married a girl from Kerang, and Bert and I were great cobbers. I got my first break with the seniors in 1943 and had the privilege of playing alongside him. He was not only a great footballer, but a bonza feller and a real gentleman. There will never be a better footballer, in my opinion, than Berty Deacon.\u201cBerty was around six foot and a half (184cm) but he had such long fingers he rarely dropped a mark, and he was a pro runner too \u2013 nearly every footy club had two or three pro-runners. He won the Brownlow Medal in \u201947 \u2013 a premiership year \u2013 and to win the Brownlow in a premiership year would have to be a prestigious Brownlow because a premiership team would have a lot of other chappies taking votes. But Berty had such superiority and he was as fair as fair as fair.\u201dIt says something of the character of the man that barely 24 hours after his famous Brownlow win, Deacon and Ken Luke paid an impromptu visit to Deacon\u2019s teammate Ron Hines, who was convalescing in Heidelberg hospital. A photograph which later appeared in The Herald shows Hines congratulating Deacon on his win with a handshake, as Ken Luke proudly watches on.The great Horrie Clover echoed the sentiments of all at Princes Park, who saw Deacon as a worthy recipient of the precious medal. \u201cI am very delighted that a Carlton player should at long last win the medal,\u201d Clover told a reporter from The Sun. \u201cWithout fear of contradiction I can say Bert Deacon is a great player and a great chap.\u201dObjective observers such as Alf Brown also concurred. \u201cFootball followers will applaud the selection of Bert Deacon as the winner of this year\u2019s award. He is one of the most brilliant players in the game \u2013 a sure, spectacular mark, a fast and clever ground player, and a defender whose courageous clearing dashes often put his side into attack,\u201d Brown wrote. \u201cDeacon, who is vice-captain of Carlton, is the best mark of a wet ball I have seen. He has remarkably big hands and this, undoubtedly, accounts for his ability to take spectacular finger-tip marks with either a greasy or dry ball.\u201cThe field umpires\u2019 votes for the Medal show that they have placed great emphasis on fairness as well as on ability. Deacon is scrupulously fair . . . \u201dBert Deacon was tragically lost to the football world when, on January 3, 1974, he suffered a fatal heart attack. Though only 51, the boy from the northern suburbs had dedicated 34 years to his beloved Blues.On New Year\u2019s Eve, 1991, Deacon\u2019s famous medal was stolen from his widow\u2019s purse during a house break-in. Thankfully, Jean received a replacement medal, struck when then-chief executive commissioner of the AFL the late Alan Schwab heard of her plight."}, {"url": "https://blueseum.org/Bert+Deacon", "page_content": "Milestones\n\nVideo\n\nBert Deacon holds a special place among the legends of the Carlton Football Club. Although his outstanding on-field career was restricted to only 106 games by war service and a chronic thigh injury, he was a star defender in two Premiership teams, a club Best and Fairest, and the first Blue to win the game\u2019s highest individual honour; the Brownlow Medal.Later, he served as a committeeman, and a hard-working and effective club secretary, before his deeply-mourned passing at the age of just 51. But what made Bertrand John Deacon unique was not just his exploits on the field for his beloved Blues. He was a man of the highest principles; a true gentleman whose moral courage and sense of fair play set him apart.Bert was born into a footballing family at Northcote in 1922 . His father, Jack Deacon, was a prominent player for Preston in the 1920's who spent many years on the committee of the club when his playing days ended. After showing promise at schoolboy and junior level, Bert followed his father into the red and white colours of Preston\u2019s senior side in 1941 , while the devastation of World War II spread across the world. On May 11, 1940, the V.F.A. Recorder noted \"\"Bert Deacon, a l7-year-old lad, will be tried in the centre for Preston today. He has been doing well with the seconds.Deacon was in and out of the side that year and was omitted for Preston's one finals appearance, but played every game in 1941. By the start of the following season, the V.F.A. were in recess and players were free to cross to League clubs without a clearance.In a VFA competition deprived of quality and quantity by the eagerness of Australia\u2019s young men to fight for their country, 19 year-old Deacon played in all of Preston\u2019s home and away matches in that bleak year, only to be left out of the side for the finals. Port Melbourne won the flag, and soon afterwards the VFA announced that it was suspending its competition for the duration of the war.Bert himself enlisted soon after that, but while waiting for his call-up, went looking for a game somewhere else. When he called at Princes Park, recently-appointed Carlton coach Percy Bentley welcomed him in, and the pair began a partnership that would endure throughout Deacon\u2019s entire VFL career.Bert first took the field for Carlton against Footscray at the Yarraville Oval on Saturday, June 20, 1942 . The Western Oval had been appropriated by the government for use as a military transit centre, so the Bulldogs were bunking-in with their VFA neighbours. Bentley named Deacon in the centre, where he played alongside two men with whom he would later share Premiership glory; Vin Brown and Fred Fitzgibbon . On that day however, Footscray adapted to the conditions better than the Blues, and ran out winners by 19 points.Deacon managed just three games in 1942 , two in 1943 and three in 1944 , as his training and postings to Australia\u2019s far north kept him a long way from home. But by early 1945 , with the Axis forces in Europe all but beaten and the Japanese in full retreat in the Pacific, Lance Corporal Bert Deacon was transferred back to Melbourne, where he wasted no time in resuming his football career. In 1945, Deacon was captain-coach of an Army Stores team in Darwin that included several League and Association players, including Footscray legend, Charlie Sutton.He returned to Carlton\u2019s team in July, 1945 , for the match against Essendon at Princes Park. The Blues lost a cliff-hanger by three points, but by siren time that afternoon, coach Bentley knew that he had a potential champion in his team with Deacon at centre half-back. Although he was just 180 cm and 79 kg, Bert settled into defence like he was born to it. He was a strong and clever mark, beautifully balanced, with an uncanny ability to read the flight of the ball. And once he got it, he invariably disposed of it well with a neat drop kick to position.Carlton\u2019s feat of battling through to a finals berth in 1945 , and then going on to beat South Melbourne in the most infamous and controversial Grand Final of all time, has been well documented. What isn\u2019t so well-known is that the Carlton-Collingwood Preliminary Final that preceded it was every bit as violent, and surely was a catalyst for later events.After losing the second Semi Final to minor Premiers South Melbourne, Collingwood went into the Preliminary Final with the intention of knocking some of Carlton\u2019s playmakers off their game. Included among their targets were key defenders Deacon and full-back Vin Brown . The game was an ugly series of melees from early on, as Collingwood went head hunting, and Carlton fought fire with fire. Yet through it all, as fists, elbows and even boots flew around him, it was Deacon who held the line across half-back. Despite being niggled, punched and thrown to the ground late on many occasions, he never once retaliated, nor complained to the umpire. Cool and collected, he just simply kept getting the ball, and sending it into attack.Even so, Collingwood held sway on the scoreboard for three quarters, and seemed to have sealed the match early in the last term, when they kicked their twelfth goal and stretched their lead to 45 points. But when Vin Brown was king-hit by Collingwood\u2019s Len Hustler, and the Blues would take no more. Galvanised by that incident, they came storming back into the match to pile on seven goals in the last 18 minutes, and beat the demoralised Magpies by ten points.The following week, when South Melbourne and Carlton met to decide the 1945 VFL Premiership , the teams ran out onto a Princes Park packed to the rafters with almost 63,000 spectators. The occasion, and simmering tensions on both sides - heightened by the violence of the previous Saturday, produced a powder keg of emotion that inevitably exploded into another vicious clash forever remembered as the \u2018Bloodbath\u2019 Grand Final.Once more, Bert Deacon was one of the few players from either side who was more interested in finding the football than punching on. In the second quarter, as the game degenerated into a series of running brawls, South\u2019s promising youngster Ron Clegg (like Deacon, a future Brownlow Medallist) was about to join in the fighting when Deacon took hold of his shoulder and quietly said; \u2018Don\u2019t go down there, son, there\u2019s nothing for you in that.\u2019 Clegg heeded Deacon\u2019s advice, only to be felled himself later in the match, by Carlton\u2019s fearsome captain, Bob Chitty As a groggy Clegg got to his feet to take his free kick, Deacon realised that Clegg was facing the wrong way, and turned him in the right direction \u2013 an action that infuriated Chitty, who snarled; \u2018I don\u2019t knock them down for you to pick up.\u2019 Carlton eventually won the battle by 28 points. Ten players were reported and suspended, yet one of the enduring stories of that bitter-sweet triumph for Carlton was the unflagging sportsmanship of Bert Deacon.Two years later, Deacon\u2019s career peaked when he won his second VFL Premiership medallion, topped off by the 1947 Brownlow Medal, and a tie for first place in Carlton\u2019s Best and Fairest award. The year began with the arrival of brilliant West Australian Ern Henfry , who had stood out of football for a year to win a clearance to Carlton, and was appointed captain of the Blues after just two senior games.A gifted centreman and an inspirational leader, Henfry led a solid Carlton combination to the minor Premiership, on the way, striking up a strong rapport with his vice-captain Deacon. By then, Bert was considered as the outstanding centre half-back of the competition. In the week prior to the first round of the finals, he confirmed his standing in the game by becoming the first Carlton player to win the Brownlow Medal, when he polled 23 votes to beat St Kilda\u2019s Harry Bray by two.It would have been understandable had Deacon been distracted by the celebrations, but as always, he quickly refocused on the job at hand. Carlton met Essendon in the \u201947 Grand Final in front of 85,000 at the MCG, and seemed headed for defeat when they trailed by five points as the time-keeper\u2019s clock clicked into the last minute of time-on. That\u2019s when nuggety rover Fred Stafford (who had been rarely sighted all day) swooped on a spillage 30 metres out from goal and snapped truly, giving Carlton our second flag in three years by the narrowest possible margin.In the following week, amid the euphoria of Premiership celebrations, Deacon rounded off that one special season when he and Henfry were announced as joint winners of Carlton\u2019s Best and Fairest trophy. Earlier, Bert had also worn the Victorian state guernsey at the 1947 National Championships, winning the K.G. Luke Trophy for the best Victorian player in the series, as well as a number of newspaper awards.Deacon\u2019s third Grand Final appearance came in 1949 , and again Carlton\u2019s opponent was Essendon \u2013 who battled their way into the flag decider largely due to the form of their star full-forward, John Coleman. Adding to the interest in a match between the Premiers of the previous two years, Coleman needed six goals to reach the magical 100 for the season, and Essendon were determined to give him every possible chance to get them.After an even, hard-fought first quarter, Essendon proved unstoppable and steadily increased their advantage over the Blues. By the last change, the margin had blown out to 57 points \u2013 but remarkably, Coleman had been held to just two goals by Carlton\u2019s close-checking full-back Ollie Grieve - and Deacon, who ranged across half back and cut off many attacks with strong marks.However, with the game won, Essendon concentrated on getting the ball to Coleman, and with just minutes remaining he ran on to a short pass and lined up for a shot at number 100. It was then that Deacon \u2013 ever the gentleman \u2013 trotted up beside the young star, put a hand on his shoulder and offered a word or two of advice. As he turned and walked away, Coleman sent the ball between the posts.That was to be Bert\u2019s last shot at Premiership glory with the Blues. A persistent muscle tear in one thigh had begun to trouble him, and in 1950 restricted him to just seven games. He saddled up again in 1951 , but by mid-year admitted that he was struggling and decided to call time on a memorable career. He played his last match against the old foe; South Melbourne, at the Lake Oval in round 11, 1951 . The Blueboys did the right thing by their champion, and farewelled him with a tenacious, thrilling 5-point win.In 1952 Bert returned to Preston as captain-coach for two seasons, before hanging up his boots to continue his role off-field. In his three further years, Deacon is reported to have played in every position on the ground except full-back, a position held firm by another Preston legend in Ted Henrys. In 1955, Deacon acted as non-playing coach before finally retiring from an active role. In 1955 , the Bullants made the VFA finals for the first time since Deacon had last played for them in 1941 . While at Preston, he retained his links at Carlton, and by 1958 was back at Princes Park in a variety of administrative roles. Later, he was elected to the committee, and in 1970 became club Secretary under President George Harris . Two more flags followed - in 1970 and 1972 - and no-one at Carlton was prouder than Bert Deacon.On January 3, 1974, Bert and his family were holidaying at Balnarring on the Mornington Peninsula, when he suffered a massive heart attack, and died before reaching hospital. He was just 51 years old. The football world was rocked to its core by the news, and there was widespread grief at the loss of one of football\u2019s favourite sons \u2013 a man whose dignity and integrity transcended club loyalties and brought him genuine admiration. Winning and losing mattered much to Bert Deacon, but so did how the game was played.The Deacon family tradition continued at Preston with his brother Bill acting as President from 1983 to 1987, a period that saw the club become the first in V.F.A. history to take out premierships at the Firsts, Seconds and Thirds levels in 1983 and again the following year. Bill's widow, Maisie has had the honour of the Preston and now Northern Bullant No. 1 membership for many years50 Games : Round 15, 1947 Vs Footscray100 Games : Round 2, 1951 Vs Footscray"}, {"url": "https://blog.csdn.net/qq_27590277/article/details/113065534", "page_content": "\u70b9\u51fb\u4e0a\u65b9\uff0c\u9009\u62e9\u661f\u6807\u6216\u7f6e\u9876\uff0c\u6bcf\u5929\u7ed9\u4f60\u9001\u5e72\u8d27\uff01\n\n\u6765\u81ea\uff1aCS\u7684\u964b\u5ba4\n\n\n\n\u8fd1\u671f\u6211\u4f1a\u4e00\u8fde\u51e0\u7bc7\u8c08\u8c08bert\u4e2d\u7684\u5173\u952e\u7ec6\u8282\uff0c\u8fd9\u4e2aposition encoding\u662f\u6211\u770b\u5230\u7684bert\uff08\u5b9e\u8d28\u4e0a\u662ftransformer\u4e2d\u63d0\u51fa\u7684\uff09\u4e2d\u6700\u4e3a\u60ca\u559c\u7684\u4f46\u662f\u5374\u88ab\u5f88\u591a\u4eba\u5ffd\u7565\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u5a92\u4f53\u9f13\u5439\u6700\u5c11\u7684\uff09\u4e00\u4e2a\u7ec6\u8282\uff0c\u8fd9\u91cc\u7ed9\u5927\u5bb6\u8c08\u8c08\u3002\n\n\u4ec0\u4e48\u662fposition encoding\n\n\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u57fa\u4e8e\u4f4d\u7f6e\u7684\u4e00\u5957\u8bcd\u5d4c\u5165\u65b9\u6cd5\uff0c\u8bf4\u5f97\u7b80\u5355\u70b9\uff0c\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u53e5\u5b50\uff0c\u90fd\u6709\u5bf9\u5e94\u7684\u4e00\u4e2a\u5411\u91cf\u3002\n\nposition encoding\u7684\u6536\u76ca\n\n\u6211\u611f\u89c9\u8981\u505a\u4e00\u4e2a\u4e8b\u60c5\uff0c\u9996\u5148\u8fd8\u662f\u8981\u770b\u4ed6\u7684\u51fa\u53d1\u70b9\u548c\u6536\u76ca\uff0c\u8bf4\u767d\u4e86\u5c31\u662f\u4f18\u70b9\u662f\u5565\uff0c\u505a\u8fd9\u4e2a\u7684\u76ee\u6807\u662f\u5565\uff0c\u8fd9\u6837\u6211\u4eec\u624d\u77e5\u9053\u600e\u4e48\u505a\u3002\n\n\u56de\u5934\u770b\u770bCNN\u7ed3\u6784\u3001RNN\u751a\u81f3\u662ftransformer\u7684self-attention\uff0c\u5176\u5b9e\u90fd\u6ca1\u6709\u7279\u522b\u5173\u6ce8\u4f4d\u7f6e\u4fe1\u606f\uff0c\u800c\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u5374\u662f\u9700\u8981\u53bb\u5173\u6ce8\u7684\uff0c\u6bd5\u7adf\u4f5c\u4e3a\u4e00\u95e8\u8bed\u8a00\uff0c\u4ed6\u5927\u90fd\u6709\u6bd4\u8f83\u4e25\u8c28\u7684\u8bed\u6cd5\u7ed3\u6784\uff0c\u7279\u5b9a\u8bcd\u6c47\u8fd8\u771f\u7684\u4f1a\u51fa\u73b0\u5728\u7279\u5b9a\u4f4d\u7f6e\uff0c\u8fd9\u662f\u975e\u5e38\u6709\u610f\u601d\u7684\uff0c\u6765\u770b\u770b\u4f8b\u5b50\uff08\u6765\u6e90\u4e8e\u77e5\u4e4e\uff09\uff1a\n\nI like this movie because it doesn't have an overhead history. I don't like this movie because it has an overhead history.\n\n\u4ece\u60c5\u611f\u4e0a\uff0c\u4e0a\u9762\u662f\u6b63\u9762\uff0c\u4e0b\u9762\u662f\u8d1f\u9762\uff0c\u8fd9\u4e2a\u975e\u5e38\u663e\u800c\u6613\u89c1\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5426\u5b9a\u53e5\uff0c\u4ece\u5b9e\u4f53\u63d0\u53d6\u7684\u89d2\u5ea6\u90fd\u6709movie\u548chistory\uff0c\u65e0\u8bba\u662f\u54ea\u4e2a\u4efb\u52a1\uff0c\u90fd\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u8bed\u6cd5\u7ed3\u6784\u4e2d\u5b58\u5728\u7684\u4f4d\u7f6e\u4fe1\u606f\u3002\n\n\u5bf9CNN\uff0c\u53ea\u80fd\u8003\u8651\u5230\u56fa\u5b9a\u524d\u540e\u7684\u5c40\u90e8\u4fe1\u606f\uff0cRNN\u80fd\u8003\u8651\u7a0d\u5fae\u957f\u671f\u7684\u4fe1\u606f\uff0cLSTM\u662f\u6709\u91cd\u70b9\u7684\u8bb0\u5f55\uff0cTransformer\u53ea\u80fd\u8003\u8651\u5230\u5168\u5c40\u7684\u4fe1\u606f\uff0c\u5c24\u5176\u5728bert\u4e2d\uff0c\u53ea\u7528\u4e86transformer encoder\uff0c\u6a21\u578b\u4e0a\u5c31\u5b8c\u5168\u4e27\u5931\u5bf9\u4f4d\u7f6e\u4fe1\u606f\u7684\u63cf\u8ff0\u4e86\uff0c\u56e0\u6b64\u5f15\u5165\u57fa\u4e8e\u4f4d\u7f6e\u7684\u7279\u5f81\u5c31\u53ef\u80fd\u5728\u7279\u5b9a\u4efb\u52a1\u4e2d\u4ea7\u751f\u6536\u76ca\u3002\n\n\u6362\u4e2a\u89d2\u5ea6\u518d\u770b\u4e00\u4e2a\u4f8b\u5b50\uff1a\n\nI believe I can be the best.\n\n\u5bf9\u4e8eself attention\uff0c\u5982\u679c\u6ca1\u6709positional encoding\uff0c\u4e24\u4e2ai\u7684\u8f93\u51fa\u5c06\u4f1a\u4e00\u6837\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\uff0c\u8fd9\u4e24\u4e2ai\u662f\u5b58\u5728\u533a\u522b\u7684\uff0c\u4e0d\u662f\u5728\u6307\u4ee3\u4e0a\uff0c\u800c\u662f\u542b\u4e49\u4e0a\uff0c\u7b2c\u4e00\u4e2ai\u662f\u89c2\u70b9\u7684\u53d1\u51fa\u8005\uff0c\u201c\u4e0d\u8981\u4f60\u89c9\u5f97\uff0c\u6211\u8981\u6211\u89c9\u5f97\u201d\uff0c\u7b2c\u4e8c\u4e2ai\u662f\u89c2\u70b9\u7684\u5bf9\u8c61\uff0c\u201c\u8ba4\u4e3a\u6211\u4f1a\u662f\u6700\u68d2\u7684\uff0c\u4e0d\u662f\u522b\u4eba\u201d\uff0c\u6240\u4ee5\u4ece\u8bed\u4e49\u4e0a\u4e24\u8005\u5c31\u6709\u6240\u533a\u522b\u4e86\uff0c\u6743\u91cd\u5411\u91cf\u5b8c\u5168\u4e00\u6837\u53ef\u5c31\u6709\u95ee\u9898\u4e86\u5427\u3002\u8fd9\u4e5f\u662f\u7f3a\u5c11\u4f4d\u7f6e\u4fe1\u606f\u7684\u7f3a\u61be\u3002\n\nposition embedding\u600e\u4e48\u505a\n\n\u9996\u5148\uff0c\u6700\u7b80\u5355\u7684\u6a21\u5f0f\u5c31\u662f\u5bf9\u8bcd\u5411\u91cf\u77e9\u9635\u76f4\u63a5\u52a0\u4e00\u5c42\u5168\u8fde\u63a5\u5c42\uff0c\u5c31\u662f\u5168\u8fde\u63a5\u5c42\u3002\u5c31\u771f\u7684\u662f\u8fd9\u4e48\u7b80\u5355\uff01\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u8bcd\u5411\u91cf\uff0c\u90fd\u7a33\u5b9a\u7684\u4e58\u4ee5\u4e00\u4e2a\u7a33\u5b9a\u7684\u5411\u91cf\uff0c\u5c31\u5982\u4e0a\u9762\u6240\u793a\uff0c\u7b2c1\u4e2a\u4f4d\u7f6e\u4e00\u5b9a\u5bf9\u5e94positonal embedding\u7684\u7b2c\u4e00\u4e2a\u5411\u91cf\uff0c\u90a3\u8fd9\u7ec4\u5411\u91cf\u62bd\u51fa\u6765\uff0c\u4e0d\u662fpositional embedding\u662f\u5565\u3002\n\n\u4f46\u5f53\u7136\u7684\uff0c\u8fd9\u91cc\u5c31\u6709\u5f88\u5927\u7684\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u8fd9\u53ea\u662f\u7edd\u5bf9\u4f4d\u7f6e\uff0c\u770b\u4e0a\u9762\u7b2c\u4e00\u4e2a\u4f8b\u5b50\uff08\u6211\u518d\u642c\u8fd0\u4e00\u904d\uff09\uff1a\n\nI like this movie because it doesn't have an overhead history. I don't like this movie because it has an overhead history.\n\n\u8fd9\u91cc\u7684like \u548c don't like\u53ef\u5c31\u4e0d\u662f\u4e00\u4e2a\u4f4d\u7f6e\u4e86\u5427\uff0c\u6240\u4ee5\u7edd\u5bf9\u4f4d\u7f6e\u80af\u5b9a\u662f\u6709\u95ee\u9898\u7684\uff0c\u90a3\u4e48\u5c31\u8981\u5f15\u5165\u76f8\u5bf9\u4f4d\u7f6e\u7684\u6982\u5ff5\u4e86\u3002\u6765\u770b\u770btransformer\u8bba\u6587\u91cc\u9762\u662f\u600e\u4e48\u8bf4\u7684\uff08\u6211\u628a\u89e3\u91ca\u4e5f\u7ed9\u5927\u5bb6\u642c\u8fc7\u6765\u4e86\uff09\uff1a\n\n\u8fd9\u91cc\u7528\u7684\u662f\u4e24\u79cd\u4e09\u89d2\u51fd\u6570\uff0c\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u5de7\u5999\u4e86\uff0c\u6211\u4eec\u6765\u6162\u6162\u5206\u6790\u3002\u4e0a\u4ee3\u7801\uff01\n\nimport matplotlib.pyplot as plt import math def positional_enc(i,pos): return math.sin(pos /10000**(i/100)) x = [] for idx in range(10): tmp_x = list(range(1,100)) tmp_y = [positional_enc(i, idx) for i in tmp_x] plt.plot(tmp_x,tmp_y,label=str(idx)) plt.legend(loc = 'upper right') plt.show()\n\n\u4ee3\u7801\u8dd1\u51fa\u6765\u662f\u8fd9\u6837\u7684\uff1a\n\n\u6a2a\u5750\u6807\u662f\u7ef4\u6570\u4e0a\u7684\u6bcf\u4e2a\u503c\uff0c\u7eb5\u5750\u6807\u662f\u5bf9\u5e94\u7684sin\u503c\uff0c\u56fe\u4f8b\u5bf9\u5e94\u53e5\u5b50\u4e2d\u7684\u6bcf\u4e2a\u4f4d\u7f6e\u3002\n\n\u9996\u5148\u770b\u7ef4\u6570\u4f4d\u7f6e-sin\u503c\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5f88\u660e\u663e\uff0c\u6211\u4eec\u6ca1\u6709\u53d1\u73b0\u5468\u671f\u6027\uff0c\u6700\u7ec8\u5f800\u5904\u6536\u655b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u77e5\u9053\u4e86\uff0c\u5728\u8fd9\u79cdemcoding\u4e0b\uff0c\u5176\u5b9e\u7ef4\u6570\u6ca1\u5fc5\u8981\u592a\u9ad8\u4e86\u3002\n\n\u800c\u5bf9\u4e8e\u4f4d\u7f6e-sini\u503c\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u53ef\u4ee5\u6574\u4e2a\u66f2\u7ebf\u662f\u4f1a\u671d\u7740\u53f3\u8fb9\u79fb\u52a8\u7684\uff0c\u4ece\u6743\u91cd\u89d2\u5ea6\u770b\uff0c\u5b9e\u8d28\u4e0a\u5c31\u662f\u6bcf\u4e00\u4e2a\u7ef4\u5ea6\u90fd\u4f1a\u6709\u4e00\u4e2a\u6bd4\u8f83\u770b\u91cd\u7684\u53e5\u5b50\u4f4d\u7f6e\uff0c\u5176\u4ed6\u4f4d\u7f6e\u8bf4\u767d\u4e86\u5c31\u662f\u4e0d\u770b\u4e86\uff0c\u800c\u524d\u9762\u7684\u751a\u81f3\u53ef\u80fd\u4e3a\u8d1f\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u8981\u629b\u5f03\u4ee5\u524d\u7684\u4fe1\u606f\uff0c\u8fd9\u6837\u591a\u4e2a\u7ef4\u5ea6\u5c31\u80fd\u628a\u591a\u4e2a\u4f4d\u7f6e\u90fd\u5f53\u505a\u4e86\u91cd\u70b9\u6765\u770b\u3002\n\n\u5468\u671f\u6027\u53bb\u4e86\u54ea\u91cc\u5462\uff0c\u5176\u5b9e\u5728\u8fd9\u91cc\uff0c\u518d\u6765\u4e0a\u4ee3\u7801\uff1a\n\nimport matplotlib.pyplot as plt import math def positional_emb(i,pos): return math.sin(pos /10000**(i/100)) tmp_x = list(range(20)) tmp_y = [positional_emb(10, i) for i in tmp_x] plt.plot(tmp_x,tmp_y) plt.show()\n\n\u5f97\u5230\u4e86\u6709\u5468\u671f\u6027\u7684\u56fe\u3002\n\n\u5468\u671f\u6027\u53ea\u4f53\u73b0\u5728\u4f4d\u7f6e\u548c\u6574\u4e2a\u51fd\u6570\u7ed3\u679c\u7684\u5173\u7cfb\uff0c\u800c\u5177\u4f53\u7684\u6ce2\u957f\uff0c\u5176\u5b9e\u662f\u7531positional encoding\u5411\u91cf\u51b3\u5b9a\u7684\u3002\n\n\u4e0d\u5f97\u4e0d\u8bf4\uff0c\u8fd9\u4e2a\u51fd\u6570\u7684\u8bbe\u8ba1\u53ef\u8c13\u662f\u5bf9\u73b0\u5b9e\u573a\u666f\u6709\u4e86\u5341\u5206\u5145\u5206\u7684\u7406\u89e3\uff0c\u62bd\u8c61\u975e\u5e38\u7cbe\u51c6\u3002\n\n\u9884\u6d4b\u6548\u679c\n\n\u9996\u5148\u6765\u770b\u770b\u4e24\u79cdpositional encoding\u7684\u5177\u4f53\u6548\u679c\uff0c\u6765\u81eatransformer\u7684\u5bf9\u6bd4\u3002\n\n\u4e3b\u8981\u770bE\u3001base\u548cbig\u3002\u5176\u5b9e\u53ef\u4ee5\u770b\u5230posiitional emb\u672c\u8eab\u7684\u6548\u679c\u5176\u5b9e\u8fd8\u884c\uff0c\u4e0ebase\u76f8\u5f53\uff0c\u8bf4\u660e\u8fd8\u662f\u6709\u4e0d\u5c0f\u6536\u76ca\u7684\u3002\n\n\u6765\u770b\u770b\u6e90\u7801\n\n\u539f\u7406\u662f\u770b\u5b8c\u4e86\uff0c\u6765\u770b\u770b\u6e90\u7801\u5427\u3002\n\ndef positional_encoding(inputs, maxlen, masking=True, scope=\"positional_encoding\"): '''Sinusoidal Positional_Encoding. See 3.5 inputs: 3d tensor. (N, T, E) maxlen: scalar. Must be >= T masking: Boolean. If True, padding positions are set to zeros. scope: Optional scope for `variable_scope`. returns 3d tensor that has the same shape as inputs. ''' E = inputs.get_shape().as_list()[-1] # static N, T = tf.shape(inputs)[0], tf.shape(inputs)[1] # dynamic with tf.variable_scope(scope, reuse=tf.AUTO_REUSE): # position indices position_ind = tf.tile(tf.expand_dims(tf.range(T), 0), [N, 1]) # (N, T) # First part of the PE function: sin and cos argument position_enc = np.array([ [pos / np.power(10000, (i-i%2)/E) for i in range(E)] for pos in range(maxlen)]) # Second part, apply the cosine to even columns and sin to odds. position_enc[:, 0::2] = np.sin(position_enc[:, 0::2]) # dim 2i position_enc[:, 1::2] = np.cos(position_enc[:, 1::2]) # dim 2i+1 position_enc = tf.convert_to_tensor(position_enc, tf.float32) # (maxlen, E) # lookup outputs = tf.nn.embedding_lookup(position_enc, position_ind) # masks if masking: outputs = tf.where(tf.equal(inputs, 0), inputs, outputs) return tf.to_float(outputs)\n\n\u672c\u8eab\u516c\u5f0f\u4e0a\u6ca1\u6709\u60f3\u8c61\u7684\u590d\u6742\uff0c\u4f46\u662f\u8fd9\u91cc\u9762\u5176\u5b9e\u5c55\u73b0\u4e86\u5f88\u591apython\u76f8\u5173\u7684\u6280\u5de7\u3002\n\n\u8fd9\u91cc\u7684\u8ba1\u7b97\u5e76\u975e\u5168\u90fd\u4f7f\u7528\u7684tf\uff0c\u5bf9positionenc\uff0c\u524d\u9762\u7528numpy\u8fdb\u884c\u8ba1\u7b97\uff0c\u7136\u540e\u7528embeddinglookup\u7684\u65b9\u5f0f\u5f15\u5165\u3002\n\nposition_enc[:,0::2] \u548c position_enc[:,1::2] \u6765\u81eanumpy\u8bed\u6cd5\uff0c\u907f\u514d\u4e86\u5199\u5faa\u73af\u548c\u6761\u4ef6\u8bed\u53e5\u5c31\u80fd\u591f\u5b8c\u6210\u5947\u6570\u5076\u6570\u8ba1\u7b97\u3002\n\n\u53e6\u5916\u662f\u6709\u5f88\u591a\u53ef\u80fd\u5728\u5404\u79cd\u6559\u6750\u6216\u8005\u6559\u7a0b\u4e2d\u6ca1\u6709\u7684\u51fd\u6570\u5de5\u5177\uff0c\u5927\u5bb6\u53ef\u4ee5\u591a\u770b\u770b\u5b66\u5b66\u3002\n\ntf.AUTO_REUSE \uff1a\u6279\u91cf\u5316\u5171\u4eab\u53d8\u91cf\u4f5c\u7528\u57df\u7684\u65b9\u6cd5\u3002 tf.tile() \uff1a\u5f20\u91cf\u6269\u5c55\uff0c\u5bf9\u5f53\u524d\u5f20\u91cf\u5185\u7684\u6570\u636e\u8fdb\u884c\u4e00\u5b9a\u89c4\u5219\u7684\u590d\u5236\uff0c\u4fdd\u8bc1\u8f93\u51fa\u5f20\u91cf\u7ef4\u5ea6\u4e0d\u53d8\u3002\n\n\n\n\u8bf4\u4e2a\u6b63\u4e8b\u54c8\n\n\n\n\u7531\u4e8e\u5fae\u4fe1\u5e73\u53f0\u7b97\u6cd5\u6539\u7248\uff0c\u516c\u53f7\u5185\u5bb9\u5c06\u4e0d\u518d\u4ee5\u65f6\u95f4\u6392\u5e8f\u5c55\u793a\uff0c\u5982\u679c\u5927\u5bb6\u60f3\u7b2c\u4e00\u65f6\u95f4\u770b\u5230\u6211\u4eec\u7684\u63a8\u9001\uff0c\u5f3a\u70c8\u5efa\u8bae\u661f\u6807\u6211\u4eec\u548c\u7ed9\u6211\u4eec\u591a\u70b9\u70b9\u3010\u5728\u770b\u3011\u3002\u661f\u6807\u5177\u4f53\u6b65\u9aa4\u4e3a\uff1a\n\n\uff081\uff09\u70b9\u51fb\u9875\u9762\u6700\u4e0a\u65b9\u201c\u6df1\u5ea6\u5b66\u4e60\u81ea\u7136\u8bed\u8a00\u5904\u7406\u201d\uff0c\u8fdb\u5165\u516c\u4f17\u53f7\u4e3b\u9875\u3002\n\n\uff082\uff09\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684\u5c0f\u70b9\u70b9\uff0c\u5728\u5f39\u51fa\u9875\u9762\u70b9\u51fb\u201c\u8bbe\u4e3a\u661f\u6807\u201d\uff0c\u5c31\u53ef\u4ee5\u5566\u3002\n\n\n\n\u611f\u8c22\u652f\u6301\uff0c\u6bd4\u5fc3 \u3002\n\n\u6295\u7a3f\u6216\u4ea4\u6d41\u5b66\u4e60\uff0c\u5907\u6ce8\uff1a\u6635\u79f0-\u5b66\u6821\uff08\u516c\u53f8\uff09-\u65b9\u5411\uff0c\u8fdb\u5165DL&NLP\u4ea4\u6d41\u7fa4\u3002\n\n\n\n\u65b9\u5411\u6709\u5f88\u591a\uff1a\u673a\u5668\u5b66\u4e60\u3001\u6df1\u5ea6\u5b66\u4e60\uff0cpython\uff0c\u60c5\u611f\u5206\u6790\u3001\u610f\u89c1\u6316\u6398\u3001\u53e5\u6cd5\u5206\u6790\u3001\u673a\u5668\u7ffb\u8bd1\u3001\u4eba\u673a\u5bf9\u8bdd\u3001\u77e5\u8bc6\u56fe\u8c31\u3001\u8bed\u97f3\u8bc6\u522b\u7b49\u3002\n\n\u8bb0\u5f97\u5907\u6ce8\u5466\n\n\u63a8\u8350\u4e24\u4e2a\u4e13\u8f91\u7ed9\u5927\u5bb6\uff1a\n\n\u4e13\u8f91 | \u674e\u5b8f\u6bc5\u4eba\u7c7b\u8bed\u8a00\u5904\u74062020\u7b14\u8bb0\n\n\u4e13\u8f91 | NLP\u8bba\u6587\u89e3\u8bfb\n\n\u4e13\u8f91 | \u60c5\u611f\u5206\u6790\n\n"}, {"url": "https://blog.csdn.net/yjw123456/article/details/120232707", "page_content": "\u5f15\u8a00\n\n\u672c\u6587\u662f\u3010\u7406\u8bba\u7bc7\u3011\u662f\u65f6\u5019\u5f7b\u5e95\u5f04\u61c2BERT\u6a21\u578b\u4e86\u7684\u59ca\u59b9\u7bc7\u3002\u5728\u672c\u6587\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\ud83e\udd17\u7684 transformers \u5e93\u6765\u5b9e\u6218\u4f7f\u7528\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u3002\n\n\u6211\u4eec\u4e3b\u8981\u4f1a\u5b9e\u6218\u6587\u672c\u5206\u7c7b\u4e2d\u7684\u60c5\u7eea\u8bc6\u522b\u4efb\u52a1\u548c\u81ea\u7136\u8bed\u8a00\u63a8\u7406\u4e2d\u7684\u95ee\u7b54\u4efb\u52a1\u3002\n\n\u6ce8\u610f\uff0c\u6587\u4e2d\u63d0\u5230\u7684 \u5d4c\u5165\u8868\u793a \u3001 \u5d4c\u5165 \u3001 \u5d4c\u5165\u5411\u91cf \u3001 \u5411\u91cf\u8868\u793a \u3001 \u8868\u793a \u8bf4\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u4e1c\u897f\u3002\n\n\u63a2\u7d22\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\n\n\u5728\u7406\u8bba\u7bc7\u4e2d\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u5982\u4f55\u4f7f\u7528\u5c4f\u853d\u8bed\u8a00\u5efa\u6a21\u548c\u4e0b\u4e00\u53e5\u9884\u6d4b\u4efb\u52a1\u6765\u9884\u8bad\u7ec3BERT\u6a21\u578b\u3002\n\n\u4f46\u662f\u4ece\u5f00\u5f00\u59cb\u9884\u8bad\u7ec3BERT\u6a21\u578b\u662f\u5f88\u8017\u8d44\u6e90\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u9884\u8bad\u7ec3\u597d\u7684BERT\u6a21\u578b\u3002Google\u5f00\u6e90\u4e86\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u4ecehttps://github.com/google-research/bert\u4e2d\u4e0b\u8f7d\u3002\u4ed6\u4eec\u5f00\u6e90\u4e86\u591a\u79cd\u914d\u7f6e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002 L L L\u4ee3\u8868\u7f16\u7801\u5668\u5c42\u6570\uff0c H H H\u4ee3\u8868\u9690\u85cf\u5355\u5143\u5927\u5c0f\uff1a\n\n\u9884\u8bad\u7ec3\u6a21\u578b\u4e5f\u53ef\u7528\u4e8e BERT-uncased \u548c BERT-cased \u683c\u5f0f\u3002\u5728BERT-uncased\u4e2d\uff0c\u6240\u6709\u7684\u6807\u8bb0\u90fd\u662f\u5c0f\u5199\u7684\uff0c\u4f46\u662f\u5728BERT-cased\u4e2d\u7684\u6807\u8bb0\u6ca1\u6709\u8f6c\u6362\u4e3a\u5c0f\u5199\uff0c\u800c\u662f\u76f4\u63a5\u7528\u6765\u8bad\u7ec3\u3002\n\n\u5176\u4e2dBERT-uncased\u6a21\u578b\u662f\u6700\u5e38\u7528\u7684\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u5728\u50cf\u547d\u540d\u5b9e\u4f53\u8bc6\u522b\u4efb\u52a1\u65f6\uff0c\u6b64\u65f6\u6211\u4eec\u5e94\u8be5\u4fdd\u7559\u5927\u5c0f\u5199\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u4f7f\u7528BERT-cased\u6a21\u578b\u3002\u9664\u6b64\u4e4b\u5916\uff0cGoogle\u8fd8\u91ca\u653e\u4e86\u4f7f\u7528\u6574\u8bcd\u5c4f\u853d(whole word masking,WWM)\u65b9\u6cd5\u9884\u8bad\u7ec3\u7684\u6a21\u578b\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4ee5\u4e0b\u9762\u4e24\u4e2a\u65b9\u5f0f\u4f7f\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff1a\n\n\u4f5c\u4e3a\u62bd\u53d6\u5d4c\u5165\u8868\u793a\u7684\u7279\u5f81\u62bd\u53d6\u5668\n\n\u901a\u8fc7\u5728\u4e0b\u6e38\u4efb\u52a1\u50cf\u6587\u672c\u5206\u7c7b\u3001\u95ee\u7b54\u7b49\u4efb\u52a1\u7684\u5fae\u8c03\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\n\n\u5728\u540e\u6587\u4e2d\u6211\u4eec\u4f1a\u5b66\u4e60\u8fd9\u4e24\u79cd\u65b9\u5f0f\u662f\u5982\u4f55\u4f7f\u7528\u7684\u3002\n\n\u4ece\u9884\u8bad\u7ec3\u7684BERT\u4e2d\u62bd\u53d6\u5d4c\u5165\u8868\u793a\n\n\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u5b9e\u4f8b\u6765\u7406\u89e3\u3002\u8003\u8651\u4e00\u4e2a\u53e5\u5b50 I love Paris \uff0c\u5047\u8bbe\u6211\u4eec\u8981\u62bd\u53d6\u8be5\u53e5\u5b50\u4e2d\u7684\u6bcf\u4e2a\u6807\u8bb0\u7684\u4e0a\u4e0b\u6587\u5d4c\u5165\u3002\u9996\u5148\uff0c\u6211\u4eec\u5bf9\u53e5\u5b50\u5206\u8bcd\u7136\u540e\u5582\u7ed9\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\uff0c\u5b83\u4f1a\u8fd4\u56de\u6bcf\u4e2a\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u3002\u9664\u4e86\u53ef\u4ee5\u83b7\u53d6\u6807\u8bb0\u7ea7(\u5355\u8bcd\u7ea7)\u7684\u5d4c\u5165\u8868\u793a\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u83b7\u53d6\u53e5\u5b50\u7ea7\u7684\u8868\u793a\u3002\n\n\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u6765\u5b66\u4e60\u5177\u4f53\u5982\u4f55\u4ece\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u4e2d\u62bd\u53d6\u5355\u8bcd\u7ea7\u548c\u53e5\u5b50\u7ea7\u7684\u5d4c\u5165\u8868\u793a\u3002\n\n\u5047\u8bbe\u6211\u4eec\u60f3\u8981\u5b8c\u6210\u4e00\u4e2a\u60c5\u611f\u5206\u6790\u4efb\u52a1\uff0c\u7136\u540e\u6211\u4eec\u6709\u4e0b\u9762\u7684\u6570\u636e\u96c6\uff1a\n\n\u6211\u4eec\u6709\u53e5\u5b50\u4ee5\u53ca\u5bf9\u5e94\u7684\u6807\u7b7e\uff0c\u5176\u4e2d 1 1 1\u4ee3\u8868\u6b63\u5411\u60c5\u611f\u800c 0 0 0\u4ee3\u8868\u8d1f\u5411\u60c5\u611f\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7ed9\u5b9a\u7684\u6570\u636e\u96c6\u8bad\u7ec3\u4e00\u4e2a\u5206\u7c7b\u5668\u6765\u5206\u7c7b\u53e5\u5b50\u7684\u60c5\u611f\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6570\u636e\u96c6\u4e2d\u7684\u6587\u672c\u8fdb\u884c\u5411\u91cf\u5316\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8bf8\u5982TF-IDF\u3001word2vec\u7b49\u65b9\u6cd5\u8fdb\u884c\u5411\u91cf\u5316\u3002\u4f46\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u77e5\u9053BERT\u53ef\u4ee5\u5b66\u5230\u5355\u8bcd\u7684\u4e0a\u4e0b\u6587\u5d4c\u5165\u8868\u793a\uff0c\u6211\u4eec\u4f55\u4e0d\u76f4\u63a5\u4f7f\u7528\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u53bb\u5411\u91cf\u5316\u6570\u636e\u96c6\u4e2d\u7684\u53e5\u5b50\u5462\uff1f\n\n\u8003\u8651\u6211\u4eec\u6570\u636e\u96c6\u4e2d\u7b2c\u4e00\u4e2a\u53e5\u5b50\uff1a I love Paris \u3002\u9996\u5148\uff0c\u6211\u4eec\u901a\u8fc7WordPiece\u5206\u8bcd\u5668\u8fdb\u884c\u5206\u8bcd\u5e76\u5f97\u5230\u5206\u8bcd\u540e\u7684\u5355\u8bcd(\u6807\u8bb0)\uff1a\n\ntokens = [I, love, Paris]\n\n\u7136\u540e\u589e\u52a0 [CLS] \u548c SEP \u6807\u8bb0\uff1a\n\ntokens = [ [CLS], I, love, Paris, [SEP] ]\n\n\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8bad\u7ec3\u96c6\u4e2d\u7684\u6240\u6709\u53e5\u5b50\u8fdb\u884c\u540c\u6837\u7684\u64cd\u4f5c\u3002\u4f46\u662f\u6bcf\u4e2a\u53e5\u5b50\u7684\u957f\u5ea6\u662f\u4e0d\u56fa\u5b9a\u7684\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6240\u6709\u7684\u5355\u8bcd\u5217\u8868\u957f\u5ea6\u662f\u4e00\u81f4\u7684\u3002\u5047\u8bbe\u6211\u4eec\u4fdd\u6301\u6570\u636e\u96c6\u4e2d\u7684\u53e5\u5b50\u957f\u5ea6\u4e3a 7 7 7\u3002\u5982\u679c\u6211\u4eec\u67e5\u770b\u4e0a\u9762\u7684\u5355\u8bcd\u5217\u8868\uff0c\u5b83\u7684\u957f\u5ea6\u4e3a 5 5 5\u3002\u4e3a\u4e86\u6ee1\u8db3\u957f\u5ea6\u4e3a 7 7 7\u7684\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u586b\u5145\u6807\u8bb0\u53eb [PAD] \uff0c\u8fd9\u6837\u6211\u4eec\u5f97\u5230\u7684\u5355\u8bcd\u5217\u8868\u5982\u4e0b\uff1a\n\ntokens = [ [CLS], I, love, Paris, [SEP], [PAD], [PAD] ]\n\n\u8fd9\u6837\u6211\u4eec\u7684\u5355\u8bcd\u5217\u8868\u957f\u5ea6\u5c31\u53d8\u6210 7 7 7\u4e86\u3002\u4e0b\u4e00\u6b65\u5c31\u662f\u8ba9\u6211\u4eec\u7684\u6a21\u578b\u7406\u89e3 [PAD] \u6807\u8bb0\u662f\u7528\u4e8e\u586b\u5145\u800c\u4e0d\u662f\u5b9e\u9645\u7684\u6807\u8bb0\u3002\u56e0\u6b64\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u6ce8\u610f\u529b\u5c4f\u853d(mask)\u3002\u6211\u4eec\u5c06\u6ce8\u610f\u529bmask\u4e2d\u6240\u6709\u5b9e\u9645\u6807\u8bb0\u4f4d\u7f6e\u90fd\u8bbe\u4e3a 1 1 1\uff0c\u800c [PAD] \u6807\u8bb0\u4f4d\u7f6e\u90fd\u8bbe\u4e3a 0 0 0\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e0b\u9762\u7684\u6ce8\u610f\u529bmask:\n\nattention_mask = [ 1,1,1,1,1,0,0]\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6620\u5c04\u6240\u6709\u6807\u8bb0\u5230\u4e00\u4e2a\u72ec\u7acb\u7684\u6807\u8bb0ID\u3002\u5047\u8bbe\u7528\u6620\u5c04\u540e\u7684\u6807\u8bb0ID\u5982\u4e0b\uff1a\n\ntoken_ids = [101, 1045, 2293, 3000, 102, 0, 0]\n\n\u5b83\u7684\u610f\u601d\u662f\u6807\u8bb0 [CLS] \u7684ID\u662f 101 101 101\uff1b\u6807\u8bb0 I \u7684DI\u662f 1045 1045 1045\u7b49\u7b49\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u5c06 token_ids \u4ee5\u53ca attention_mask \u4f5c\u4e3aBERT\u6a21\u578b\u7684\u8f93\u5165\uff0c\u7136\u540e\u83b7\u53d6\u6bcf\u4e2a\u6807\u8bb0\u7684\u76f8\u5e94\u5d4c\u5165\u8868\u793a\u3002\n\n\u4e0b\u56fe\u663e\u793a\u6211\u4eec\u5982\u4f55\u4f7f\u7528\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u6765\u83b7\u5f97\u5d4c\u5165\u8868\u793a\u7684\u3002\u4e3a\u4e86\u6e05\u6670\u8d77\u89c1\uff0c\u6211\u4eec\u753b\u51fa\u4e86\u6807\u8bb0\u672c\u8eab\u800c\u4e0d\u662f\u5b83\u7684ID\u3002\u4e00\u65e6\u6211\u4eec\u5c06\u6807\u8bb0\u4f5c\u4e3a\u8f93\u5165\u5582\u7ed9BERT\uff0c\u7f16\u7801\u56681(Encoder 1)\u8ba1\u7b97\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u7136\u540e\u4f20\u7ed9\u4e0b\u4e00\u4e2a\u7f16\u7801\u5668\u2014\u2014\u7f16\u7801\u56682\u3002\u7f16\u7801\u56682\u5c06\u7f16\u7801\u56681\u8ba1\u7b97\u7684\u5d4c\u5165\u8868\u793a\u4f5c\u4e3a\u8f93\u5165\uff0c\u7136\u540e\u8f93\u51fa\u4e00\u4e2a\u65b0\u7684\u5d4c\u5165\u8868\u793a\uff0c\u63a5\u7740\u7ee7\u7eed\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u7f16\u7801\u5668\u3002\u8fd9\u6837\u6bcf\u4e2a\u7f16\u7801\u5668\u90fd\u628a\u81ea\u5df1\u8f93\u51fa\u7684\u5d4c\u5165\u8868\u793a\u4f20\u9012\u5230\u5b83\u4e0a\u9762\u7684\u4e0b\u4e00\u4e2a\u7f16\u7801\u5668\u3002\u800c\u6700\u540e\u7684\u7f16\u7801\u5668\uff0c\u8fd4\u56de\u7684\u662f\u6211\u4eec\u53e5\u5b50\u4e2d\u6240\u6709\u6807\u8bb0\u7684\u6700\u7ec8\u5d4c\u5165\u8868\u793a\u3002\n\n\u8fd9\u6837 R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\u5c31\u662f\u6807\u8bb0 [CLS] \u7684\u5d4c\u5165\uff0c R I R_I RI\u200b\u662f\u6807\u8bb0 I \u7684\u5d4c\u5165\uff0c\u7b49\u7b49\u3002\n\n\u5728\u672c\u4f8b\u4e2d\uff0c\u6bcf\u4e2a\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u5927\u5c0f\u4e3a768\u3002\n\n\u6211\u4eec\u73b0\u5728\u5f97\u5230\u4e86\u53e5\u5b50\u4e2d\u6bcf\u4e2a\u5355\u8bcd\u7684\u5d4c\u5165\u8868\u793a\uff0c\u90a3\u6211\u4eec\u5982\u4f55\u5f97\u5230\u6574\u4e2a\u53e5\u5b50\u7684\u5d4c\u5165\u8868\u793a\u5462\uff1f\n\n\u6211\u4eec\u5728\u53e5\u9996\u4f4d\u7f6e\u6709 [CLS] \u6807\u8bb0\uff0c\u8be5\u6807\u8bb0\u7684\u8f93\u51fa\u4f1a\u4fdd\u5b58\u4e86\u6574\u4e2a\u5b8c\u6574\u53e5\u5b50\u7684\u805a\u5408\u4fe1\u606f\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565\u6240\u6709\u5176\u4ed6\u6807\u8bb0\u7684\u5d4c\u5165\uff0c\u4ec5\u7528 [CLS] \u6807\u8bb0\u7684\u8f93\u51fa\u5d4c\u5165\u6765\u4f5c\u4e3a\u6211\u4eec\u53e5\u5b50\u7684\u8868\u793a\u3002\n\n\u4f7f\u7528\u540c\u6837\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u8bad\u7ec3\u96c6\u4e2d\u6240\u6709\u53e5\u5b50\u7684\u5411\u91cf\u8868\u793a\u3002\u4e00\u65e6\u6211\u4eec\u6709\u4e86\u8fd9\u4e9b\u53e5\u5b50\u8868\u793a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5b83\u4eec\u4f5c\u4e3a\u8f93\u5165\u53bb\u8bad\u7ec3\u4e00\u4e2a\u5206\u7c7b\u5668\u5b8c\u6210\u60c5\u7eea\u8bc6\u522b\u4efb\u52a1\u3002\n\n\u8bf7\u6ce8\u610f\u4f7f\u7528 [CLS] \u6807\u8bb0\u7684\u8f93\u51fa\u5411\u91cf\u4f5c\u4e3a\u53e5\u5b50\u8868\u793a\u5e76\u4e0d\u603b\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\u3002\u83b7\u5f97\u53e5\u5b50\u8868\u793a\u7684\u6709\u6548\u65b9\u6cd5\u662f\u5bf9\u6240\u6709\u6807\u8bb0\u8fdb\u884c\u5e73\u5747\u6216\u6c60\u5316(pooling)\u3002\n\n\u5728\u4e0b\u8282\u4e2d\uff0c\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u4f7f\u7528Hugging Face\ud83e\udd17\u63d0\u4f9b\u7684 transformers \u5e93\u6765\u5b9e\u73b0\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\u8fd9\u4e9b\u4e8b\u60c5\u3002\n\nHugging Face transformers\n\nHugging Face\ud83e\udd17\u603b\u90e8\u4f4d\u4e8e\u7ebd\u7ea6\uff0c\u662f\u4e00\u5bb6\u4e13\u6ce8\u4e8e\u81ea\u7136\u8bed\u8a00\u5904\u7406\u3001\u4eba\u5de5\u667a\u80fd\u548c\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u521b\u4e1a\u516c\u53f8\u3002\u4ed6\u4eec\u6240\u63d0\u4f9b\u7684\u804a\u5929\u673a\u5668\u4eba\u6280\u672f\u4e00\u76f4\u9887\u53d7\u6b22\u8fce\uff0c\u4f46\u66f4\u51fa\u540d\u7684\u662f\u4ed6\u4eec\u5728NLP\u5f00\u6e90\u793e\u533a\u4e0a\u7684\u8d21\u732e\u3002Hugging Face\u4e00\u76f4\u81f4\u529b\u4e8e\u81ea\u7136\u8bed\u8a00\u5904\u7406NLP\u6280\u672f\u7684\u5e73\u6c11\u5316(democratize)\uff0c\u5e0c\u671b\u6bcf\u4e2a\u4eba\u90fd\u80fd\u7528\u4e0a\u6700\u5148\u8fdb(SOTA, state-of-the-art)\u7684NLP\u6280\u672f\uff0c\u800c\u975e\u56f0\u7a98\u4e8e\u8bad\u7ec3\u8d44\u6e90\u7684\u532e\u4e4f\u3002\u4ed6\u4eec\u7684 transformers \u5e93\u540c\u65f6\u63d0\u4f9b\u4e86TesnforFlow\u548cPyTorch\u7248\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 pip \u5b89\u88c5 transformers \uff1a\n\npip install transformers==4.10.0\n\n\u751f\u6210BERT\u5d4c\u5165\n\n\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u4f1a\u5b66\u4e60\u5982\u4f55\u4ece\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u4e2d\u62bd\u53d6\u5d4c\u5165\u8868\u793a\u3002\u8003\u8651\u53e5\u5b50\uff1a I love Paris \u3002\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u83b7\u5f97\u53e5\u5b50\u4e2d\u6240\u6709\u5355\u8bcd\u7684\u4e0a\u4e0b\u6587\u5355\u8bcd\u5d4c\u5165\u3002\n\n\u9996\u5148\u6211\u4eec\u5f15\u5165\u9700\u8981\u7684\u5305\uff1a\n\nfrom transformers import BertModel , BertTokenizer import torch\n\n\u4e0b\u9762\u6211\u4eec\u4e0b\u8f7d\u9884\u8bad\u7ec3\u597d\u7684BERT\u6a21\u578b\u3002\u6211\u4eec\u53ef\u4ee5\u4ecehttps://huggingface.co/models\u9875\u9762\u67e5\u770b\u6240\u6709\u53ef\u7528\u7684\u9884\u8bad\u7ec3\u6a21\u578b\u3002\u6211\u4eec\u4f7f\u7528\u7684\u662f bert-base-uncased \u6a21\u578b\uff0c\u5b83\u57fa\u4e8e12\u4e2a\u7f16\u7801\u5668\u5c42\u3001\u5e76\u4e14\u5728\u5c0f\u5199\u7684\u6807\u8bb0\u4e2d\u8bad\u7ec3\uff0c\u8868\u793a\u5411\u91cf\u7684\u5927\u5c0f\u4e3a768\u3002\n\n\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u9884\u8bad\u7ec3\u7684 bert-base-uncased \u6a21\u578b\uff1a\n\nmodel = BertModel . from_pretrained ( 'bert-base-uncased' )\n\n\u4e0b\u9762\u6211\u4eec\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u7528\u6765\u9884\u8bad\u7ec3 bert-base-uncased \u6a21\u578b\u7684\u5206\u8bcd\u5668\uff1a\n\ntokenizer = BertTokenizer . from_pretrained ( 'bert-base-uncased' )\n\n\u73b0\u5728\uff0c\u6211\u4eec\u770b\u770b\u5982\u4f55\u5904\u7406\u8f93\u5165\u3002\n\n\u9884\u5904\u7406\u8f93\u5165\n\n\u5b9a\u4e49\u53e5\u5b50\uff1a\n\nsentence = 'I love Paris'\n\n\u5206\u8bcd\u5e76\u83b7\u5f97\u5206\u8bcd\u540e\u7684\u6807\u8bb0\uff1a\n\ntokens = tokenizer . tokenize ( sentence ) print ( tokens )\n\n\u8f93\u51fa\uff1a\n\n['i', 'love', 'paris']\n\n\u63a5\u7740\uff0c\u6211\u4eec\u589e\u52a0 [CLS] \u6807\u8bb0\u5230\u6807\u8bb0\u5217\u8868\u5934\u90e8\uff1b\u589e\u52a0 [SEP] \u5230\u6807\u8bb0\u5217\u8868\u5c3e\u90e8\uff1a\n\ntokens = [ '[CLS]' ] + tokens + [ '[SEP]' ] print ( tokens )\n\n\u8f93\u51fa\uff1a\n\n['[CLS]', 'i', 'love', 'paris', '[SEP]']\n\n\u73b0\u5728\u6211\u4eec\u7684\u6807\u8bb0\u5217\u8868 tokens \u5927\u5c0f\u4e3a 5 5 5\u3002\u5047\u8bbe\u6211\u4eec\u60f3\u4fdd\u6301 tokens \u957f\u5ea6\u4e3a 7 7 7\uff1b\u6b64\u65f6\uff0c\u6211\u4eec\u589e\u52a0\u4e24\u4e2a\u586b\u5145\u6807\u8bb0 [PAD] \u5230 tokens \u672b\u5c3e\uff1a\n\ntokens = tokens + [ '[PAD]' ] + [ '[PAD]' ] tokens\n\n\u8f93\u51fa\uff1a\n\n['[CLS]', 'i', 'love', 'paris', '[SEP]', '[PAD]', '[PAD]']\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6ce8\u610f\u529b\u5c4f\u853d attention_mask \uff1a\n\nattention_mask = [ 1 if i != '[PAD]' else 0 for i in tokens ] attention_mask\n\n\u8f93\u51fa\uff1a\n\n[1, 1, 1, 1, 1, 0, 0]\n\n\u63a5\u7740\uff0c\u6211\u4eec\u5c06\u6240\u6709\u7684\u6807\u8bb0\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684ID\uff1a\n\ntoken_ids = tokenizer . convert_tokens_to_ids ( tokens ) token_ids\n\n\u8f93\u51fa\uff1a\n\n[101, 1045, 2293, 3000, 102, 0, 0]\n\n\u73b0\u5728\uff0c\u6211\u4eec\u901a\u8fc7\u5c06 token_ids \u548c attention_mask \u8f6c\u6362\u4e3aTensor\uff1a\n\ntoken_ids = torch . tensor ( token_ids ) . unsqueeze ( 0 ) attention_mask = torch . tensor ( attention_mask ) . unsqueeze ( 0 )\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u628a\u8fd9\u4e24\u4e2a\u53d8\u91cf\u5582\u7ed9\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u5f97\u5230\u5d4c\u5165\u8868\u793a\u3002\n\n\u83b7\u5f97\u5d4c\u5165\u8868\u793a\n\n\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u6240\u793a\uff0c\u6211\u4eec\u5c06 token_ids \u548c attention_mask \u4f20\u5165\u6a21\u578b\u5f97\u5230\u5d4c\u5165\u8868\u793a\u3002\u6ce8\u610f\u6a21\u578b\u8fd4\u56de\u7684\u8f93\u51fa\u662f\u6709\u4e24\u4e2a\u503c\u7684\u5143\u7ec4\u3002\u7b2c\u4e00\u4e2a\u503c\u4ee3\u8868\u9690\u85cf\u72b6\u6001\u8868\u793a hidden_rep \uff0c\u5b83\u5305\u542b\u4ece\u6700\u7ec8\u7f16\u7801\u5668(encoder 12)\u83b7\u53d6\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff1b\u7b2c\u4e8c\u4e2a\u503c cls_head \u5305\u542b [CLS] \u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff1a\n\nhidden_rep , cls_head = model ( token_ids , attention_mask = attention_mask , return_dict = False )\n\nhidden_rep \u5305\u542b\u8f93\u5165\u4e2d\u6240\u6709\u5355\u8bcd\u7684\u5d4c\u5165\u8868\u793a\uff0c\u6211\u4eec\u6253\u5370\u4e00\u4e0b\u5b83\u7684\u5f62\u72b6\uff1a\n\nprint ( hidden_rep . shape )\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 7, 768]) # [batch_size, sequence_length, hidden_size]\n\n\u6211\u4eec\u7684\u6279\u5927\u5c0f\u4e3a 1 1 1\uff1b\u5e8f\u5217\u957f\u5ea6\u5c31\u662f\u6807\u8bb0\u5217\u8868\u957f\u5ea6\uff0c\u4e3a 7 7 7\uff1b\u9690\u85cf\u5927\u5c0f\u662f\u5d4c\u5165\u8868\u793a\u5927\u5c0f\uff0c\u4e3a 768 768 768\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u50cf\u4e0b\u9762\u7684\u65b9\u5f0f\u83b7\u53d6\u6bcf\u4e2a\u8868\u793a\u7684\u5d4c\u5165\u8868\u793a\uff1a\n\nhidden_rep[0][0] \u8fd4\u56de\u7b2c\u4e00\u4e2a\u6807\u8bb0 [CLS] \u7684\u5d4c\u5165\u8868\u793a\n\n\u8fd4\u56de\u7b2c\u4e00\u4e2a\u6807\u8bb0 \u7684\u5d4c\u5165\u8868\u793a hidden_rep[0][1] \u8fd4\u56de\u7b2c\u4e8c\u4e2a\u6807\u8bb0 I \u7684\u5d4c\u5165\u8868\u793a\n\n\u8fd4\u56de\u7b2c\u4e8c\u4e2a\u6807\u8bb0 \u7684\u5d4c\u5165\u8868\u793a hidden_rep[0][2] \u8fd4\u56de\u7b2c\u4e09\u4e2a\u6807\u8bb0 love \u7684\u5d4c\u5165\u8868\u793a\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u6240\u6709\u6807\u8bb0\u7684\u4e0a\u4e0b\u6587\u8868\u793a\u3002\u8fd9\u57fa\u672c\u4e0a\u662f\u7ed9\u5b9a\u53e5\u5b50\u4e2d\u6240\u6709\u5355\u8bcd\u7684\u4e0a\u4e0b\u6587\u8bcd\u5d4c\u5165\u8868\u793a\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u6765\u770b\u4e0b cls_head \u3002\u5b83\u5305\u542b [CLS] \u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff0c\u6211\u4eec\u6253\u5370\u4e00\u4e0b\u5b83\u7684\u5f62\u72b6\uff1a\n\nprint ( cls_head . shape )\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 768]) # [batch_size, hidden_size]\n\n\u6211\u4eec\u77e5\u9053 cls_head \u5305\u542b\u6574\u4e2a\u53e5\u5b50\u7684\u805a\u5408\u8868\u793a\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5\u5bf9\u8c61\u4f5c\u4e3a\u53e5\u5b50 I love Paris \u7684\u5d4c\u5165\u8868\u793a\u3002\n\n\u6211\u4eec\u5b66\u4e60\u4e86\u5982\u4f55\u4ece\u9884\u8bad\u7ec3\u7684 BERT \u6a21\u578b\u4e2d\u63d0\u53d6\u5d4c\u5165\u3002 \u4f46\u8fd9\u4e9b\u662f\u4ec5\u4ece BERT \u7684\u6700\u9876\u5c42\u7f16\u7801\u5668\u5c42\uff08\u5373encoder 12\uff09\u83b7\u5f97\u7684\u5d4c\u5165\u3002\u6211\u4eec\u662f\u5426\u4e5f\u53ef\u4ee5\u4ece BERT \u7684\u6240\u6709\u7f16\u7801\u5668\u5c42\u4e2d\u63d0\u53d6\u5d4c\u5165\uff1f\n\n\u6211\u4eec\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u4e86\u89e3\u5982\u4f55\u505a\u5230\u8fd9\u4e00\u70b9\u3002\n\n\u4eceBERT\u6240\u6709\u7f16\u7801\u5668\u5c42\u4e2d\u62bd\u53d6\u5d4c\u5165\n\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u5982\u4f55\u4ece\u9884\u8bad\u7ec3\u7684BERT\u4e2d\u62bd\u53d6\u5d4c\u5165\u3002\u90a3\u5982\u4f55\u4eceBERT\u7684\u6240\u6709\u7f16\u7801\u5668\u5c42\u4e2d\u62bd\u53d6\u5d4c\u5165\u5462\uff1f\n\n\u5047\u8bbe\u8f93\u5165\u5c42\u4e3a h 0 h_0 h0\u200b\uff0c\u7b2c\u4e00\u4e2a\u7f16\u7801\u5668\u5c42\u4e3a h 1 h_1 h1\u200b\uff0c\u7b2c\u4e8c\u4e2a\u7f16\u7801\u5668\u5c42\u4e3a h 2 h_2 h2\u200b\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42\u4e3a h 12 h_{12} h12\u200b\uff1a\n\nBERT\u7684\u7814\u7a76\u8005\u5df2\u7ecf\u5b9e\u9a8c\u8fc7\u4ece\u4e0d\u540c\u7684\u7f16\u7801\u5668\u5c42\u4e2d\u63d0\u53d6\u5d4c\u5165\u3002\n\n\u6bd4\u5982\uff0c\u4ee5NER\u4efb\u52a1\u6765\u8bf4\uff0c\u7814\u7a76\u8005\u5df2\u7ecf\u4f7f\u7528\u4e0e\u8bad\u7ec3\u7684BERT\u6a21\u578b\u6765\u62bd\u53d6\u7279\u5f81\u3002\u4ed6\u4eec\u5b9e\u9a8c\u4e86\u4e0d\u540c\u7f16\u7801\u5668\u5c42\u7684\u7279\u5f81\uff0c\u7136\u540e\u5f97\u5230\u4e86\u5982\u4e0b\u7684F1\u503c\uff1a\n\n\u5982\u4e0a\u8868\u6240\u793a\uff0c\u62fc\u63a5\u6700\u540e4\u4e2a\u7f16\u7801\u5668\u5c42\u7684\u8868\u793a(conncat last four hidden)\u53ef\u4ee5\u5f97\u5230\u6700\u597d\u7684F1\u503c\u2014\u201496.1%\u3002\u8fd9\u8bf4\u660e\u4e86\uff0c\u4e0d\u4ec5\u4ec5\u662f\u62bd\u53d6\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42\u7684\u8f93\u51fa\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u5176\u4ed6\u7f16\u7801\u5668\u5c42\u3002\n\n\u73b0\u5728\uff0c \u6211\u4eec\u63a5\u4e0b\u6765\u4f1a\u5b66\u4e60\u5982\u4f55\u4f7f\u7528 transformers \u4ece\u6240\u6709\u7684\u7f16\u7801\u5668\u5c42\u4e2d\u62bd\u53d6\u5d4c\u5165\u8868\u793a\u3002\n\n\u62bd\u53d6\u5d4c\u5165\u8868\u793a\n\n\u9996\u5148\uff0c\u6211\u4eec\u5bfc\u5165\u5fc5\u987b\u7684\u5305\uff1a\n\nfrom transformers import BertModel , BertTokenizer import torch\n\n\u63a5\u7740\uff0c\u4e0b\u8f7d\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u548c\u5206\u8bcd\u5668\u3002\u6b63\u5982\u6211\u4eec\u770b\u5230\u7684\uff0c\u5728\u4e0b\u8f7d\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u65f6\uff0c\u6211\u4eec\u9700\u8981\u8bbe\u7f6e output_hidden_states=True \uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u83b7\u5f97\u6240\u6709\u7f16\u7801\u5668\u5c42\u7684\u5d4c\u5165\uff1a\n\nmodel = BertModel . from_pretrained ( 'bert-base-uncased' , output_hidden_states = True ) tokenizer = BertTokenizer . from_pretrained ( 'bert-base-uncased' )\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u5bf9\u8f93\u5165\u8fdb\u884c\u4e00\u4e9b\u9884\u5904\u7406\u3002\n\n\u9884\u5904\u7406\u8f93\u5165\n\n\u5047\u8bbe\u6211\u4eec\u8fd8\u662f\u8003\u8651\u4e0a\u5c0f\u8282\u770b\u5230\u7684\u4f8b\u5b50\u3002\u9996\u5148\uff0c\u6211\u4eec\u5bf9\u53e5\u5b50\u8fdb\u884c\u5206\u8bcd\u5e76\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\uff1a\n\nsentence = 'I love Paris' tokens = tokenizer . tokenize ( sentence ) tokens = [ '[CLS]' ] + tokens + [ '[SEP]' ]\n\n\u5047\u8bbe\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6807\u8bb0\u5217\u8868\u7684\u957f\u5ea6\u4e3a 7 7 7\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u589e\u52a0\u586b\u5145\u6807\u8bb0 [PAD] \u540c\u65f6\u5b9a\u4e49\u6ce8\u610f\u529bmask:\n\ntokens = tokens + [ '[PAD]' ] + [ '[PAD]' ] attention_mask = [ 1 if i != '[PAD]' else 0 for i in tokens ]\n\n\u4e0b\u9762\u6211\u4eec\u5c06 tokens \u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684ID\uff1a\n\ntoken_ids = tokenizer . convert_tokens_to_ids ( tokens )\n\n\u73b0\u5728\uff0c \u6211\u4eec\u8f6c\u6362 token_ids \u548c attention_mask \u5230Tensor:\n\ntoken_ids = torch . tensor ( token_ids ) . unsqueeze ( 0 ) attention_mask = torch . tensor ( attention_mask ) . unsqueeze ( 0 )\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5904\u7406\u5b8c\u6bd5\u4e86\uff0c\u4e0b\u9762\u53ef\u4ee5\u83b7\u53d6\u5d4c\u5165\u4e86\u3002\n\n\u5f97\u5230\u5d4c\u5165\u8868\u793a\n\n\u7531\u4e8e\u6211\u4eec\u5728\u5b9a\u4e49\u6a21\u578b\u65f6\u8bbe\u7f6e\u4e86 output_hidden_states = True \u4ee5\u4ece\u6240\u6709\u7f16\u7801\u5668\u5c42\u83b7\u53d6\u5d4c\u5165\uff0c\u73b0\u5728\u6a21\u578b\u8fd4\u56de\u4e00\u4e2a\u4e09\u4e2a\u5143\u7d20\u7684\u5143\u7ec4:\n\nlast_hidden_state , pooler_output , hidden_states = model ( token_ids , attention_mask = attention_mask , return_dict = False )\n\n\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u5206\u6790\u5982\u4e0b\uff1a\n\n\u7b2c\u4e00\u4e2a\u503c\uff0c last_hidden_state \u5305\u542b\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff0c\u4f46\u662f\u4ec5\u6765\u81ea\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42(encoder 12)\n\n\u5305\u542b\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff0c\u4f46\u662f\u4ec5\u6765\u81ea\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42(encoder 12) pooler_output \u4ee3\u8868\u4ece\u6700\u540e\u7684\u7f16\u7801\u5668\u5c42\u5f97\u5230\u7684 [CLS] \u6807\u8bb0\u5bf9\u5e94\u7684\u5d4c\u5165\u8868\u793a\uff0c \u4f46\u8fdb\u4e00\u6b65\u5730\u901a\u8fc7\u4e00\u4e2a\u7ebf\u6027\u548ctanh\u6fc0\u6d3b\u51fd\u6570( BertPooler )\u5904\u7406 \u3002\n\n\u4ee3\u8868\u4ece\u6700\u540e\u7684\u7f16\u7801\u5668\u5c42\u5f97\u5230\u7684 \u6807\u8bb0\u5bf9\u5e94\u7684\u5d4c\u5165\u8868\u793a\uff0c \u3002 hidden_states \u5305\u542b\u4ece\u6240\u6709\u7f16\u7801\u5668\u5c42\u5f97\u5230\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\n\nclass BertPooler ( nn . Module ) : def __init__ ( self , config ) : super ( ) . __init__ ( ) self . dense = nn . Linear ( config . hidden_size , config . hidden_size ) self . activation = nn . Tanh ( ) def forward ( self , hidden_states ) : first_token_tensor = hidden_states [ : , 0 ] pooled_output = self . dense ( first_token_tensor ) pooled_output = self . activation ( pooled_output ) return pooled_output\n\n\u73b0\u5728\uff0c\u6211\u4eec\u9010\u4e2a\u4e86\u89e3\u4e0b\u6bcf\u4e2a\u503c\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u770b\u4e00\u4e0b last_hidden_state \uff0c\u6211\u4eec\u8f93\u51fa\u5b83\u7684\u5f62\u72b6\uff1a\n\nlast_hidden_state . shape . shape\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 7, 768]) # [batch_size, sequence_length, hidden_size]\n\n\u6211\u4eec\u7684\u6279\u5927\u5c0f\u4e3a 1 1 1\u3002\u5e8f\u5217\u957f\u5ea6\u5c31\u662f\u6807\u8bb0\u5217\u8868\u957f\u5ea6\uff0c\u4e3a 7 7 7\u3002\u9690\u85cf\u5927\u5c0f\u662f\u5d4c\u5165\u8868\u793a\u7684\u5927\u5c0f\uff0c\u8fd9\u91cc\u662f 768 768 768\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c\u4e0b\u9762\u7684\u65b9\u6cd5\u83b7\u53d6\u6bcf\u4e2a\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\uff1a\n\nlast_hidden_state[0][0] \u8f93\u51fa\u7b2c\u4e00\u4e2a\u6807\u8bb0 [CLS] \u7684\u5d4c\u5165\u8868\u793a\n\nlast_hidden_state[0][1] \u8f93\u51fa\u7b2c\u4e8c\u4e2a\u6807\u8bb0 I \u7684\u5d4c\u5165\u8868\u793a\n\nlast_hidden_state[0][2] \u8f93\u51fa\u7b2c\u4e09\u4e2a\u6807\u8bb0 love \u7684\u5d4c\u5165\u8868\u793a\n\n\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42\u5f97\u5230\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u3002\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u6765\u770b pooler_output \uff0c\u5b83\u5305\u542b\u6700\u540e\u7684\u7f16\u7801\u5668\u5c42\u5f97\u5230\u7684 [CLS] \u6807\u8bb0\u5bf9\u5e94\u7684\u5d4c\u5165\u8868\u793a\u3002\u6211\u4eec\u6253\u5370\u5b83\u7684\u5f62\u72b6\uff1a\n\npooler_output . shape\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 768]) # [batch_size, hidden_size]\n\n\u6211\u4eec\u77e5\u9053 [CLS] \u6807\u8bb0\u4fdd\u5b58\u7684\u662f\u6574\u4e2a\u53e5\u5b50\u7684\u805a\u5408\u8868\u793a\u3002\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 pooler_output \u6765\u4f5c\u4e3a\u53e5\u5b50 I love Paris \u7684\u53e5\u5b50\u8868\u793a\u3002\n\n\u6700\u540e\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b hidden_states \u3002\u5b83\u662f\u4e00\u4e2a\u5305\u542b13\u4e2a\u503c\u7684\u5143\u7ec4\uff0c\u4fdd\u5b58\u4e86\u4ece\u8f93\u5165\u5c42 h 0 h_0 h0\u200b\u5230\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5c42 h 12 h_{12} h12\u200b\u7684\u6240\u6709\u5d4c\u5165\u8868\u793a\uff1a\n\nlen ( hidden_states )\n\n\u8f93\u51fa\uff1a\n\n13\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd913\u4e2a\u503c\u5305\u542b\u4e86\u6240\u6709\u5c42\u7684\u8868\u793a\uff1a\n\nhidden_states[0] \u5305\u542b\u8f93\u5165\u5d4c\u5165\u5c42 h 0 h_0 h0\u200b\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\n\nhidden_states[1] \u5305\u542b\u7b2c\u4e00\u4e2a\u7f16\u7801\u5668\u5d4c\u5165\u5c42 h 1 h_1 h1\u200b\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\n\nhidden_states[2] \u5305\u542b\u7b2c\u4e8c\u4e2a\u7f16\u7801\u5668\u5d4c\u5165\u5c42 h 2 h_2 h2\u200b\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\n\nhidden_states[12] \u5305\u542b\u6700\u540e\u4e00\u4e2a\u7f16\u7801\u5668\u5d4c\u5165\u5c42 h 1 2 h_12 h1\u200b2\u7684\u6240\u6709\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\n\n\u6211\u4eec\u63a5\u7740\u6253\u5370 hidden_states[0] \u7684\u5f62\u72b6\uff1a\n\nhidden_states [ 0 ] . shape\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 7, 768]) # [batch_size, sequence_length, hidden_size]\n\n\u7136\u540e\uff0c\u6253\u5370 hidden_states[1] \u7684\u5f62\u72b6\uff1a\n\nhidden_states [ 1 ] . shape\n\n\u8f93\u51fa\uff1a\n\ntorch.Size([1, 7, 768])\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u6240\u6709\u7f16\u7801\u5668\u5c42\u7684\u6807\u8bb0\u5bf9\u5e94\u7684\u5d4c\u5165\u8868\u793a\u3002\u4e0b\u9762\u6211\u4eec\u6765\u5b66\u4e60\u4e0b\u5982\u4f55\u628a\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\n\n\u5e94\u7528\u5230\u4e0b\u6e38\u4efb\u52a1\uff0c\u6bd4\u5982\u60c5\u7eea\u5206\u6790\u3002\n\n\u4e3a\u4e0b\u6e38\u4efb\u52a1\u5fae\u8c03BERT\n\n\u6ce8\u610f\u5fae\u8c03\u610f\u5473\u7740\u6211\u4eec\u4e0d\u4f1a\u4ece\u5934\u5f00\u59cb\u8bad\u7ec3BERT\u3002\u800c\u662f\u4f7f\u7528\u9884\u8bad\u7ec3\u7684BERT\uff0c\u7136\u540e\u6839\u636e\u4efb\u52a1\u6765\u66f4\u65b0\u5b83\u7684\u6743\u91cd\u53c2\u6570\u3002\n\n\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u4f1a\u5b66\u4e60\u5230\u5982\u4f55\u4e3a\u4ee5\u4e0b\u7684\u4e0b\u6e38\u4efb\u52a1\u5fae\u8c03BERT\u6a21\u578b\uff1a\n\n\u6587\u672c\u5206\u7c7b\n\n\u81ea\u7136\u8bed\u8a00\u63a8\u7406\n\n\u547d\u540d\u5b9e\u4f53\u8bc6\u522b\n\n\u95ee\u7b54\u4efb\u52a1\n\n\u6587\u672c\u5206\u7c7b\n\n\u6211\u4eec\u5148\u6765\u5b66\u4e60\u5982\u4f55\u4e3a\u4e00\u4e2a\u6587\u672c\u5206\u7c7b\u4efb\u52a1\u5fae\u8c03BERT\u6a21\u578b\u3002\u5047\u8bbe\u6211\u4eec\u5177\u4f53\u8981\u505a\u7684\u662f\u60c5\u7eea\u8bc6\u522b\u3002\u5728\u60c5\u7eea\u8bc6\u522b\u4efb\u52a1\u4e2d\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u5224\u65ad\u4e00\u4e2a\u53e5\u5b50\u5230\u5e95\u662f\u6b63\u5411\u7684\u8fd8\u662f\u8d1f\u5411\u7684\u3002\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u5305\u542b\u53e5\u5b50\u548c\u5bf9\u5e94\u6807\u7b7e\u7684\u6570\u636e\u96c6\u3002\n\n\u8003\u8651\u53e5\u5b50\uff1a I love Paris \u3002\u9996\u5148\uff0c\u5f53\u7136\u8fd8\u662f\u5206\u8bcd\uff0c\u7136\u540e\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\u3002\n\n\u7136\u540e\u6211\u4eec\u5c06\u8fd9\u4e9b\u6807\u8bb0\u8f93\u5165\u5230BERT\u6a21\u578b\uff0c\u5f97\u5230\u6bcf\u4e2a\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u3002\n\n\u4e0b\u9762\u6211\u4eec\u53ea\u62ff [CLS] \u6807\u8bb0\u5bf9\u5e94\u7684\u5d4c\u5165\u8868\u793a R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\uff0c\u800c\u5ffd\u7565\u6240\u6709\u5176\u4ed6\u7684\u6807\u8bb0\u3002\u56e0\u4e3a\u6211\u4eec\u77e5\u9053 [CLS] \u7684\u5d4c\u5165\u5305\u542b\u4e86\u6574\u4e2a\u53e5\u5b50\u7684\u805a\u5408\u8868\u793a\u3002\u6211\u4eec\u5c06 R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\u5582\u7ed9\u4e00\u4e2a\u5206\u7c7b\u5668(\u5e26\u6709softmax\u51fd\u6570\u7684\u524d\u9988\u795e\u7ecf\u7f51\u7edc)\uff0c\u7136\u540e\u8bad\u7ec3\u8be5\u5206\u7c7b\u5668\u53bb\u505a\u60c5\u7eea\u8bc6\u522b\u4efb\u52a1\u3002\n\n\u7b49\u7b49\uff01\u8fd9\u548c\u6211\u4eec\u5728\u672c\u8282\u5f00\u5934\u770b\u5230\u7684\u6709\u4ec0\u4e48\u4e0d\u540c\uff1f\u5fae\u8c03\u9884\u8bad\u7ec3\u7684 BERT \u6a21\u578b\u4e0e\u4f7f\u7528\u9884\u5148\u8bad\u7ec3\u7684 BERT \u6a21\u578b\u4f5c\u4e3a\u7279\u5f81\u63d0\u53d6\u5668\u6709\u4f55\u4e0d\u540c\uff1f\n\n\u5728\u4ece\u9884\u8bad\u7ec3\u7684BERT\u4e2d\u62bd\u53d6\u5d4c\u5165\u8868\u793a\u5c0f\u8282\u4e2d\uff0c\u6211\u4eec\u77e5\u9053\u5728\u63d0\u53d6\u53e5\u5b50\u7684\u5d4c\u5165\u540e\uff0c\u6211\u4eec\u5c06 R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\u63d0\u4f9b\u7ed9\u5206\u7c7b\u5668\u5e76\u8bad\u7ec3\u5206\u7c7b\u5668\u6267\u884c\u5206\u7c7b\u3002\u7c7b\u4f3c\u5730\uff0c\u5728\u5fae\u8c03\u671f\u95f4\uff0c\u6211\u4eec\u4e5f\u5c06 R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\u5582\u7ed9\u4e00\u4e2a\u5206\u7c7b\u5e76\u8bad\u7ec3\u5206\u7c7b\u5668\u6267\u884c\u5206\u7c7b\u3002\n\n\u4e0d\u540c\u70b9\u5728\u4e8e\u5f53\u6211\u4eec\u5fae\u8c03\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u65f6\uff0c\u6211\u4eec\u5728\u66f4\u65b0\u5206\u7c7b\u5668\u7684\u53c2\u6570\u65f6\u4e5f\u4f1a\u66f4\u65b0BERT\u7684\u53c2\u6570\u3002\u4f46\u5f53\u6211\u4eec\u4f7f\u7528\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u4f5c\u4e3a\u7279\u5f81\u62bd\u53d6\u5668\u65f6\uff0c\u6211\u4eec\u53ea\u66f4\u65b0\u5206\u7c7b\u5668\u7684\u53c2\u6570\uff0c\u800c\u4e0d\u66f4\u65b0\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u3002\n\n\u5728\u5fae\u8c03\u671f\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u4e2a\u65b9\u5f0f\u8c03\u6574BERT\u6a21\u578b\u7684\u53c2\u6570\uff1a\n\n\u968f\u7740\u5206\u7c7b\u5668\u4e00\u8d77\u66f4\u65b0\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u7684\u53c2\u6570\n\n\u4ec5\u66f4\u65b0\u5206\u7c7b\u5668\u7684\u53c2\u6570\u800c\u4e0d\u66f4\u65b0\u9884\u8bad\u7ec3BERT\u6a21\u578b\u7684\u3002\u6b64\u65f6\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7c7b\u4f3c\u5c06\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u4f5c\u4e3a\u7279\u5f81\u62bd\u53d6\u5668\u7684\u60c5\u51b5\u3002\n\n\u4e0b\u56fe\u9610\u8ff0\u4e86\u6211\u4eec\u5982\u4f55\u4e3a\u4e00\u4e2a\u60c5\u7eea\u5206\u7c7b\u4efb\u52a1\u5fae\u8c03\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\uff1a\n\n\u6b63\u5982\u6211\u4eec\u770b\u5230\u7684\uff0c\u6211\u4eec\u5c06\u6807\u8bb0\u5217\u8868\u5582\u7ed9BERT\u6a21\u578b\u5e76\u5f97\u5230\u8fd9\u4e9b\u6807\u8bb0\u7684\u5d4c\u5165\u3002\u7136\u540e\u6211\u4eec\u62ff [CLS] \u6807\u8bb0\u7684\u5d4c\u5165\u4f5c\u4e3a\u524d\u9988\u795e\u7ecf\u7f51\u7edc\u7684\u8f93\u5165\uff0c\u5e76\u8fdb\u884c\u5206\u7c7b\u4efb\u52a1\u3002\n\n\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\uff0c\u8ba9\u6211\u4eec\u901a\u8fc7\u4ee3\u7801\u5bf9\u9884\u8bad\u7ec3\u7684 BERT \u6a21\u578b\u8fdb\u884c\u5fae\u8c03\u6765\u66f4\u597d\u5730\u4e86\u89e3\u5fae\u8c03\u7684\u5de5\u4f5c\u539f\u7406\u3002\n\n\u4e3a\u60c5\u7eea\u8bc6\u522b\u5fae\u8c03BERT\n\n\u8ba9\u6211\u4eec\u63a2\u7d22\u5982\u4f55\u4f7f\u7528 IMDB \u6570\u636e\u96c6\u4e3a\u60c5\u611f\u5206\u6790\u4efb\u52a1\u5fae\u8c03\u9884\u8bad\u7ec3\u7684 BERT \u6a21\u578b\u3002 IMDB \u6570\u636e\u96c6\u7531\u7535\u5f71\u8bc4\u8bba\u4ee5\u53ca\u8bc4\u8bba\u5bf9\u5e94\u60c5\u7eea\u7ec4\u6210\u3002\n\n\u5f15\u5165\u4f9d\u8d56\n\n\u9996\u5148\u6211\u4eec\u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\uff1a\n\n!pip install nlp == 0.4 .0 !pip install transformers == 4.10 .0\n\n\u5f15\u5165\u5fc5\u8981\u7684\u5305\uff1a\n\nfrom transformers import BertForSequenceClassification , BertTokenizerFast , Trainer , TrainingArguments from nlp import load_dataset import torch import numpy as np\n\n\u52a0\u8f7d\u6a21\u578b\u548c\u6570\u636e\u96c6\n\nimdbs\u6570\u636e\u96c6\u7f51\u4e0a\u5f88\u5e38\u89c1\uff0c\u4e5f\u53ef\u5173\u6ce8\u6587\u7ae0\u5e95\u90e8\u7684\u516c\u4f17\u53f7\uff0c\u56de\u590d imdbs \u83b7\u53d6\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528 nlp \u5305\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u6570\u636e\u96c6\uff1a\n\ndataset = load_dataset ( 'csv' , data_files = './imdbs.csv' , split = 'train' )\n\n\u6211\u4eec\u67e5\u770b\u6570\u636e\u7c7b\u578b\uff1a\n\ntype ( dataset )\n\n\u8f93\u51fa\uff1a\n\nnlp.arrow_dataset.Dataset\n\n\u4e0b\u9762\uff0c\u5c06\u6570\u636e\u96c6\u62c6\u5206\u4e3a\u8bad\u7ec3\u548c\u6d4b\u8bd5\u96c6\uff1a\n\ndataset = dataset . train_test_split ( test_size = 0.3 )\n\n\u6211\u4eec\u8f93\u51fa\u6570\u636e\u96c6 dataset \uff1a\n\n{'test': Dataset(features: {'text': Value(dtype='string', id=None), 'label': Value(dtype='int64', id=None)}, num_rows: 30), 'train': Dataset(features: {'text': Value(dtype='string', id=None), 'label': Value(dtype='int64', id=None)}, num_rows: 70)}\n\n\u73b0\u5728\u6211\u4eec\u521b\u5efa\u8bad\u7ec3\u548c\u6d4b\u8bd5\u96c6\uff1a\n\ntrain_set = dataset [ 'train' ] test_set = dataset [ 'test' ]\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9884\u8bad\u7ec3\u7684 bert-base-uncased \u6a21\u578b\u3002\u56e0\u4e3a\u6211\u4eec\u5728\u505a\u5e8f\u5217\u5206\u7c7b\u4efb\u52a1\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528 BertForSequenceClassification \u7c7b\uff1a\n\nmodel = BertForSequenceClassification . from_pretrained ( 'bert-base-uncased' )\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u7528\u4e8e\u9884\u8bad\u7ec3 bert-base-uncased \u6a21\u578b\u7684\u5206\u8bcd\u5668\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 BertTokenizerFast \u7c7b\u521b\u5efa\u5206\u8bcd\u5668\u800c\u4e0d\u662f BertTokenizer \u3002\u56e0\u4e3a BertTokenizerFast \u76f8\u6bd4 BertTokenizer \u5177\u6709\u5f88\u591a\u4f18\u52bf\u3002\u6211\u4eec\u4e0b\u8282\u4f1a\u63a2\u8ba8\u8fd9\u4e00\u70b9\u3002\n\ntokenizer = BertTokenizerFast . from_pretrained ( 'bert-base-uncased' )\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u52a0\u8f7d\u597d\u4e86\u6570\u636e\u96c6\u8d6b\u5c14\u6a21\u578b\uff0c\u8ba9\u6211\u4eec\u5f00\u59cb\u9884\u5904\u7406\u6570\u636e\u96c6\u5427\u3002\n\n\u9884\u5904\u7406\u6570\u636e\u96c6\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u7684\u5206\u8bcd\u5668\u5feb\u901f\u5730\u9884\u5904\u7406\u6570\u636e\u96c6\u3002\u6bd4\u5982\uff0c\u8003\u8651\u53e5\u5b50\uff1a I love Paris \u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u5206\u8bcd\u5e76\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\uff1a\n\ntokens = [ '[CLS]' , 'I' , 'love' , 'Paris' , '[SEP]' ]\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u6620\u5c04\u6807\u8bb0\u5230\u72ec\u7acb\u7684\u8f93\u5165ID\u3002\u5047\u8bbe\u6211\u4eec\u5f97\u5230\u4e0b\u9762\u7684ID\uff1a\n\ninput_ids = [101, 1045, 2293, 3000, 102]\n\n\u7136\u540e\uff0c\u6211\u4eec\u9700\u8981\u589e\u52a0\u7247\u6bb5ID(segment ID,\u6807\u8bb0\u7c7b\u578bID)\u3002\uff1f\uff1f\u4ec0\u4e48\u7247\u6bb5ID\uff1f\u5047\u8bbe\u6211\u4eec\u7684\u8f93\u5165\u6709\u4e24\u4e2a\u53e5\u5b50\uff0c\u6b64\u65f6\uff0c\u7247\u6bb5ID\u7528\u4e8e\u533a\u5206\u8fd9\u4e24\u4e2a\u53e5\u5b50\u3002\u6240\u6709\u6765\u81ea\u7b2c\u4e00\u4e2a\u53e5\u5b50\u7684\u6807\u8bb0\u4f1a\u6620\u5c04\u5230 0 \uff1b\u6240\u6709\u6765\u81ea\u7b2c\u4e8c\u4e2a\u53e5\u5b50\u7684\u6807\u8bb0\u4f1a\u6620\u5c04\u5230 1 \u3002\u56e0\u4e3a\u6211\u4eec\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2a\u53e5\u5b50\uff0c\u6240\u4ee5\u6240\u6709\u7684\u6807\u8bb0\u90fd\u4f1a\u6620\u5c04\u5230 0 \uff1a\n\ntoken_type_ids = [ 0 , 0 , 0 , 0 , 0 ]\n\n\u73b0\u5728\u6211\u4eec\u9700\u8981\u521b\u5efa\u6ce8\u610f\u529bmask\u3002\u6211\u4eec\u77e5\u9053\u6ce8\u610f\u529bmask\u7528\u4e8e\u533a\u5206\u771f\u5b9e\u6807\u8bb0\u548c\u586b\u5145\u6807\u8bb0 [PAD] \u3002\u5047\u8bbe\u6211\u4eec\u7684\u6807\u8bb0\u5217\u8868\u957f\u5ea6\u5e94\u8be5\u4e3a 5 5 5\u3002\u6211\u4eec\u8fd9\u91cc\u7684\u6807\u8bb0\u5217\u8868\u7684\u957f\u5ea6\u5e94\u662f 5 5 5\u4e86\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u589e\u52a0 [PAD] \u6807\u8bb0\u3002\u90a3\u4e48\u6211\u4eec\u7684\u6ce8\u610f\u529bmask\u5c31\u4f1a\u5982\u4e0b\uff1a\n\nattention_mask = [ 1 , 1 , 1 , 1 , 1 ]\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5206\u8bcd\u5668\u6765\u4e3a\u6211\u4eec\u505a\u4e0a\u9762\u8fd9\u4e9b\u624b\u52a8\u7684\u6b65\u9aa4\u3002\u53ea\u9700\u8981\u5c06\u53e5\u5b50\u4f20\u9012\u7ed9\u5206\u8bcd\u5668\u5373\u53ef\uff1a\n\ntokenizer ( 'I love Paris' )\n\n\u8f93\u51fa\u5982\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8f93\u5165\u53e5\u5b50\u88ab\u5206\u8bcd\u4e86\u5e76\u4e14\u6620\u5c04\u5230 input_ids \u3001 token_type_ids \uff0c\u540c\u65f6\u8fd8\u6709 attention_mask \uff1a\n\n{ 'input_ids': [101, 1045, 2293, 3000, 102], 'token_type_ids': [0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1] }\n\n\u901a\u8fc7\u5206\u8bcd\u5668\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u6570\u91cf\u7684\u53e5\u5b50\u5e76\u52a8\u6001\u5730\u6267\u884c\u586b\u5145\u3002\u6211\u4eec\u6267\u884c\u9700\u8981\u8bbe\u7f6e padding \u4e3a True \u548c\u6700\u5927\u7684\u53e5\u5b50\u957f\u5ea6 max_length \u3002\u6bd4\u5982\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u4f20\u51653\u4e2a\u53e5\u5b50\uff0c\u5e76\u5c06 max_length \u8bbe\u4e3a 5 \uff1a\n\ntokenizer ( [ 'I love Paris' , 'birds fly' , 'snow fall' ] , padding = True , max_length = 5 )\n\n\u524d\u9762\u7684\u4ee3\u7801\u5c06\u8fd4\u56de\u4ee5\u4e0b\u5185\u5bb9\u3002 \u5982\u6211\u4eec\u6240\u89c1\uff0c\u6240\u6709\u53e5\u5b50\u90fd\u6620\u5c04\u5230 input_ids \u3001 token_type_ids \u548c attention_mask \u3002 \u7b2c\u4e8c\u53e5\u548c\u7b2c\u4e09\u53e5\u53ea\u6709\u4e24\u4e2a\u6807\u8bb0\uff0c\u52a0\u4e0a [CLS] \u548c [SEP] \u540e\uff0c\u5c31\u4f1a\u67094\u4e2a\u6807\u8bb0\u3002 \u7531\u4e8e\u6211\u4eec\u5c06 padding \u8bbe\u7f6e\u4e3a True \u5e76\u5c06 max_length \u8bbe\u7f6e\u4e3a 5 \uff0c\u56e0\u6b64\u7b2c\u4e8c\u4e2a\u548c\u7b2c\u4e09\u4e2a\u53e5\u5b50\u4e2d\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u989d\u5916\u7684 [PAD] \u6807\u8bb0\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u5728\u7b2c\u4e8c\u4e2a\u548c\u7b2c\u4e09\u4e2a\u53e5\u5b50\u7684\u6ce8\u610f\u529bmask\u4e2d\u503c\u4e3a 0 \u7684\u539f\u56e0\uff1a\n\n{ 'input_ids': [[101, 1045, 2293, 3000, 102], [101, 5055, 4875, 102, 0], [101, 4586, 2991, 102, 0]], 'token_type_ids': [[0, 0, 0, 0, 0], [0, 0, 0, 0, 0], [0, 0, 0, 0, 0]], 'attention_mask': [[1, 1, 1, 1, 1], [1, 1, 1, 1, 0], [1, 1, 1, 1, 0]] }\n\n\u770b\uff0c\u901a\u8fc7\u5206\u8bcd\u5668\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u9884\u5904\u7406\u6570\u636e\u96c6\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5982\u4e0b\u51fd\u6570\u6765\u9884\u5904\u7406\u6570\u636e\u96c6\uff1a\n\ndef preprocess ( data ) : return tokenizer ( data [ 'text' ] , padding = True , truncation = True )\n\n\u73b0\u5728\uff0c\u6211\u4eec\u4f7f\u7528 preprocess \u51fd\u6570\u9884\u5904\u7406\u8bad\u7ec3\u548c\u6d4b\u8bd5\u6570\u636e\u96c6\uff1a\n\ntrain_set = train_set . map ( preprocess , batched = True , batch_size = len ( train_set ) ) test_set = test_set . map ( preprocess , batched = True , batch_size = len ( test_set ) )\n\n\u4e0b\u9762\uff0c\u6211\u4eec\u4f7f\u7528 set_format \u51fd\u6570\u6765\u9009\u62e9\u6211\u4eec\u5728\u6570\u636e\u96c6\u4e2d\u9700\u8981\u7684\u5217\uff1a\n\ntrain_set . set_format ( 'torch' , columns = [ 'input_ids' , 'attention_mask' , 'label' ] ) test_set . set_format ( 'torch' , columns = [ 'input_ids' , 'attention_mask' , 'label' ] )\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u7684\u6570\u636e\u96c6\u51c6\u5907\u597d\u4e86\u3002\u53ef\u4ee5\u5f00\u59cb\u8bad\u7ec3\u6a21\u578b\u4e86\u3002\n\n\u8bad\u7ec3\u6a21\u578b\n\n\u6211\u4eec\u5148\u5b9a\u4e49\u6279\u5927\u5c0f\u548cepoch\u5927\u5c0f\uff1a\n\nbatch_size = 8 epochs = 2\n\n\u5b9a\u4e49\u70ed\u8eab\u6b65\u6570\u548c\u6743\u91cd\u8870\u51cf\uff1a\n\nwarmup_steps = 500 weight_decay = 0.01\n\n\u5b9a\u4e49\u8bad\u7ec3\u53c2\u6570\uff1a\n\ntraining_args = TrainingArguments ( output_dir = './results' , num_train_epochs = epochs , per_device_train_batch_size = batch_size , per_device_eval_batch_size = batch_size , warmup_steps = warmup_steps , weight_decay = weight_decay , logging_dir = './logs' )\n\n\u7136\u540e\u5b9a\u4e49\u8bad\u7ec3\u5668\uff1a\n\ntrainer = Trainer ( model = model , args = training_args , train_dataset = train_set , eval_dataset = test_set )\n\n\u5f00\u59cb\u8bad\u7ec3\uff1a\n\ntrainer . train ( )\n\n\u5728\u8bad\u7ec3\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 evaluate \u51fd\u6570\u8bc4\u4f30\u6a21\u578b\uff1a\n\ntrainer . evaluate ( )\n\n\u8f93\u51fa\u4e3a\uff1a\n\n{'epoch': 2.0, 'eval_loss': 0.6827354431152344, 'eval_runtime': 2.131, 'eval_samples_per_second': 14.078, 'eval_steps_per_second': 1.877}\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u5fae\u8c03\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u3002\u65e2\u7136\u6211\u4eec\u5df2\u7ecf\u5b66\u4f1a\u4e86\u5982\u4f55\u4e3a\u4e00\u4e2a\u6587\u672c\u5206\u7c7b\u4efb\u52a1\u5fae\u8c03BERT\u6a21\u578b\uff0c\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\uff0c\u6211\u4eec\u770b\u770b\u5982\u4f55\u4e3a\u81ea\u7136\u8bed\u8a00\u63a8\u7406\u4efb\u52a1\u5fae\u8c03BERT\u6a21\u578b\u3002\n\n\u81ea\u7136\u8bed\u8a00\u63a8\u7406\n\n\u5728\u81ea\u7136\u8bed\u8a00\u63a8\u7406\u4e2d\uff0c\u6211\u4eec\u6a21\u578b\u7684\u76ee\u6807\u662f\u5728\u7ed9\u5b9a\u524d\u63d0(premise)\u7684\u60c5\u51b5\u4e0b\uff0c\u786e\u5b9a\u5047\u8bbe(hypothesis)\u662f\u8574\u6db5( true )\u3001\u77db\u76fe( false )\u8fd8\u662f\u4e0d\u786e\u5b9a( neutral )\u3002 \u8ba9\u6211\u4eec\u901a\u8fc7\u5fae\u8c03 BERT \u6765\u5b66\u4e60\u5982\u4f55\u89e3\u51b3\u81ea\u7136\u8bed\u8a00\u63a8\u7406\u4efb\u52a1\u3002\n\n\u8003\u8651\u4e0b\u9762\u7684\u6570\u636e\u96c6\u3002\n\n\u6211\u4eec\u6709\u4e00\u4e2a\u524d\u63d0\u548c\u4e00\u4e2a\u5e26\u6709\u6807\u7b7e\u7684\u5047\u8bbe\uff0c\u8868\u660e\u5b83\u4eec\u662f\u8574\u6db5\u3001\u77db\u76fe\u8fd8\u662f\u4e0d\u786e\u5b9a\uff1a\n\n\u73b0\u5728\uff0c\u6211\u4eec\u6a21\u578b\u7684\u76ee\u6807\u662f\u786e\u5b9a\u53e5\u5b50\u5bf9\uff08\u524d\u63d0-\u5047\u8bbe\u5bf9\uff09\u662f\u8574\u6db5\u3001\u77db\u76fe\u8fd8\u662f\u4e0d\u786e\u5b9a\u3002 \u8ba9\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\u6765\u4e86\u89e3\u5982\u4f55\u505a\u5230\u8fd9\u4e00\u70b9\u3002 \u8003\u8651\u4ee5\u4e0b\u524d\u63d0-\u5047\u8bbe\u5bf9\uff1a\n\nPremise: He is playing Hypothesis: He is sleeping\n\n\u9996\u5148\u6211\u4eec\u5bf9\u53e5\u5b50\u5206\u8bcd\uff0c\u7136\u540e\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\uff1a\n\ntokens = [ [CLS], He, is, playing, [SEP], He, is, sleeping [SEP]]\n\n\u73b0\u5728\uff0c \u6211\u4eec\u5c06\u8fd9\u4e9b\u6807\u8bb0\u5582\u7ed9\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u5e76\u5f97\u5230\u6bcf\u4e2a\u5355\u8bcd\u7684\u5d4c\u5165\u3002\n\n\u6211\u4eec\u62ff\u51fa [CLS] \u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a R [CLS] R_{\\text{[CLS]}} R[CLS]\u200b\uff0c\u5e76\u5582\u7ed9\u4e00\u4e2a\u5206\u7c7b\u5668(\u524d\u9988\u7f51\u7edc+softmax)\uff0c\u8be5\u5206\u7c7b\u5668\u4f1a\u8fd4\u56de\u53e5\u5b50\u662f\u8574\u542b\u3001\u77db\u76fe\u8fd8\u662f\u4e0d\u786e\u5b9a\u7684\u6982\u7387\uff1a\n\n\u4e3a\u95ee\u7b54\u4efb\u52a1\u5fae\u8c03BERT\n\n\u5728\u672c\u8282\u4e2d\uff0c\u6211\u4eec\u5b66\u4e60\u5982\u4f55\u7528\u4e00\u4e2a\u9884\u8bad\u7ec3\u7684\u95ee\u7b54BERT\u6a21\u578b\u6765\u505a\u95ee\u7b54\u4efb\u52a1\u3002\u9996\u5148\uff0c\u6211\u4eec\u5bfc\u5165\u5fc5\u8981\u7684\u5305\uff1a\n\nfrom transformers import BertForQuestionAnswering , BertTokenizer import torch\n\n\u73b0\u5728\uff0c\u6211\u4eec\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u6a21\u578b\u3002\u6211\u4eec\u4f7f\u7528 bert-large-uncased-whole-word-masking-finetuned-squad\u6a21\u578b\uff0c\u5b83\u662f\u5728SQUAD\u6570\u636e\u96c6\u4e0a\u5fae\u8c03\u8fc7\u7684\uff1a\n\nmodel = BertForQuestionAnswering . from_pretrained ( 'bert-large-uncased-whole-word-masking-finetuned-squad' )\n\n\u7136\u540e\uff0c\u6211\u4eec\u4e0b\u8f7d\u5e76\u52a0\u8f7d\u5206\u8bcd\u5668\uff1a\n\ntokenizer = BertTokenizer . from_pretrained ( 'bert-large-uncased-whole-word-masking-finetuned-squad' )\n\n\u9884\u5904\u7406\u8f93\u5165\n\n\u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49BERT\u7684\u8f93\u5165\uff0c\u4e3a\u95ee\u9898\u548c\u6587\u672c\u6bb5\u843d\uff1a\n\nquestion = \"What is the immune system?\" paragraph = \"The immune system is a system of many biological structures and processes within an organism that protects against disease. To function properly, an immune system must detect a wide variety of agents, known as pathogens, from viruses to parasitic worms, and distinguish them from the organism's own healthy tissue.\"\n\n\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\u5230\u95ee\u9898\u548c\u6bb5\u843d\u4e2d\uff1a\n\nquestion = '[CLS] ' + question + '[SEP]' paragraph = paragraph + '[SEP]'\n\n\u7136\u540e\uff0c\u5bf9\u95ee\u9898\u548c\u6bb5\u843d\u8fdb\u884c\u5206\u8bcd\uff1a\n\nquestion_tokens = tokenizer . tokenize ( question ) paragraph_tokens = tokenizer . tokenize ( paragraph )\n\n\u7ec4\u5408\u95ee\u9898\u548c\u6bb5\u843d\u6807\u8bb0\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a input_ids \uff1a\n\ntokens = question_tokens + paragraph_tokens input_ids = tokenizer . convert_tokens_to_ids ( tokens )\n\n\u63a5\u4e0b\u6765\uff0c\u5b9a\u4e49 segment_ids \u3002\u8fd9\u91cc\uff0c segment_ids \u4f1a\u628a\u6240\u6709\u6765\u81ea\u95ee\u9898\u7684\u6807\u8bb0\u6620\u5c04\u4e3a 0 \uff1b\u628a\u6240\u6709\u6765\u81ea\u6bb5\u843d\u7684\u6807\u8bb0\u6620\u5c04\u4e3a 1 \uff1a\n\nsegment_ids = [ 0 ] * len ( question_tokens ) segment_ids += [ 1 ] * len ( paragraph_tokens )\n\n\u7136\u540e\uff0c\u628a input_ids \u548c segment_ids \u8f6c\u6362\u4e3aTensor\uff1a\n\ninput_ids = torch . tensor ( [ input_ids ] ) segment_ids = torch . tensor ( [ segment_ids ] )\n\n\u83b7\u53d6\u7b54\u6848\n\n\u6211\u4eec\u5c06 input_ids \u548c segment_ids \u8f93\u5165\u5230\u6a21\u578b\u4e2d\uff0c\u5b83\u4f1a\u8fd4\u56de\u6240\u6709\u6807\u8bb0\u4f5c\u4e3a\u7b54\u6848\u5f00\u59cb\u4f4d\u7f6e\u548c\u7ed3\u675f\u4f4d\u7f6e\u7684\u5f97\u5206\uff1a\n\nstart_scores , end_scores = model ( input_ids , token_type_ids = segment_ids , return_dict = False )\n\n\u63a5\u7740\uff0c\u6211\u4eec\u627e\u5230 start_index \uff0c\u5c31\u662f\u6700\u9ad8\u7b54\u6848\u5f00\u59cb\u4f4d\u7f6e\u5f97\u5206\u5bf9\u5e94\u7684\u6807\u8bb0\u7d22\u5f15\uff0c\u548c end_index \uff0c\u4e3a\u6700\u9ad8\u7b54\u6848\u7ed3\u675f\u4f4d\u7f6e\u5f97\u5206\u5bf9\u5e94\u7684\u6807\u8bb0\u7d22\u5f15\uff1a\n\nstart_index = torch . argmax ( start_scores ) end_index = torch . argmax ( end_scores )\n\n\u597d\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8f93\u51fa\u5f00\u59cb\u7d22\u5f15\u548c\u7ed3\u675f\u7d22\u5f15\u4e4b\u95f4\u7684\u95ee\u9898\u7247\u6bb5\u4e86\uff1a\n\nprint ( ' ' . join ( tokens [ start_index : end_index + 1 ] ) )\n\n\u8f93\u51fa\uff1a\n\na system of many biological structures and processes within an organism that protects against disease\n\n\u547d\u540d\u5b9e\u4f53\u8bc6\u522b\n\n\u5728\u547d\u540d\u5b9e\u4f53\u8bc6\u522b(NER)\u4e2d\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u5c06\u547d\u540d\u5b9e\u4f53\u5206\u7c7b\u5230\u9884\u8bbe\u597d\u7684\u7c7b\u522b\u4e2d\u3002\u6bd4\u5982\uff0c\u8003\u8651\u53e5\u5b50\uff1a Jeremy lives in Paris ,\u5176\u4e2d\u7684 Jeremy \u5e94\u8be5\u88ab\u5206\u7c7b\u4e3a\u4eba\u540d\uff0c Paris \u5e94\u8be5\u5206\u7c7b\u4e3a\u5730\u70b9\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u5b66\u4e60\u5982\u4f55\u5fae\u8c03\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\u53bb\u505aNER\u4efb\u52a1\u3002\u9996\u5148\uff0c\u6211\u4eec\u5bf9\u53e5\u5b50\u5206\u8bcd\uff0c\u7136\u540e\u589e\u52a0 [CLS] \u548c [SEP] \u6807\u8bb0\u3002\u63a5\u7740\uff0c\u6211\u4eec\u5c06\u8fd9\u4e9b\u6807\u8bb0\u5582\u7ed9\u9884\u8bad\u7ec3\u7684BERT\u6a21\u578b\uff0c\u5f97\u5230\u6bcf\u4e2a\u6807\u8bb0\u7684\u5d4c\u5165\u8868\u793a\u3002\u7136\u540e\uff0c\u5c06\u8fd9\u4e9b\u5d4c\u5165\u8868\u793a\u90fd\u5582\u7ed9\u4e00\u4e2a\u5206\u7c7b\u5668(\u524d\u9988\u7f51\u7edc+softmax\u51fd\u6570)\u3002\u6700\u540e\uff0c\u8be5\u5206\u7c7b\u5668\u8fd4\u56de\u6bcf\u4e2a\u547d\u540d\u5b9e\u4f53\u5bf9\u5e94\u7684\u7c7b\u522b\u3002\n\n\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n\n\u53c2\u8003\n\nGetting Started with Google BERT"}, {"url": "https://prabook.com/web/bert.deacon/2466480", "page_content": "Bert Deacon\n\nAustralian-rules footballer\n\nNovember 8, 1922 (age 51)\n\nA centre half back, Deacon began his league career in 1942. Deacon left Carlton after the 1951 season and became captain-coach for Preston in the Victorian Football Association (VFA), the club where he had played for prior to being recruited by Carlton. He later served as Carlton vice-president and club secretary. He is the centre half back in Carlton\"s official \"Team of the Century\". Office the field, Deacon worked for many years for long-serving VFL and Carlton president Sir Kenneth Luke. Bertram Deacon died of a heart attack on 3 January 1974 while on holiday at Balnarring. Deacon was just 51 years of age and died despite the desperate efforts of his Preston team-mate, Pat Foley to revive him."}, {"url": "https://blog.csdn.net/miao243062960/article/details/112230552", "page_content": "\u56e0\u4e3a\u6ca1\u6709\u5faa\u73af\u795e\u7ecf\u7f51\u7edc\u505a\u8fed\u4ee3\uff0c\u6240\u4ee5\u6211\u4eec\u52a0\u4e0a\u4f4d\u7f6e\u7f16\u7801\uff0c\u4ee5\u907f\u514d\u8ba1\u7b97\u673a\u65e0\u6cd5\u533a\u5206\u201c\u6211\u662f\u4f60\u7238\u201d\u548c\u201c\u4f60\u662f\u6211\u7238\u201d\u7b49\u7b49\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7ef4\u5ea6762\u7684\u5b57\u5411\u91cf\n\n\u6211\u4eec\u9700\u8981\u4e00\u4e2a762\u7ef4\u5ea6\u7684\u4f4d\u7f6e\u7f16\u7801\n\n\u4e4b\u540e\u76f8\u52a0\u64cd\u4f5c\u5582\u5165Transformer\n\n\u4f4d\u7f6e\u5d4c\u5165\u7684\u516c\u5f0f\u5982\u4e0b\uff1a\n\n\n\n\u6211\u5bf9\u5176\u7eb9\u7406\u8fdb\u884c\u53ef\u89c6\u5316\uff1a\n\nimport numpy as np import seaborn as sns import matplotlib . pyplot as plt plt . figure ( figsize = ( 15 , 10 ) ) sns . set ( ) np . random . seed ( 0 ) max_sequence_lenth = 500 embeding_dim = 762 jishu = 10000 i_max = int ( ( embeding_dim - 1 ) / 2 ) datas = [ ] for pos in range ( max_sequence_lenth ) : posithon_embeding = [ ] for i in range ( i_max + 1 ) : posithon_embeding . append ( np . sin ( pos / ( pow ( jishu , ( 2 * i ) / embeding_dim ) ) ) ) posithon_embeding . append ( np . cos ( pos / ( pow ( jishu , ( 2 * i ) / embeding_dim ) ) ) ) datas . append ( posithon_embeding ) uniform_data = np . array ( datas ) ax = sns . heatmap ( uniform_data ) plt . show ( )\n\n\u5bf9\u4e8e0-1\u4e4b\u95f4\u7684\u7ebf\u6027\u7ef4\u5ea6\u6807\u6ce8\u6cd5\uff08\u90a3\u79cd\u6309\u7167\u4f4d\u7f6e1\uff0c2\uff0c3\uff0c4\u2026\u2026500\u2026\u2026\u8fd9\u6837\u4e0d\u57280-1\u7684\u7f16\u7801\u53ef\u4ee5\u5b8c\u5168pass\u4e86\uff09\n\n\u8fd8\u6709\u554a\u5982\u679c\u7528i/sequence_length\u7684\u4e5f\u4e0d\u884c\u3002\n\n\u5728\u77ed\u6587\u672c\u4e2d\u5b57\u4e0e\u5b57\u76f8\u5dee0.1\u53ef\u80fd\u4ee3\u8868\u76f8\u90bb\u7684\u4e24\u4e2a\u5b57\uff0c\u800c\u5728\u957f\u6587\u672c\u4e2d0.1\u53ef\u80fd\u4e2d\u95f4\u8fd8\u95f4\u9694\u4e86\u51e0\u4e2a\u5b57\u3002"}, {"url": "https://blog.csdn.net/m0_37723079/article/details/123162482", "page_content": "\u6700\u8fd1\u770b\u4e86\u4e00\u4e9b\u548cbert\u6bd4\u8f83\u50cf\u7684\u7b97\u6cd5\uff0c\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u68b3\u7406\u5427\uff0c\u672c\u6587\u5728\u5df2\u7ecf\u660e\u767dbert\u7684\u57fa\u7840\u4e0a\u4ecb\u7ecd\u6709\u4ec0\u4e48\u6539\u8fdb\u54c8\uff0c\u6ca1\u6709\u5355\u72ec\u4ecb\u7ecdbert\u54e6~\n\nTokenization\n\n\u4ecb\u7ecd\u7b97\u6cd5\u524d\u8bf4\u8bf4\u5173\u4e8etoken\u7684\uff0c\u5f88\u591a\u7b97\u6cd5\u5176\u5b9e\u4e5f\u90fd\u662f\u57fa\u4e8e\u8fd9\u65b9\u9762\u8fdb\u884c\u6539\u8fdb\u3002\u7b80\u5355\u6765\u8bf4\uff0cTokenization\u662f\u6309\u7167\u7279\u5b9a\u9700\u6c42\uff0c\u628a\u6587\u672c\u5207\u5206\u6210\u4e00\u4e2a\u5b57\u7b26\u4e32\u5e8f\u5217(\u5176\u5143\u7d20\u4e00\u822c\u79f0\u4e3atoken)\u7684\u8fc7\u7a0b\uff0c\u8fd9\u4e2atoken\u7684\u7c92\u5ea6\u662f\u4e0d\u4e00\u5b9a\u7684\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u3001\u5355\u8bcd\u751a\u81f3\u662f\u53e5\u5b50\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5728\u82f1\u6587\u4e2d\uff0c\u4f7f\u7528\u7684\u662f\u5355\u8bcd\u6216\u8005\u5b50\u8bcd\uff08\u8fd9\u91cc\u53ef\u4ee5\u5b66\u4e60\u4e0bBPE\uff09\uff0c\u4e2d\u6587\u4e2d\u4f7f\u7528\u5b57\u7b26\u3002\u4e8b\u5b9e\u4e0a\uff0c\u7c97\u7c92\u5ea6\u548c\u7ec6\u7c92\u5ea6\u5404\u6709\u4f18\u52a3\uff1a\n\n\u7ec6\u7c92\u5ea6\u7684token\u8868\u610f\u53ef\u80fd\u4e0d\u5b8c\u6574\u3001\u4f46\u662f\u8bcd\u8868\u66f4\u5c0f\uff0c\u80fd\u8868\u793a\u66f4\u591a\u7684token\uff0c\u8868\u5f81\u66f4\u5bb9\u6613\u5b66\u4e60\uff0cOOV\u95ee\u9898\u66f4\u5c11\n\n\u7c97\u7c92\u5ea6\u7684token\u8bed\u4e49\u66f4\u5b8c\u6574\uff0c\u4f46\u9700\u8981\u7684\u8bcd\u8868\u66f4\u5927\uff0c\u8868\u5f81\u96be\u4ee5\u5b66\u4e60\uff0c\u53ef\u80fd\u6709\u4e25\u91cd\u7684OOV\u95ee\u9898\uff0c\u5e76\u4e14\u4f9d\u8d56\u4e8e\u5206\u8bcd\u662f\u5426\u6b63\u786e\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u8868\u59b9\u4e0b\u5468\u516d\u5341\u516b\u5c81\u751f\u65e5\uff0c\u5206\u8bcd\u4e3a \u8868\u59b9/\u4e0b\u5468\u516d/\u5341\u516b\u5c81/\u751f\u65e5 \u548c \u8868\u59b9/\u4e0b\u5468/\u516d\u5341\u516b\u5c81/\u751f\u65e5\uff0c\u8fd9\u5dee\u5f02\u5c31\u5927\u4e86\u3002\n\n\u5728\u5e94\u7528\u4e2d\u5177\u4f53\u7528\u54ea\u4e2a\uff0c\u5efa\u8bae\u5148\u7528\u6700\u5e38\u89c4\u7684\uff0c\u6bd4\u5982\u4e2d\u6587\u7528\u5b57\uff0c\u6709\u7cbe\u529b\u518d\u5c1d\u8bd5\u8bcd\u548c\u591a\u7c92\u5ea6\u6df7\u5408\u7684\uff0c\u4e2a\u4eba\u611f\u89c9\u76f4\u63a5\u7528\u8bcd\u7684\u4f1a\u6709\u70b9\u4e0d\u597d\u628a\u63e1\u3002\n\nRoberta\n\n\u8bba\u6587\u5730\u5740\uff1ahttps://arxiv.org/pdf/1907.11692.pdf\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/brightmart/roberta_zh\u3001 https://github.com/pytorch/fairseq\n\nDynamic Masking\n\nBert\u5728\u9884\u5904\u7406\u8bad\u7ec3\u6570\u636e\u65f6\uff0c\u6bcf\u4e2a\u6837\u672c\u4f1a\u8fdb\u884c\u4e00\u6b21\u968f\u673a\u7684mask\uff0c\u540e\u7eed\u7684\u6bcf\u4e2a\u8bad\u7ec3\u6b65\u90fd\u91c7\u7528\u8fd9\u6b21mask\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6bcf\u4e2aepoch\u662f\u91cd\u590d\u7684\uff0c\u88ab\u79f0\u4e3a\u9759\u6001mask\u3002Roberta\u5728\u9884\u5904\u7406\u65f6\u6ca1\u6709\u8fdb\u884cmask\uff0c\u800c\u662f\u5728\u6bcf\u6b21\u5411\u6a21\u578b\u63d0\u4f9b\u8f93\u5165\u65f6\u8fdb\u884c\u968f\u673amask\uff0c\u8fd9\u610f\u5473\u7740mask\u662f\u53d8\u5316\u7684\u3001\u52a8\u6001\u7684\u3002\u8bba\u6587\u4e2d\u4e5f\u8fdb\u884c\u4e86\u9759\u6001mask\u548c\u52a8\u6001mask\u7684\u6548\u679c\u5bf9\u6bd4\uff0c\u6765\u8bc1\u660e\u5176\u6539\u8fdb\u6709\u6548\u3002\n\n\n\nModel Input Format and Next Sentence Prediction\n\nBert\u4e3a\u4e86\u6355\u6349\u53e5\u5b50\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4f7f\u7528\u4e86NSP\u4efb\u52a1\u8fdb\u884c\u9884\u8bad\u7ec3\u3002\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u8f93\u5165\u7684\u53e5\u5b50\u5bf9\uff08A, B\uff09\uff0c\u5224\u65ad\u8fd9\u4e24\u4e2a\u53e5\u5b50\u662f\u5426\u662f\u8fde\u7eed\u7684\u3002\u5176\u4e2d50%\u4e3a\u6b63\u4f8b\uff0c\u5373A\u3001B\u6765\u81ea\u540c\u4e00\u6587\u7ae0\uff0c50%\u4e3a\u8d1f\u4f8b\uff0cA\u3001B\u6765\u81ea\u4e0d\u540c\u6587\u7ae0\u3002\u4f46\u662f\u5728bert\u540e\uff0c\u5f88\u591a\u8bba\u6587\u8d28\u7591\u5176\u5fc5\u8981\u6027\u3002\u672c\u6587\u4e2d\uff0cRoBERTa\u53bb\u9664\u4e86NSP\u4efb\u52a1\uff0c\u6bcf\u6b21\u8f93\u5165\u8fde\u7eed\u7684\u591a\u4e2a\u53e5\u5b50\uff0c\u76f4\u5230\u6700\u5927\u957f\u5ea6512\uff0c\u901a\u8fc7\u5b9e\u9a8c\u9a8c\u8bc1\u4e86\u8fd9\u79cd\u65b9\u5f0f\u5728\u63a8\u65ad\u53e5\u5b50\u5173\u7cfb\u4efb\u52a1\u4e0a\u6548\u679c\u66f4\u597d\u3002\uff08FULL-SENTENCES\u7684\u6700\u5927\u957f\u5ea6512\u53ef\u4ee5\u8de8\u8d8a\u6587\u7ae0\uff0cDOC-SENTENCES\u5168\u90e8\u6765\u6e90\u4e8e\u540c\u4e00\u6587\u7ae0\uff0c\u4e0d\u80fd\u8de8\u8d8a\u6587\u6863\u8fb9\u754c\uff0c\u53ef\u4ee5\u4ece\u4e0b\u8868\u4e2d\u770b\u51fa\u8fd9\u79cd\u65b9\u5f0f\u6548\u679c\u6700\u597d\u3002\uff09\n\n\n\nTraining with large batches\n\n\u8fd9\u90e8\u5206\u5f52\u7eb3\u4e00\u4e0b\u5c31\u662f\uff0c\u6570\u636e\u66f4\u591a\u3001\u7b97\u529b\u66f4\u591a\u3001\u66f4\u5927batch\u3002\n\n\n\nText Encoding\n\nBert\u91c7\u7528character-level\u7684BPE\uff0c\u8bcd\u8868\u5927\u5c0f3w\u3002\u800cRobert\u91c7\u7528byte-level\u7684BPE\uff0c\u8bcd\u8868\u5927\u5c0f5w\uff0c\u7ec6\u7c92\u5ea6\u7684\u8bcd\u8868\u51cf\u5c11UNKOWN\u6807\u8bb0\uff0c\u89e3\u51b3OOV\u95ee\u9898\u3002\n\nDeberta\n\n\u8bba\u6587\u5730\u5740\uff1ahttps://arxiv.org/pdf/2006.03654.pdf\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/microsoft/DeBERTa\n\n\u5fae\u8f6f\u63d0\u51fa\u7684Deberta\u4e3b\u8981\u662f\u89e3\u51b3\u4e86\u4e24\u4e2a\u91cd\u8981\u95ee\u9898\uff1a\n\n\u4e00\u7ec4\u8bcd\u7684attention\u4e0d\u4ec5\u53d6\u51b3\u4e8e\u5185\u5bb9\u672c\u8eab\uff0c\u8fd8\u53d6\u51b3\u4e8e\u5176\u76f8\u5bf9\u4f4d\u7f6e\uff08\u611f\u89c9\u5bf9\u4e2d\u6587\u53ef\u80fd\u66f4\u6709\u6548\u679c\uff09\uff0c\u6bd4\u5982deep learning\u8fde\u5728\u4e00\u8d77\u7684\u4f9d\u8d56\u5173\u7cfb\u80af\u5b9a\u8981\u5f3a\u4e8e\u5206\u5f00\u7684\u65f6\u5019\u3002\n\n\u7531\u4e8e\u5fae\u8c03\u6ca1\u6709mask\uff0c\u5bfc\u81f4\u7684\u8bad\u7ec3\u548c\u5fae\u8c03\u65f6\u5019\u7684\u4e0d\u5339\u914d\u95ee\u9898\u3002\n\nDisentangled attention\n\nBert\u7684\u8f93\u5165\u5c42\u4e2d\u6bcf\u4e2atoken\u7684\u5411\u91cf\u662fword (content) embedding\u548c\u4f4d\u7f6eembedding\u7684\u603b\u548c\uff0c\u4f7f\u7528\u7684\u662f\u4e00\u4e2a\u5411\u91cf\u3002\u4f46\u5728Deberta\u4e2d\uff0c\u6bcf\u4e2atoken\u4f7f\u7528\u4e24\u4e2a\u5411\u91cf\u8868\u793a\uff0c\u5206\u522b\u5bf9\u5176\u5185\u5bb9\u548c\u4f4d\u7f6e\u8fdb\u884c\u7f16\u7801\uff0c\u800ctoken\u4e4b\u95f4\u7684attention\u6743\u91cd\u4e5f\u662f\u6839\u636e\u5185\u5bb9\u4e0e\u76f8\u5bf9\u4f4d\u7f6e\u4f7f\u7528\u89e3\u8026\u7684\u77e9\u9635\u8fdb\u884c\u8ba1\u7b97\u3002\n\nEnhanced mask decoder\n\nDeberta\u4f7f\u7528EMD\u4ee3\u66ff\u4e86\u539f\u672cBert\u4e2d\u7684softmax\u5c42\u9884\u6d4b\u906e\u76d6\u7684token\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u5fae\u8c03\u65f6bert\u7684\u8f93\u51fa\u540e\u4f1a\u63a5\u4e00\u4e2a\u7279\u5b9a\u4efb\u52a1\u7684Decoder\uff0c\u4f46\u662f\u8bad\u7ec3\u65f6\u906e\u76d6Decoder\u662f\u6ca1\u6709\u7684\uff0c\u6240\u4ee5\u6587\u4e2d\u5728\u9884\u8bad\u7ec3\u65f6\u7528\u4e00\u4e2a\u4e24\u5c42\u7684Transformer decoder\u548csoftmax\u4f5c\u4e3aDecoder\uff0c\u5e76\u4e14\u5728decoder\u7684softmax\u4e4b\u524d\u5c06\u5355\u8bcd\u7684\u7edd\u5bf9\u4f4d\u7f6e\u5d4c\u5165\n\n\u4e3a\u4ec0\u4e48\u8981\u52a0\u5165\u7edd\u5bf9\u4f4d\u7f6e\uff1f\u6bd4\u5982\u201c\u201ca new store opened beside the new mall\u201d\u4e2d\u7684store\u548cmall\uff0c\u4ed6\u4eec\u5c40\u90e8\u4e0a\u4e0b\u6587\u76f8\u4f3c\uff0c\uff0c\u4f46\u5728\u53e5\u5b50\u4e2d\u626e\u6f14\u7740\u4e0d\u540c\u7684\u89d2\u8272\uff0c\u8fd9\u79cd\u89d2\u8272\u7684\u4e0d\u540c\u5f88\u5927\u7a0b\u5ea6\u4e0a\u51b3\u5b9a\u4e8e\u7edd\u5bf9\u4f4d\u7f6e\u3002\n\n\u4e3a\u4ec0\u4e48\u5728\u8fd9\u91cc\u52a0\u5165\u7edd\u5bf9\u4f4d\u7f6e\uff1f\u5728bert\u4e2d\u8f83\u65e9\u7684\u5f15\u5165\u7edd\u5bf9\u4f4d\u7f6e\u53ef\u80fd\u4f1a\u4f24\u5bb3\u4e86\u6a21\u578b\uff0c\u4f7f\u5176\u4e0d\u80fd\u8db3\u591f\u7684\u5b66\u4e60\u76f8\u5bf9\u4f4d\u7f6e\u3002\n\nVirtual Adversarial Training\n\n\u63d0\u51fa\u4e86\u65b0\u7684\u865a\u62df\u5bf9\u6297\u8bad\u7ec3\u6a21\u5f0f\uff0c\u6765\u9488\u5bf9PLMs(\u9884\u8bad\u7ec3\u6a21\u578bPre-trained Language Models)\u5728NLP\u4e0b\u6e38\u4efb\u52a1\u7684fine-tune\u3002\u5728fine-tunning\u65f6\uff0c\u4f7f\u7528layer normalization\uff0c \u5148\u5c06embedding\u8fdb\u884cnormalize\uff0c \u518d\u5c06\u6270\u52a8\u5e76\u8fdbnormalize\u4e4b\u540e\u7684embedding\u3002\u8fd9\u91cc\u4ecb\u7ecd\u7684\u4e0d\u662f\u5f88\u5168\u9762\uff0c\u4ed6\u4eec\u53d1\u73b0\u8fd9\u6837\u4f1a\u5927\u5927\u63d0\u9ad8fine-tunning\u7684\u6027\u80fd\uff0c\u4e4b\u540e\u4f1a\u5168\u9762\u7814\u7a76\u3002\n\n\u6548\u679c\u5c31\u4e0d\u591a\u8d58\u8ff0\u4e86\uff0c\u6bd5\u7adf\u4e5f\u662f\u9738\u699c\u8fc7GLUE\u699c\u4e00\u7684\uff0cNLU\u4e0a\u57fa\u672cSOTA\u3002\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b\u6709\u8da3\u7684attention\u53ef\u89c6\u5316\uff1a\n\n\n\n\u53ef\u4ee5\u770b\u5230\uff0cRoBERTa\u6709\u66f4\u4e3a\u660e\u663e\u7684\u5bf9\u89d2\u7ebf\u6548\u679c\uff0c\u8bf4\u660etoken\u4f1a\u66f4\u52a0\u660e\u663e\u7684\u5173\u6ce8\u81ea\u8eab\uff0c\u7ad6\u76f4\u6761\u7eb9\u4e3b\u8981\u662f\u56e0\u4e3a\u9ad8\u9891\u8bcd\u5f15\u8d77\u7684\uff0c\u6bd4\u5982\u2018a\u2019\uff0c\u2018the\u2019\u8fd9\u79cd\u3002\u800cDeberta\u7684\u5bf9\u89d2\u7ebf\u6548\u5e94\u5e76\u4e0d\u975e\u5e38\u660e\u663e\uff0c\u5e94\u8be5\u662fEMD\u7684\u4f5c\u7528\uff0c\u7ad6\u76f4\u6761\u7eb9\u4e3b\u8981\u5728\u7b2c\u4e00\u5217\uff0c\u8bf4\u660e[CLS]\u7684\u4e3b\u5bfc\u6027\u662f\u53ef\u53d6\u7684\uff0c\u8bc1\u660e\u6211\u4eec\u540e\u7eed\u4e0b\u6e38\u4efb\u52a1\u9009\u53d6[CLS]\u4f5c\u4e3a\u7279\u5f81\u8f7d\u4f53\u4f5c\u4e3a\u8f93\u5165\u5e8f\u5217\u7684\u4e0a\u4e0b\u6587\u8868\u793a\u4e5f\u662f\u6709\u6548\u7684\u3002\n\nAlbert\n\n\u8bba\u6587\u5730\u5740\uff1ahttps://openreview.net/pdf?id=H1eA7AEtvS\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/brightmart/albert_zh \u3001https://github.com/google-research/albert\n\nalbert\u603b\u7ed3\u4e24\u70b9\uff1a\u66f4\u5c0f\uff01\u66f4\u5feb\uff01\n\nFactorized embedding parameterization\n\n\u5728bert\u3001xlnet\u3001roberta\u4e2d\uff0c\u8bcd\u8868\u7684embedding size\uff08E\uff09\u548ctransformer\u5c42\u7684\u9690\u5c42hidden size\uff08H\uff09\u57fa\u672c\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u4e3b\u8981\u6709\u4e24\u65b9\u9762\u7684\u7f3a\u9677\uff1a\n\n\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u5b58\u50a8\u4e86\u4e0a\u4e0b\u6587\u4fe1\u606f\u7684H\u5e94\u8be5\u8981\u8fdc\u5927\u4e8e\u53ea\u6709\u8bcd\u4fe1\u606f\u7684E\uff1b\n\n\u5b9e\u8df5\u4e0a\u6765\u8bf4\uff0cNLP\u4efb\u52a1\u7684\u8bcd\u8868\u4e00\u822c\u8f83\u5927\uff0c\u82e5E=H\uff0c\u90a3\u4e48\u53c2\u6570\u91cf\u5c31\u5bb9\u6613\u5927\uff0cembedding\u5728\u8bad\u7ec3\u4e2d\u66f4\u65b0\u5f97\u6bd4\u8f83\u7a00\u758f\u3002\n\n\u56e0\u6b21\uff0c\u8c37\u6b4c\u6b64\u6b21\u7684Albert\u91c7\u7528\u4e86\u8f83\u5c0f\u4e00\u4e9b\u7684E\uff0c\u6bd4\u598264\u3001128\u3001256\u7b49\uff0c\u8bad\u7ec3\u4e86\u4e00\u4e2a\u72ec\u7acb\u4e8e\u4e0a\u4e0b\u6587\u7684embedding\uff08V \u00d7 E\uff09\uff0c\u4e4b\u540e\u8ba1\u7b97\u65f6\u518d\u6295\u5f71\u5230\u9690\u5c42\u7a7a\u95f4\u4e0a\uff08\u4e58\u4e00\u4e2aE \u00d7 H\uff09\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u505a\u4e86\u4e00\u6b21\u56e0\u5f0f\u5206\u89e3\u3002\u901a\u8fc7embedding\u5206\u89e3\u6765\u8fbe\u5230\u964d\u4f4e\u53c2\u6570\u91cf\u7684\u4f5c\u7528\uff0c\u4ece\u516c\u5f0f\u4e0a\u770b\uff0cO(V \u00d7 H) -> O(V \u00d7 E + E \u00d7 H)\uff08V\u662f\u8bcd\u8868\u7ef4\u5ea6\uff0cH\u662f\u9690\u5c42\u7ef4\u5ea6\uff0cE\u662f\u8bcd\u5411\u91cf\u7ef4\u5ea6\uff09\u3002\u5728\u6587\u7ae0\u4e2d\uff0c\u5b9e\u9a8c\u663e\u793aE\u7684\u5927\u5c0f\u4e0e\u5b9e\u9645\u6548\u679c\u5e76\u4e0d\u5b8c\u5168\u6b63\u76f8\u5173\uff0c\u56e0\u6b64\u5176\u4ed6\u5b9e\u9a8c\u7684E\u90fd\u9009\u62e9\u4e86128.\n\n\u4f46\u662f\uff0c\u8fd9\u79cd\u56e0\u5f0f\u5206\u89e3\u5b9e\u9645\u4e0a\u4e0d\u662f\u964d\u4f4e\u53c2\u6570\u91cf\u7684\u4e3b\u8981\u624b\u6bb5\uff0c\u6211\u4eec\u6765\u505a\u4e00\u4e2a\u8ba1\u7b97\uff1a\u4ee5bert-base\u4e3a\u4f8b\uff0c\u9690\u5c42\u7ef4\u5ea6H\u4e3a768\uff0c\u8bcd\u8868\u5927\u5c0fV\u4e3a3w\uff0c\u6b64\u65f6\u7684\u53c2\u6570\u91cf\u4e3a768 \u00d7 3w = 2304w\uff0c\u5047\u8bbe\u6211\u4eec\u5c06embedding\u505a\u56e0\u5f0f\u5206\u89e3\uff0c\u90a3\u4e48\u6b64\u65f6\u7684\u53c2\u6570\u91cf\u4e3a3w \u00d7 128 + 128 \u00d7 768 = 393.8304w\u3002\u53c2\u6570\u91cf\u8282\u7701\u5927\u7ea6\u4e3a19M\uff0c\u800c\u539f\u672c\u7684bert-base\u53c2\u6570\u91cf\u5728110M\uff0c\u8282\u770119M\u5e76\u4e0d\u662f\u4ec0\u4e48\u9769\u547d\u6027\u53d8\u5316\u3002\n\nCross-layer parameter sharing\n\n\u5176\u5b9ebert\u548ctransformer\u7684\u53c2\u657080%\u5728Attention feed-forward block\u4e2d\u3002\u8de8\u5c42\u53c2\u6570\u5171\u4eab\u5c31\u662f\u4e0d\u8bba12\u5c42\u8fd8\u662f24\u5c42\u7684\uff0c\u90fd\u53ea\u6709\u4e00\u4e2atransformer\uff0c\u5728\u4e4b\u524d\u7684Universal Transformer\u548cDeep Equilibrium Models\u5c31\u5df2\u7ecf\u6709\u4e86\u8fd9\u79cd\u6539\u8fdb\u3002\u53c2\u6570\u5171\u4eab\u6709\u4e09\u79cd\u65b9\u5f0f\uff1a\u53ea\u5171\u4eabfeed-forward\u3001\u53ea\u5171\u4eabattention\u3001\u5171\u4eab\u5168\u90e8\u53c2\u6570\u3002Albert\u662f\u5168\u90e8\u53c2\u6570\u5171\u4eab\u7684\uff0c\u53ef\u4ee5\u8ba4\u4e3a12\u5c42\u7684transformer encoder\u7684\u6bcf\u4e2a\u53c2\u6570\u5b9e\u9645\u4e0a\u5360\u7528\u4e86\u5bf9\u5e94\u7684\u540c\u4e00\u4e2a\u53d8\u91cf\u3002\u8fd9\u5b9e\u9645\u4e0a\u662f\u964d\u4f4e\u53c2\u6570\u91cf\u7684\u4e3b\u8981\u624b\u6bb5\u3002 \u4f5c\u8005\u8fd8\u5bf9\u6bd4\u4e86\u6bcf\u5c42\u8f93\u5165\u8f93\u51fa\u7684L2\u8ddd\u79bb\u548c\u76f8\u4f3c\u5ea6\uff0c\u53d1\u73b0bert\u7ed3\u679c\u8f83\u4e3a\u9707\u8361\uff0cAlbert\u66f4\u7a33\u5b9a\uff0c\u8ba4\u4e3aAlbert\u6709\u7a33\u5b9a\u7f51\u7edc\u53c2\u6570\u7684\u4f5c\u7528\u3002\n\n\n\nInter-sentence coherence loss\n\n\u5728Robert\u4e2d\u5c31\u4ecb\u7ecd\u4e86NSP\u4efb\u52a1\u53ef\u80fd\u662f\u65e0\u7528\uff0c albert\u7684\u4f5c\u8005\u4e5f\u91cd\u65b0\u5ba1\u89c6\u4e86NSP\uff0c\u8ba4\u4e3a\u8fd9\u4e2a\u4efb\u52a1\u5b9e\u9645\u4e0a\u4e0d\u4ec5\u662f\u53e5\u5b50\u4e4b\u95f4\u5173\u7cfb\u7684\u9884\u6d4b\uff0c\u8fd8\u5305\u542b\u4e86\u4e3b\u9898\u9884\u6d4b\uff0c\u56e0\u4e3a\u8d1f\u4f8b\u6765\u81ea\u4e0d\u540c\u7684\u6587\u7ae0\uff0c\u5047\u8bbeA\u6765\u81ea\u4e8e\u8d22\u7ecf\u65b0\u95fb\uff0cB\u6765\u81ea\u4e8e\u6587\u5b66\u5c0f\u8bf4\uff0c\u90a3\u4e48\u6a21\u578b\u4f1a\u503e\u5411\u4e8e\u5f80\u4e3b\u4f53\u5173\u8054\u6027\u9884\u6d4b\u4e0a\u9760\u62e2\u3002\u56e0\u6b64\u5728Albert\u4e2d\uff0c\u4f5c\u8005\u5c06NSP\u6362\u6210\u4e86SOP\uff08 Sentence-Order Prediction\uff09\uff0c\u5176\u4e2dAB\u4e0d\u8bba\u6b63\u4f8b\u8fd8\u662f\u8d1f\u4f8b\u90fd\u6765\u81ea\u4e8e\u540c\u4e00\u7bc7\u6587\u7ae0\uff0c\u9884\u6d4b\u4e24\u53e5\u8bddA\u3001B\u662f\u5426\u4ea4\u6362\u8fc7\u987a\u5e8f\uff0c\u5b9e\u73b0\u663e\u793a\u65b0\u589e\u7684\u4efb\u52a1\u67091\u4e2a\u70b9\u7684\u63d0\u5347\u3002\n\nAmbert\n\n\u8bba\u6587\u5730\u5740\uff1ahttps://arxiv.org/pdf/2008.11869.pdf\n\n\u76ee\u524d\u672a\u5f00\u6e90~\n\n\u5b57\u8282\u7684\u8fd9\u4e2a\u6a21\u578b\u4e00\u53e5\u8bdd\u6982\u62ec\u5c31\u662f\uff1a\u7c97\u7c92\u5ea6\u548c\u7ec6\u7c92\u5ea6\u6df7\u5408\u7684bert\u3002\u5bf9\u4e8e\u4e2d\u6587\u6765\u8bf4\uff0cAmbert\u5c06\u4e00\u53e5\u8bdd\u5206\u522b\u5207\u6210\u7c97\u7c92\u5ea6\u548c\u7ec6\u7c92\u5ea6\u4e24\u79cd\u5e8f\u5217\uff0c\u5206\u522b\u8f93\u5165\u4e24\u4e2aEncoder\uff0c\u4e14\u4e24\u4e2aEncoder\u53c2\u6570\u662f\u5171\u4eab\u7684\uff0c\u76f8\u5bf9\u4e8ebert\u7406\u8bba\u4e0a\u4e0d\u4f1a\u6709\u53c2\u6570\u91cf\u7684\u5927\u5e45\u5ea6\u53d8\u5316\u3002\n\n\u548c\u5f00\u59cb\u8bf4\u7684tokenization\u7684\u7c97\u7c92\u5ea6\u7ec6\u7c92\u5ea6\u8003\u8651\u4ee5\u4e0b\uff0c\u51e1\u662f\u7528\u5230\u4e86\u7c97\u7c92\u5ea6\u7684\u90fd\u8981\u8003\u8651\u5230\u5206\u8bcd\u7684\u51c6\u786e\u6027\uff0c\u8fd9\u79cd\u65b9\u5f0f\u53ef\u80fd\u5e26\u6765\u610f\u60f3\u4e0d\u5230\u7684\u6536\u76ca\uff0c\u4f46\u662f\u4e5f\u53ef\u80fd\u6548\u679c\u5e76\u4e0d\u597d\uff0c\u8981\u8003\u8651\u5230\u7a33\u5b9a\u6027\u3002\n\nZEN\n\n\u6765\u81ea\u521b\u65b0\u5de5\u573a\u7684zen\u6a21\u578b\uff0c\u672c\u8d28\u4e0a\u662fN-gram\u589e\u5f3a\u7684\u4e2d\u6587bert\uff0c\u8bad\u7ec3\u4e2d\u8003\u8651\u5230\u4e86\u4e0d\u540c\u7684\u5b57\u7b26\u7ec4\u5408\u3002\n\n\u8bba\u6587\u5730\u5740\uff1ahttps://arxiv.org/abs/1911.00720\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/sinovation/ZEN\n\nWobert\n\n\u6765\u81ea\u8ffd\u4e00\u79d1\u6280\u7684\u4ee5\u8bcd\u4e3a\u57fa\u672c\u5355\u4f4d\u7684\u4e2d\u6587bert\u6a21\u578b\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/ZhuiyiTechnology/WoBERT\n\nNEZHA\n\n\u6765\u81ea\u534e\u4e3a\u8bfa\u4e9a\u65b9\u821f\u5b9e\u9a8c\u5ba4\u5f00\u53d1\u7684\u4e2d\u6587bert\n\n\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/huawei-noah/Pretrained-Language-Model/tree/master/NEZHA-TensorFlow"}, {"url": "https://trove.nla.gov.au/newspaper/article/206224428", "page_content": "He is highly thought\" of as a\n\nwingman. Resuming with the\n\nseconds last Saturday after a\n\npoisoned leg, Bernie Baxter\n\nkicked six goals from centre\n\nhalf-forward, and may soon\n\nmerit consideration.\n\nDyer Not Keen\n\nRICHMOND coach, Jack\n\nDyer, said last night he was\n\nnot keen to return to League\n\nfootball, but if the selectors\n\nneeded him he would play.\n\nHowever, the need appears not\n\nquite so urgent now, as injured\n\nmen are recovering.\n\nPoulter and Ednie may be\n\nthe only ones injured last week\n\nwho may be unavailable. Ed-\n\nnie's ankle is badly swollen"}], "Bert Deacon was known for his courage and tenacity.": [{"url": "https://www.carltonfc.com.au/club/history/hall-of-fame", "page_content": "The Carlton Hall of Fame was established in 1987 and recognises contributions made to the Club by individuals.\n\nInductees are to be considered from three different eras \u2013 1864 to 1938, 1939 to 1970 and 1971 to present.\n\n\n\nThe Nomination Panel considers a candidate\u2019s outstanding service and overall contribution to the Carlton Football Club.\n\nThey may also consider a candidates individual record, ability, integrity, sportsmanship, and character.\n\nThe number of games played or coached or years of administration and years of service is only a guide and not a determining factor.\n\nIn 1997, the Club also introduced 'Legend' status to coincide with the opening of the 'Legends Stand' and newly-introduced Legend status component of the Australian Football Hall of Fame. Carlton currently has 16 players who fit the criteria of 'Legend'.\n\n\n\nThe following players have been inducted into the Carlton Hall of Fame.\n\nInducted in 1987:\n\nRod McGregor - 1905-1920\n\n\n\nOne of the brightest stars of his era, Rod McGregor was a four-time Premiership player for the Navy Blues in a 236-game career that stood as a club record for more than half a century.\n\nHorrie Clover - 1920-1924 & 1926-1931\n\n\n\nHorace \u201cHorrie\u201d Clover was Carlton\u2019s star centre half-forward of the 1920\u2019s; a high flying, long-kicking champion who enjoyed a stellar career with the Old Dark Navy Blues, then went on to be one of our longest-serving administrators.\n\n\n\nHarry \"Soapy\" Vallence - 1926-1938\n\n\n\nIn a stellar 204 game VFL career between 1926 and 1938, Vallence kicked 722 goals - a club record that stood for more than fifty years.\n\nBert Deacon - 1942-1951\n\n\n\nDeacon was a star defender in two Premiership teams, a club Best and Fairest, and the first Blue to win the game\u2019s highest individual honour; the Brownlow Medal.\n\n\n\nJohn James - 1953-1963\n\n\n\nThough just 175 cm tall, John James was highly skilled, tenacious and a spectacularly strong mark. In 195 games over eleven seasons (1953 to '63) he won Carlton's Best & Fairest three times (1955, 1960 & 1961) as well as the 1961 Brownlow Medal.\n\n\n\nJohn Nicholls - 1957-1974\n\n\n\nOne of the truly great players in the history of VFL/AFL football, and the man widely regarded as the finest ruckman ever to play the game, John Nicholls led the Carlton Football Club to two Premierships as captain, and a third as captain-coach, in a celebrated playing career spanning 18 seasons.\n\nGordon Collis - 1961-1967\n\n\n\nGordon Collis was a gifted key position player whose injury-hit career at Carlton was highlighted by his magnificent Brownlow Medal winning season in 1964.\n\n\n\n\n\nAlex Jesaulenko - 1967-1979\n\n\n\nWhen it comes to sheer football ability; to that rare spark of match-winning genius that sets champions apart, the immortal \u2018Jezza\u2019 - Alex Jesaulenko \u2013 has had few peers.\n\nBruce Doull - 1968-1986\n\n\n\nOne the greatest defenders of all time, he was an outstanding competitor, a four-time Premiership player, four-time Best and Fairest winner and Carlton Games Record holder for 16 years.\n\nInducted in 1988:\n\nFred \"Pompey\" Elliott - 1900-1911\n\n\n\nThe first player to appear in 200 VFL games, Elliott was a well-proportioned athlete with good endurance and impressive spring.\n\n\n\nKen Hands - 1945-1957\n\n\n\nAnother of the pivotal figures in the proud history of the Carlton Football Club, Ken Hands left an indelible mark on, and off the field at Princes Park. A two-time Premiership player, state representative, Best & Fairest winner and inspirational captain, Hands played 211 games and kicked 188 goals in twelve seasons beginning in the last months of World War II.\n\nPeter Jones - 1966-1979\n\n\n\nPeter 'Percy' Jones is one of the truly unique characters in the long history of the Carlton Football Club. His unbounded enthusiasm on the field - and his legendary exploits off it - endeared the lanky Tasmanian to generations of Blues' fans.\n\nInducted in 1989:\n\nNorman \"Hackenschmidt\" Clark - 1905-1912\n\n\n\nNorman Childers \u2018Hackenschmidt\u2019 Clark was one of the prominent figures of the Carlton Football Club in the early part of the 20th century. A champion player whose falling-out with coach Jack Worrall in 1910 had ramifications for both men, he played a vital role in each of the Blues\u2019 first five Premierships.\n\n\n\nBruce Comben - 1950-1961\n\n\n\nBruce \u201cBugsy\u201d Comben was a hugely popular and loyal servant of the Carlton Football Club for more than fifty years. After earning a wide appreciation for his courage, honesty, and reliability on the field in his 188 games between 1950 and 1961, he went on to further serve the Blues in many other administrative roles, as diverse as a committeeman, selector, player\u2019s representative, recruiting officer and team manager.\n\n\n\nSergio Silvagni - 1958-1971\n\n\n\nAfter 239 games and 136 goals, two Premierships, one year as captain, two Best & Fairest awards and two Big V appearances, he went on to further serve the Blues as a committeeman, selector, and even a caretaker coach.\n\nInducted in 1990:\n\nGeorge Coulthard - 1876-1882\n\n\n\nPerhaps the first superstar of Australian Football (or Victorian Rules as it was then known), George Coulthard joined the fledgling Carlton Football Club as a 19-year-old in 1876. A local farmer, Coulthard had already established himself as a brilliant cricketer. But when he donned the blue cap of Carlton and ran out to join in the game that had gripped the colony like no other, Coulthard was a sensation.\n\n\n\nCreswell \"Mick\" Crisp - 1931-1941\n\n\n\nAt first, a dangerous flanker who combined brilliantly with Carlton\u2019s champion full-forward Harry 'Soapy' Vallence, he later moved into the centre, where his tenacity and outstanding foot skills helped drive the Blues to the 1938 Premiership.\n\n\n\nRobert Walls - 1967-1978\n\n\n\nHe was just sixteen years old when he played his first game for Carlton, and goaled with his first kick. Eleven seasons later, Robert Walls moved on from Princes Park as one of the greats of a fabulous era. A three-time Premiership player in 218 games, he notched 367 career goals, was vice-captain for five seasons, and captain for two.\n\nInducted in 1991:\n\nCharlie Hammond - 1905-1909 & 1914-1918\n\n\n\nA revered son of the Old Dark Navy Blue, Charles \u2019Charlie\u2019 Hammond was a five-time Premiership player for Carlton in the first decades of the 20th century. A tough, hard-hitting follower or defender, he walked out of Princes Park in acrimonious circumstances in 1910, but was convinced to return after a four-year absence.\n\n\n\nBob Chitty - 1937-1946\n\n\n\nDuring his successful and controversial career, Bob Chitty was widely regarded as one of the hardest, most single-minded players of all time. Hated by opposition supporters and revered by his own, he was utterly ruthless in his pursuit of victory, and heaven help any opposition in his way.\n\n\n\nJack Howell - 1942-1944, 1946-1950, 1952-1954\n\n\n\nCarlton\u2019s Jack \u2018Chooka\u2019 Howell holds a special place in the history of both the Carlton Football Club and VFL/AFL football. His father was a Premiership player with South Melbourne in 1918, and Chooka himself won a flag with Carlton in 1947. When Chooka's son Scott Howell played in the Blues\u2019 1981 Premiership team, the Howells became the only family to have produced VFL Premiership footballers in three successive generations.\n\n\n\nWayne Johnston - 1979-1990\n\n\n\nA brilliant, hard-running, aggressive mid-fielder in four Carlton Premiership teams, Wayne Johnston was a player ahead of his time. Years before athletic endurance and absolute intensity became prime requirements of a league footballer, Johnston; \u2018The Dominator\u2019 carved his name with capitals into the history of the Carlton Football Club.\n\n\n\nInducted in 1992:\n\nJim Clark - 1943-1951\n\n\n\nInvariably described as loyal, brave and determined, James Robinson (Jim) Clark was a star for the Blues through the uncertain years of World War II, and the youngest member of Carlton\u2019s 1945 Premiership team.\n\n\n\nErn Henfry - 1944, 1947-1952\n\n\n\nAt 182 cms and 82 kg he was big for a centreman, but his wonderful foot skills, his pace and his evasiveness made him a matchwinner. A Premiership Captain in 1947, Henfry won the Club Best & Fairest twice in his 84-game career with the Blues.\n\n\n\n\n\nAdrian Gallagher - 1964-1972\n\n\n\nOver eight seasons, Gallagher was an integral part of the greatest first ruck of all. He developed an instinctive, almost telepathic combination with champion ruckman John Nicholls and ruck-rover Serge Silvagni in an era when this trio were the platform for two Carlton Premierships.\n\n\n\n\n\nMike Fitzpatrick - 1975-1983\n\n\n\nAt 191 cm and 91 kg he gave away height and weight to many opponents, but he was clever, athletic and an outstanding mark. Adept at assessing his opponents' strengths and weaknesses, he was a fierce competitor who hated being beaten. Three-time Premiership player, including two as Captain.\n\nInducted in 1993:\n\nFrank Gill - 1929-1942\n\n\n\nRegarded as one of the very best in an era of star full-backs, Frank Gill was a Carlton stalwart for 14 seasons. Recruited from Nhill in north-western Victoria, he began his league career with the Blues in 1929 and went on to play 205 games.\n\nRodney Ashman - 1973-1986\n\n\n\nRod Ashman was one of Carlton's greatest rovers. A brave and skillful player who was part of two Premiership teams, he continued to serve the Blues for many years after his wonderful playing career ended.\n\nStephen Kernahan - 1986-1997\n\n\n\nThe numbers are impressive enough; 251 games, 738 goals, All-Australian, twice captain of Carlton Premiership teams, three times club Best & Fairest, captain (and leading goal-kicker) for eleven seasons in a row - yet this fabulous record only goes part of the way toward explaining why Stephen 'Sticks' Kernahan is revered as one of this proud club's greatest players and most inspirational leaders.\n\nInducted in 1994:\n\nCharlie Davey - 1927-1937\n\n\n\nA passionate Blues supporter from birth, Charlie Davey represented the Navy Blues in 143 games, kicking 121 goals and Captaining the Club in 1935.\n\n\n\nOllie Grieve - 1942, 1944, 1946-1952\n\n\n\nFor seven seasons immediately after World War II, Carlton\u2019s champion custodian of the goal square was Oliver Kelvin \u2018Ollie\u2019 Grieve \u2013 a brilliant, close-checking defender who was a glorious high mark and a powerful, driving drop-kick.\n\n\n\nTrevor Keogh - 1970-1981\n\n\n\nA clever player, Keogh was not a penetrating kick but rarely wasted a possession able to pinpoint players and put the team to better advantage with smart disposal. A Premiership player in 1972 & 1979 and a dual Best & Fairest winner.\n\nGeoff Southby - 1971-1984\n\n\n\nSouthby arrived at Carlton in late 1970 as a 20 year-old and was a revelation from his first practice game. At 188cm and 87kg he was the perfect build for a key defender of that era. Twice Best & Fairest, two-time Premiership player and regular State representative, in 268 games he kicked 31 goals in his rare forays forward.\n\nInducted in 1995:\n\nMark Maclure - 1974-1986\n\n\n\nIn a long and successful career with the Blues between 1974 and 1986, \u201cSellers\u201d Maclure wore his number 36 guernsey in 243 games, including solid contributions in each of the 1979, 1981, and 1982 Carlton Premierships.\n\nCraig Bradley - 1986-2002\n\n\n\nA consummate professional whose outstanding ball-winning ability, accurate disposal, punishing non-stop running and longevity in the game made him one of the all-time greats. \u201cBraddles\u201d captained the Blues for three years, won two AFL Premierships, and picked up almost every possible honour in a stellar career that spanned 17 seasons and a record 375 games for the Carlton Football Club.\n\nJustin Madden - 1983-1997\n\n\n\nMadden was one of Carlton\u2019s great ruckmen; a 206-centimetre beanpole with outstanding tap skills, strong hands, and reliable left foot when shooting for goal. In a marathon 18-year AFL career that began at Essendon and flourished at Carlton, Harry played 332 senior games and kicked 190 goals between 1980 and 1996.\n\nInducted in 1996:\n\nJim Francis - 1934-1943\n\n\n\nFrancis was barely tall enough for a key position at 183 cm and 80 kg, but he was athletic, extraordinarily versatile, and a booming right foot kick. Captained the Blues in 1936 and again between 1941-43, he was a Premiership player in 1938 and was Best & Fairest twice.\n\n\n\nBarry Armstrong - 1969-1981\n\n\n\nBarry Armstrong was a fiercely competitive and capable footballer who played more than 200 games for the Blues in a long career and was a valued member of two Premiership teams.\n\nDavid McKay - 1969-1981\n\n\n\nFondly remembered as one of the most consistent and spectacular high marks of his era, David \u201cSwan\u201d McKay was a Carlton star for twelve years, and a key member of four Premiership teams.\n\nStephen Silvagni - 1985-2001\n\n\n\nThe AFL's Full Back of the Century, Silvagni played 312 games in a glorious 17-season career which saw him feature in two Premiership teams, claim the Best & Fairest award twice and named All-Australian seven times.\n\nInducted in 1997:\n\nRod Austin - 1972-1985\n\n\n\nOne of the most popular players of his era, he won Premiership glory with the Blues in 1979 and was cruelly denied a place in both the 1981 and '82 flag sides by injury.\n\nKen Baxter - 1938-1941 & 1945-1950\n\n\n\nIn ten seasons at Princes Park, Baxter was a Premiership player three times, and club leading goal-kicker on six occasions. Although he often spent time in defence or in the ruck \u2013 particularly early in his career - he kicked seven or more goals in a match nine times.\n\nInducted in 1998:\n\nWes Lofts - 1960-1970\n\n\n\nA pivotal figure at the Carlton Football Club for forty years, Wesley Victor Lofts was a tough, uncompromising Premiership full-back, and later, one of the Blues\u2019 most powerful and influential administrators.\n\n\n\n\n\nKen Hunter - 1981-1989\n\n\n\nTo a whole generation of Carlton supporters, Kenny quickly became a synonym for courage. With his spindly frame, his socks down around his ankles and his trademark mop of unruly hair, Hunter ran into, and flew over packs from all angles to take spectacular marks week after week. Absolutely fearless in his pursuit of the football, he never shirked the fiercest of physical clashes.\n\n\n\n\n\nPeter Dean - 1984-1998\n\n\n\nThroughout his 248 games with the Navy Blues \u2013 including the '87 and '95 Premierships \u2013 \u2018Deanie\u2019 (later also dubbed \u2018Helmet\u2019 for his mullet haircut, or \u2018The General\u2019 for his on-field leadership) was one of the most popular Carlton players of his era.\n\nInducted in 1999:\n\nLaurie Kerr - 1950-1959\n\n\n\nIf three words were needed to sum up Laurie Kerr as a footballer, then they would surely be speed, aggression and courage. A blisteringly-quick winger, centreman or half-forward flanker, Kerr was a star player in a bleak period for the Blues from 1950 to \u201959, and later, an influential figure in the Carlton Football Club for more than thirty years.\n\n\n\n\n\nKevin Hall - 1963-1973\n\n\n\nKevin \"Racehorse\" Hall was a solid, reliable, often inspirational member of three Premiership teams for the Blues, and later, a valuable and long-serving committee and board member.\n\n\n\n\n\nTom Alvin - 1984-1994\n\n\n\nEasily distinguished on the field by his long, shoulder-length hair, Alvin played 218 games and kicked 95 goals. A member of the 1987 Premiership side, he represented Victoria on six occasions.\n\nBrett Ratten - 1990-2003\n\n\n\nBrett Ratten\u2019s career at the Carlton Football Club is a story of talent, determination, courage, and loyalty. Destined to be a champion of the club and of the game, he joined Carlton\u2019s Under-19 squad as a 16-year-old schoolboy in 1988 and retired after 255 games for the Navy Blues, including the 1995 Premiership.\n\nGreg Williams - 1992-1997\n\n\n\nOne of the most brilliant and controversial players of all time, Greg \"Diesel\" Williams was twice rejected by Carlton as a youngster because he lacked natural leg speed. Nevertheless, he went on to carve his name into AFL history as a champion centreman at Geelong and Sydney, before returning to Princes Park and Premiership glory with the Blues. For sheer ball-getting ability, tenacity, and pin-point disposal by hand or by foot, Diesel Williams had few peers.\n\nInducted in 2000:\n\nGarry Crane - 1964-1976\n\n\n\nRenowned for his boundless courage, perseverance, and sheer ball-getting ability, Garry Crane was an outstanding big-occasion player for the Navy Blues in a celebrated 13-year career between 1964 and 1976.\n\n\n\nJim Buckley - 1976-1990\n\n\n\nJimmy Buckley played his first senior game in guernsey number 16 at the tender age of 16 years, 6 months and 18 days, making him the equal-youngest Blue of all. In a career stretching 15 seasons, Buckley would play in three Premiership teams and won the Best & Fairest award in 1982.\n\n\n\nWayne Harmes - 1977-1988\n\n\n\nA true utility, he was perhaps at his best in a back pocket, yet never failed to produce wherever he was asked to play. Just 177 cm tall, his barrel chest and solid legs meant he tipped the scales at 85 kg. He was surprisingly quick for his build, a safe mark, and a dangerous near goal, and he loved bursting through packs to set up play at both ends of the ground.\n\n\n\nMichael Sexton - 1990-2000\n\n\n\nOne of Carlton\u2019s brightest stars in the last decade of the 20th century was Michael Sexton; a skilled, resolute defender who was born in New Guinea and grew up in Bendigo.\n\nInducted in 2001:\n\nIan Collins - 1961-1969 & 1971\n\n\n\nA courageous, uncompromising back pocket in the Blues' 1968 Premiership team, Ian Collins went on to serve as Secretary-Manager and President through some of Carlton Football Club's most successful, and later, most turbulent times.\n\n\n\nDavid Glascott - 1981-1991\n\n\n\nWith his slender build, his longish blonde hair and his baby face, he seemed anything but a star VFL footballer. But looks are often deceiving, and in Glascott\u2019s case, the fresh face and spindly legs belonged to a determined and skillful midfielder who was a valuable member of three Carlton Premiership teams.\n\n\n\nAndrew McKay - 1993-2003\n\n\n\nA warrior at half-back for the Blues for 11 seasons, he was resolute, reliable and most of the time, utterly impassable. His career began with a Grand Final defeat in his debut year, then soared to redemption only two seasons later. From then on, through the near-misses of 1999 and 2000, and into the looming catastrophe of the first decade of this troubled century, Andrew Ian McKay stood \u2013 and still stands \u2013 as an all-time great of the Carlton Football Club.\n\nInducted in 2006:\n\nJack Worrall - 1902-1909\n\n\n\nThe first-ever coach of a VFL club. He was a brilliant leader, coaching the Old Dark Navy Blues in 144 games for 100 wins, 1 draw and 43 losses, including the 1906, 1907 and 1908 Premierships.\n\n\n\nGeorge Bruce - 1903-1913\n\n\n\nA pacey winger with flair and impeccable ground skills, he was almost unstoppable throughout Carlton\u2019s historic hat-trick of Premierships in 1906 to 1908, and was regarded as one of the game\u2019s first great big-occasion players.\n\n\n\nPaddy O'Brien - 1913-1925\n\n\n\nPatrick Joseph \u201cPaddy\u201d O\u2019Brien was almost the perfect footballer for his era. Highly skilled, athletic and as tough as teak, he played 167 games and kicked 7 goals for Carlton in a celebrated career that stretched over 13 seasons between 1913 and 1925. Two of those matches were Grand Final victories; in 1914 over South Melbourne and in 1915 over Collingwood.\n\n\n\nJim Baird - 1941-1943 & 1945-1951\n\n\n\nJim Baird was a two-time VFL Premiership player for the Carlton Football Club, and one of the great all-round sportsmen of the post-World War II era.\n\n\n\nBryan Quirk - 1965-1975\n\n\n\nOne of Carlton's greats, Bryan Quirk was the football equivalent of a champion greyhound. A tall, beautifully balanced, long-kicking winger or half-forward, he arrived at Carlton at the dawn of the Barassi era, and carved out a celebrated, if unlucky career.\n\n\n\nSyd Jackson - 1969-1976\n\n\n\nA gifted, courageous aboriginal footballer who was a star in two Carlton Premiership teams. In 2005 he was named in the AFL Players Association Indigenous Team of the Century, and in 2006 he became the Carlton Heroes\u2019 inaugural inductee into the Carlton Hall of Fame - an honour that everyone who saw him play would agree, was richly deserved.\n\n\n\nPeter McConville - 1978-1985\n\n\n\nWidely regarded for his consistency and his versatility, the powerful barrel-chested utility was a key factor in Carlton's golden run of three Premierships in four years from 1979 to 1982.\n\n\n\nAlex Marcou - 1979-1986\n\n\n\nAlex Marcou was a member of Carlton\u2019s fabled mosquito fleet of brilliant small men of the 1970\u2019s and \u201880\u2019s, and a three-time Premiership rover for the Blues.\n\n\n\nFraser Brown - 1989-2000\n\n\n\nThe shaggy-haired Brown, who wore #20 in 177 games for the Blues, was a tough and fair midfielder with the occasional stint forward. He was a solid 'inside' midfielder with creative disposal, but lacked a yard in pace. And when we say 'solid' we mean 'brick solid' given his 90 kilo, 181 cm frame. He formed an amazing engine room with other Legends Greg Williams and Brett Ratten, providing considerable ball winning ability to the Carlton teams of the 1990's.\n\n\n\nKen Sheldon - 1977-1986\n\n\n\n\u201cBomba\u201d Sheldon was an important member of Carlton\u2019s famed mosquito fleet of the nineteen-seventies and eighties. Just 178 cm and 76 kg, he was a nippy, courageous rover who became a versatile utility as his career progressed.\n\nInducted in 2011:\n\nRon Barassi - 1965-1971\n\n\n\nIn a VFL career in which he played 254 games and kicked 329 goals, he wore our Navy Blue guernsey in 50 games, kicked 35 goals, and coached six seasons for two memorable Premierships. More importantly, he had swept away the complacent attitudes that existed before his arrival, and built the platform for Carlton's dominance in the next decade.\n\n\n\nVin Gardiner - 1907-1917\n\n\n\nMore than 90 years after he played his last match for the Blues, Gardiner still ranks tenth overall in our club\u2019s list of all-time career goals. Described as the \u2018biggest kick, inch for inch\u2019 of his era, Gardiner led Carlton\u2019s goal-kicking in seven of his eleven seasons, and was also the VFL\u2019s leading scorer in 1911.\n\n\n\nJohn Goold - 1963-1970\n\n\n\nA brilliant, flamboyant, two-time Premiership player for Carlton during the Barassi years in the \u2018swingin\u2019 sixties,\u2019 John William Crosbie Goold became almost as famous for his dapper appearance off the field, as for his exploits on it.\n\n\n\nAnthony Koutoufides - 1992-2007\n\n\n\nThroughout the history of VFL/AFL football, few individual players have actually changed the game. However, such was the impact of Anthony Koutoufides - \u201cKouta\u201d to the masses of Blues supporters he thrilled during his celebrated 15-season career at Princes Park between 1992 and 2007 \u2013 that today he is recognised as the prototype of the 21st-century footballer.\n\nDavid Parkin - 1981-1985 & 1991-2000\n\n\n\nAmong the most respected figures in the long history of the Carlton Football Club, David Parkin was already a household name at Hawthorn when he arrived at Princes Park in 1981 to coach the Blues to three Premierships in fifteen interrupted seasons.\n\nInducted in 2013:\n\nDavid Rhys-Jones - 1985-1992\n\n\n\nRhys-Jones' rare football talents were sometimes lost in his all-too-frequent Tribunal visits. Not so at Carlton, the club to which the 1987 premiership player and Norm Smith Medallist committed in 108 matches (after 76 with the Swans).\n\nInducted in 2016:\n\nScott Camporeale - 1995-2005\n\nA member of Carlton's 1995 premiership team in his debut season, the man endearingly known as 'Campo' went on to play 233 games in the navy blue, earning All-Australian selection and a club best-and-fairest award in 2000.\n\nMil Hanna - 1986-1997\n\nBorn in Lebanon, Hanna quickly became a cult figure among the Carlton faithful in a celebrated 11-season career which included the famous 1995 premiership. The curtain came down on Mil\u2019s 190-game Carlton career in 1997, but the boy from East Brunswick still maintains his love for the club with which he shares a deep-rooted territorial link.\n\nIan Robertson - 1966-1974\n\nRenowned for his running capacity and prodigious, penetrating kicking, Robertson was a fixture in a famed centreline comprising Bryan Quirk and Garry Crane through what was arguably Carlton\u2019s greatest era. The grand final triumphs of 1968, \u201970 and \u201972 would crown a 125-game Carlton career for Robertson, whose later football life involved gamecalling for the Seven Network.\n\nJack Wrout (dec.) - 1936-1944\n\nThe late Wrout first embarked on a senior League career at North Melbourne in 1931, but after 53 games in six seasons with the Shinboners, became increasingly frustrated with a lack of opportunity. In 1936, Wrout crossed to Carlton and emerged as a star forward in the Blues\u2019 1938 grand final team, which broke the Club\u2019s record 22-year premiership drought. Five years later, he took the honors as his club\u2019s leading goalkicker.\n\nInducted in 2018:\n\nBrent Crosswell - 1968-1975\n\nRecruited to the club from the Tasmanian convict locale of Campbell Town, Brent Crosswell is remembered as a prodigious if enigmatic football talent \u2013 a genuine star in the star-studded Barassi-coached Carlton teams of the late 1960s/early \u201970s.\n\nThough his career would fall two games adrift of 100 in dark Navy, \u2018Tiger\u2019 impacted tremendously on football\u2019s grandest stage, as a member of the Blues\u2019 drought-breaking Grand Final victory of 1968 and perhaps their most famous of all Grand Final triumphs in 1970.\n\nLance Whitnall - 1997-2007\n\nThe son of Carlton\u2019s 66-game player Graeme, Lance Whitnall was considered the heir apparent to Stephen Kernahan as the club\u2019s pre-eminent tall forward \u2013 a lofty task to be sure, but one to which Whitnall committed with purpose from the outset.\n\nIn 216 games through 11 seasons from 1997, Whitnall - or \u2018Big Red\u2019 as he was endearingly dubbed \u2013 capably served in Carlton\u2019s front half, until a persistent knee problem at just 28 brought premature end to his on-field tenure.\n\nInducted in 2023:\n\nPercy Bentley - 1941-1955\n\nSince the formation of the VFL in 1897, only David Parkin has coached the Carlton Football Club more times than Percy Bentley - and few have served the Blues longer and with greater distinction than the former Richmond champion.\n\nBentley commandeered Carlton to the famous Premierships of 1945 and 1947 Premierships, then dedicated most of the remaining years of his life to the football club as Vice-President.\n\nFor Bentley, Carlton was everything.\n\nAdrian Gleeson - 1986-1996\n\nHailing from the rolling green fields of Koroit in Victoria's western districts, Gleeson fast earned a reputation as one of Carlton's truly durable small men, and a more than handy successor to the retiring Rod Ashman.\n\nIn tandem with the Blues' runners - the likes of Craig Bradley, Mark Naley and Fraser Murphy, Gleeson savoured Premiership success in 1987 and would capably serve his club through 176 games as a player before committing his time and substantial energies at board level.\n\nChris Judd - 2008-2015\n\nChris Judd joined Carlton from West Coast in a hail of publicity - and from the outset validated the club's greatest recruiting coup since Ron Barassi.\n\nNamed captain in his maiden season with the Blues, Judd reinforced his status as one of League football's truly great players of the early 20th century - landing the John Nicholls Medal for Carlton's Best & Fairest on three occasions, as well as the Brownlow Medal for the competition's preeminent player, through 145 quality games - before giving back at board level as a Carlton director.\n\nCarlton Football Club Hall of Fame Legends:\n\nIn 1997, to coincide with the opening of the Legends Stand at Princes Park and the newly-introduced Legend component of the Australian Football Hall of Fame, Carlton elevated nine of its own Hall of Fame Inductees to Legend status for the first time.\n\nAccordingly, Craig Bradley, Bert Deacon, Bruce Doull, Alex Jesaulenko, Wayne Johnston, Stephen Kernahan, John Nicholls, Stephen Silvagni and Harry Vallence were elevated following a vote of Club supporters.\n\nToday, a total of 14 Carlton Inductees are recognized as Legends, with Ken Hands having been elevated in 2006, Robert Walls in 2011, Geoff Southby in 2013, Sergio Silvagni in 2016 and David McKay in 2021.\n\nElevated in 1997:\n\nCraig Bradley\n\nBert Deacon\n\nAlex Jesaulenko\n\nBruce Doull\n\nWayne Johnston\n\nStephen Kernahan\n\nJohn Nicholls\n\nStephen Silvagni\n\nHarry Vallence\n\nElevated in 2006:\n\nKen Hands\n\nElevated in 2011:\n\nRobert Walls\n\nElevated in 2013:\n\nGeoff Southby\n\nElevated in 2016:\n\nSergio Silvagni\n\nElevated in 2021:\n\nDavid McKay\n\nElevated in 2023:\n\nHorrie Clover\n\nIan Collins"}, {"url": "https://blueseum.org/Bert+Deacon", "page_content": "Milestones\n\nVideo\n\nBert Deacon holds a special place among the legends of the Carlton Football Club. Although his outstanding on-field career was restricted to only 106 games by war service and a chronic thigh injury, he was a star defender in two Premiership teams, a club Best and Fairest, and the first Blue to win the game\u2019s highest individual honour; the Brownlow Medal.Later, he served as a committeeman, and a hard-working and effective club secretary, before his deeply-mourned passing at the age of just 51. But what made Bertrand John Deacon unique was not just his exploits on the field for his beloved Blues. He was a man of the highest principles; a true gentleman whose moral courage and sense of fair play set him apart.Bert was born into a footballing family at Northcote in 1922 . His father, Jack Deacon, was a prominent player for Preston in the 1920's who spent many years on the committee of the club when his playing days ended. After showing promise at schoolboy and junior level, Bert followed his father into the red and white colours of Preston\u2019s senior side in 1941 , while the devastation of World War II spread across the world. On May 11, 1940, the V.F.A. Recorder noted \"\"Bert Deacon, a l7-year-old lad, will be tried in the centre for Preston today. He has been doing well with the seconds.Deacon was in and out of the side that year and was omitted for Preston's one finals appearance, but played every game in 1941. By the start of the following season, the V.F.A. were in recess and players were free to cross to League clubs without a clearance.In a VFA competition deprived of quality and quantity by the eagerness of Australia\u2019s young men to fight for their country, 19 year-old Deacon played in all of Preston\u2019s home and away matches in that bleak year, only to be left out of the side for the finals. Port Melbourne won the flag, and soon afterwards the VFA announced that it was suspending its competition for the duration of the war.Bert himself enlisted soon after that, but while waiting for his call-up, went looking for a game somewhere else. When he called at Princes Park, recently-appointed Carlton coach Percy Bentley welcomed him in, and the pair began a partnership that would endure throughout Deacon\u2019s entire VFL career.Bert first took the field for Carlton against Footscray at the Yarraville Oval on Saturday, June 20, 1942 . The Western Oval had been appropriated by the government for use as a military transit centre, so the Bulldogs were bunking-in with their VFA neighbours. Bentley named Deacon in the centre, where he played alongside two men with whom he would later share Premiership glory; Vin Brown and Fred Fitzgibbon . On that day however, Footscray adapted to the conditions better than the Blues, and ran out winners by 19 points.Deacon managed just three games in 1942 , two in 1943 and three in 1944 , as his training and postings to Australia\u2019s far north kept him a long way from home. But by early 1945 , with the Axis forces in Europe all but beaten and the Japanese in full retreat in the Pacific, Lance Corporal Bert Deacon was transferred back to Melbourne, where he wasted no time in resuming his football career. In 1945, Deacon was captain-coach of an Army Stores team in Darwin that included several League and Association players, including Footscray legend, Charlie Sutton.He returned to Carlton\u2019s team in July, 1945 , for the match against Essendon at Princes Park. The Blues lost a cliff-hanger by three points, but by siren time that afternoon, coach Bentley knew that he had a potential champion in his team with Deacon at centre half-back. Although he was just 180 cm and 79 kg, Bert settled into defence like he was born to it. He was a strong and clever mark, beautifully balanced, with an uncanny ability to read the flight of the ball. And once he got it, he invariably disposed of it well with a neat drop kick to position.Carlton\u2019s feat of battling through to a finals berth in 1945 , and then going on to beat South Melbourne in the most infamous and controversial Grand Final of all time, has been well documented. What isn\u2019t so well-known is that the Carlton-Collingwood Preliminary Final that preceded it was every bit as violent, and surely was a catalyst for later events.After losing the second Semi Final to minor Premiers South Melbourne, Collingwood went into the Preliminary Final with the intention of knocking some of Carlton\u2019s playmakers off their game. Included among their targets were key defenders Deacon and full-back Vin Brown . The game was an ugly series of melees from early on, as Collingwood went head hunting, and Carlton fought fire with fire. Yet through it all, as fists, elbows and even boots flew around him, it was Deacon who held the line across half-back. Despite being niggled, punched and thrown to the ground late on many occasions, he never once retaliated, nor complained to the umpire. Cool and collected, he just simply kept getting the ball, and sending it into attack.Even so, Collingwood held sway on the scoreboard for three quarters, and seemed to have sealed the match early in the last term, when they kicked their twelfth goal and stretched their lead to 45 points. But when Vin Brown was king-hit by Collingwood\u2019s Len Hustler, and the Blues would take no more. Galvanised by that incident, they came storming back into the match to pile on seven goals in the last 18 minutes, and beat the demoralised Magpies by ten points.The following week, when South Melbourne and Carlton met to decide the 1945 VFL Premiership , the teams ran out onto a Princes Park packed to the rafters with almost 63,000 spectators. The occasion, and simmering tensions on both sides - heightened by the violence of the previous Saturday, produced a powder keg of emotion that inevitably exploded into another vicious clash forever remembered as the \u2018Bloodbath\u2019 Grand Final.Once more, Bert Deacon was one of the few players from either side who was more interested in finding the football than punching on. In the second quarter, as the game degenerated into a series of running brawls, South\u2019s promising youngster Ron Clegg (like Deacon, a future Brownlow Medallist) was about to join in the fighting when Deacon took hold of his shoulder and quietly said; \u2018Don\u2019t go down there, son, there\u2019s nothing for you in that.\u2019 Clegg heeded Deacon\u2019s advice, only to be felled himself later in the match, by Carlton\u2019s fearsome captain, Bob Chitty As a groggy Clegg got to his feet to take his free kick, Deacon realised that Clegg was facing the wrong way, and turned him in the right direction \u2013 an action that infuriated Chitty, who snarled; \u2018I don\u2019t knock them down for you to pick up.\u2019 Carlton eventually won the battle by 28 points. Ten players were reported and suspended, yet one of the enduring stories of that bitter-sweet triumph for Carlton was the unflagging sportsmanship of Bert Deacon.Two years later, Deacon\u2019s career peaked when he won his second VFL Premiership medallion, topped off by the 1947 Brownlow Medal, and a tie for first place in Carlton\u2019s Best and Fairest award. The year began with the arrival of brilliant West Australian Ern Henfry , who had stood out of football for a year to win a clearance to Carlton, and was appointed captain of the Blues after just two senior games.A gifted centreman and an inspirational leader, Henfry led a solid Carlton combination to the minor Premiership, on the way, striking up a strong rapport with his vice-captain Deacon. By then, Bert was considered as the outstanding centre half-back of the competition. In the week prior to the first round of the finals, he confirmed his standing in the game by becoming the first Carlton player to win the Brownlow Medal, when he polled 23 votes to beat St Kilda\u2019s Harry Bray by two.It would have been understandable had Deacon been distracted by the celebrations, but as always, he quickly refocused on the job at hand. Carlton met Essendon in the \u201947 Grand Final in front of 85,000 at the MCG, and seemed headed for defeat when they trailed by five points as the time-keeper\u2019s clock clicked into the last minute of time-on. That\u2019s when nuggety rover Fred Stafford (who had been rarely sighted all day) swooped on a spillage 30 metres out from goal and snapped truly, giving Carlton our second flag in three years by the narrowest possible margin.In the following week, amid the euphoria of Premiership celebrations, Deacon rounded off that one special season when he and Henfry were announced as joint winners of Carlton\u2019s Best and Fairest trophy. Earlier, Bert had also worn the Victorian state guernsey at the 1947 National Championships, winning the K.G. Luke Trophy for the best Victorian player in the series, as well as a number of newspaper awards.Deacon\u2019s third Grand Final appearance came in 1949 , and again Carlton\u2019s opponent was Essendon \u2013 who battled their way into the flag decider largely due to the form of their star full-forward, John Coleman. Adding to the interest in a match between the Premiers of the previous two years, Coleman needed six goals to reach the magical 100 for the season, and Essendon were determined to give him every possible chance to get them.After an even, hard-fought first quarter, Essendon proved unstoppable and steadily increased their advantage over the Blues. By the last change, the margin had blown out to 57 points \u2013 but remarkably, Coleman had been held to just two goals by Carlton\u2019s close-checking full-back Ollie Grieve - and Deacon, who ranged across half back and cut off many attacks with strong marks.However, with the game won, Essendon concentrated on getting the ball to Coleman, and with just minutes remaining he ran on to a short pass and lined up for a shot at number 100. It was then that Deacon \u2013 ever the gentleman \u2013 trotted up beside the young star, put a hand on his shoulder and offered a word or two of advice. As he turned and walked away, Coleman sent the ball between the posts.That was to be Bert\u2019s last shot at Premiership glory with the Blues. A persistent muscle tear in one thigh had begun to trouble him, and in 1950 restricted him to just seven games. He saddled up again in 1951 , but by mid-year admitted that he was struggling and decided to call time on a memorable career. He played his last match against the old foe; South Melbourne, at the Lake Oval in round 11, 1951 . The Blueboys did the right thing by their champion, and farewelled him with a tenacious, thrilling 5-point win.In 1952 Bert returned to Preston as captain-coach for two seasons, before hanging up his boots to continue his role off-field. In his three further years, Deacon is reported to have played in every position on the ground except full-back, a position held firm by another Preston legend in Ted Henrys. In 1955, Deacon acted as non-playing coach before finally retiring from an active role. In 1955 , the Bullants made the VFA finals for the first time since Deacon had last played for them in 1941 . While at Preston, he retained his links at Carlton, and by 1958 was back at Princes Park in a variety of administrative roles. Later, he was elected to the committee, and in 1970 became club Secretary under President George Harris . Two more flags followed - in 1970 and 1972 - and no-one at Carlton was prouder than Bert Deacon.On January 3, 1974, Bert and his family were holidaying at Balnarring on the Mornington Peninsula, when he suffered a massive heart attack, and died before reaching hospital. He was just 51 years old. The football world was rocked to its core by the news, and there was widespread grief at the loss of one of football\u2019s favourite sons \u2013 a man whose dignity and integrity transcended club loyalties and brought him genuine admiration. Winning and losing mattered much to Bert Deacon, but so did how the game was played.The Deacon family tradition continued at Preston with his brother Bill acting as President from 1983 to 1987, a period that saw the club become the first in V.F.A. history to take out premierships at the Firsts, Seconds and Thirds levels in 1983 and again the following year. Bill's widow, Maisie has had the honour of the Preston and now Northern Bullant No. 1 membership for many years50 Games : Round 15, 1947 Vs Footscray100 Games : Round 2, 1951 Vs Footscray"}, {"url": "https://www.carltonfc.com.au/news/712053/moment-24-deacons-brownlow-medal", "page_content": "24. 1947 - Bert Deacon's Brownlow Medal\n\nVIEW THE 25 GREATEST MOMENTS HUB HERE\n\nThe man who would be Carlton\u2019s first Brownlow Medallist deftly adjusted the dial of his trusty bakelite radio. Flicking the knob with those long fingers famously used for plucking the pigskin of a Saturday afternoon, Bert Deacon pierced the crackle when he found station 3DB.It was early on the evening of Wednesday, September 3, 1947, and Bert and his dear wife, Jean, having already kissed goodnight to their baby boy Brian, pulled up a couple of armchairs at their modest home in Preston\u2019s Hawker Avenue. There they lent a collective ear to the station\u2019s broadcast of what would prove an historic medal count.As the votes were being cast, Deacon fully anticipated Richmond\u2019s Bill Morris to emerge with the gong ... not that he and his better half particularly cared. \u201cBert hadn\u2019t thought about the Brownlow Medal and I didn\u2019t even know what a Brownlow Medal was. I was a country bumpkin,\u201d said Jean, in an interview with this reporter a few months prior to her death in August 2009.\u201cWe had some friends, Jack Costello and his girlfriend Carol, who ran the Preston Hotel in High Street, who also came around to listen. When Bert\u2019s name was announced the visitors went out to their car and returned with beer and sandwiches, and by the time reporters turned up there was a beer and sandwich waiting. The other thing I remember that night was that Bert\u2019s brother-in-law (former St Kilda footballer William Maslen), who lived in Coburg at the time, rode his bike across to shake hands with him.\u201dWith votes awarded by field umpires on a basis of three for first preference, two for second and one for third, Deacon accrued four first preferences, three seconds and five thirds to emerge the victor with 23 votes. He overhauled St Kilda\u2019s Harold Bray by two votes.As The Herald\u2019s famed football writer Alf Brown declared. \u201cGreat consistency \u2013 he was awarded votes in 12 out of 18 games \u2013 helped Deacon to win the trophy. He scored four first votes and was equal first with Bill Morris (Richmond) after the first votes had been counted. With three seconds he crept to second place after the second votes had been counted \u2013 Bray led 21 to 18 \u2013 and with five third votes he won the medal from Bray, who did not score a point when the third votes were counted,\u201d Brown wrote.The record books show that Deacon represented Carlton in 106 senior matches from 1942 through to 1949, including the famous \u201cBloodbath\u201d Grand Final against South Melbourne in 1945 and the last gasp Grand Final victory over Essendon in \u201947. He also represented the Big V in 1947, \u201948 and \u201949 and was barely 50 matches into his senior career when he won the coveted Brownlow.The late Jim Clark, one of the last surviving members of the premiership teams of which Deacon was such an integral part, was recently asked to declare the best Carlton footballer he ever played alongside. \u201cOh easy,\u201d came the reply. \u201cBerty Deacon ... class .... one of the greatest ever. He was a Preston boy, married a girl from Kerang, and Bert and I were great cobbers. I got my first break with the seniors in 1943 and had the privilege of playing alongside him. He was not only a great footballer, but a bonza feller and a real gentleman. There will never be a better footballer, in my opinion, than Berty Deacon.\u201cBerty was around six foot and a half (184cm) but he had such long fingers he rarely dropped a mark, and he was a pro runner too \u2013 nearly every footy club had two or three pro-runners. He won the Brownlow Medal in \u201947 \u2013 a premiership year \u2013 and to win the Brownlow in a premiership year would have to be a prestigious Brownlow because a premiership team would have a lot of other chappies taking votes. But Berty had such superiority and he was as fair as fair as fair.\u201dIt says something of the character of the man that barely 24 hours after his famous Brownlow win, Deacon and Ken Luke paid an impromptu visit to Deacon\u2019s teammate Ron Hines, who was convalescing in Heidelberg hospital. A photograph which later appeared in The Herald shows Hines congratulating Deacon on his win with a handshake, as Ken Luke proudly watches on.The great Horrie Clover echoed the sentiments of all at Princes Park, who saw Deacon as a worthy recipient of the precious medal. \u201cI am very delighted that a Carlton player should at long last win the medal,\u201d Clover told a reporter from The Sun. \u201cWithout fear of contradiction I can say Bert Deacon is a great player and a great chap.\u201dObjective observers such as Alf Brown also concurred. \u201cFootball followers will applaud the selection of Bert Deacon as the winner of this year\u2019s award. He is one of the most brilliant players in the game \u2013 a sure, spectacular mark, a fast and clever ground player, and a defender whose courageous clearing dashes often put his side into attack,\u201d Brown wrote. \u201cDeacon, who is vice-captain of Carlton, is the best mark of a wet ball I have seen. He has remarkably big hands and this, undoubtedly, accounts for his ability to take spectacular finger-tip marks with either a greasy or dry ball.\u201cThe field umpires\u2019 votes for the Medal show that they have placed great emphasis on fairness as well as on ability. Deacon is scrupulously fair . . . \u201dBert Deacon was tragically lost to the football world when, on January 3, 1974, he suffered a fatal heart attack. Though only 51, the boy from the northern suburbs had dedicated 34 years to his beloved Blues.On New Year\u2019s Eve, 1991, Deacon\u2019s famous medal was stolen from his widow\u2019s purse during a house break-in. Thankfully, Jean received a replacement medal, struck when then-chief executive commissioner of the AFL the late Alan Schwab heard of her plight."}, {"url": "https://www.afl.com.au/news/503359/the-story-of-dudley-drew-and-the-lost-painting-of-bert-deacon", "page_content": "\n\nDudley Drew talks to CFC TV about his memories of his friend Bert Deacon, and about the painting he has just completed of Deacon completing a high mark over Richmond\u2019s Roy Smeaton at Punt Road.\n\nClick here to view the video\n\nBack in 1948, a budding Melbourne artist named Dudley Drew was trying to eke out an existence in his adopted profession when, on the advice of his dear mother, he resolved to paint somebody famous.\n\nDudley\u2019s Mum volunteered the name of Carlton centre half-back the late great Bert Deacon. After all, Deacon had just come off a stellar season, having taken out the 1947 Brownlow Medal, represented Carlton in its eighth premiership and earned Victorian and All-Australian selection.\n\nHow well Dudley remembers the moment. \u201cMy mother was blind, and when Bert won the Brownlow I was sitting with Mum in the bedroom talking to her one night and she said, \u2018You should paint a portrait of Bert Deacon\u2019,\u201d Dudley explained.\n\n\u201cI said \u2018Do you think it\u2019s a good idea?\u2019 and she said \u2018I think it will be wonderful for you\u2019. I then said \u2018How do I do this?\u2019 and she said \u2018Go and see him\u2019.\u201d\n\nDudley made his way to 2 Hawker Avenue, Preston, where Bert and Jean then lived. \u201cWhen I got there this particular night, around about seven o\u2019clock, Bert was already in bed because he was injured - he\u2019d injured his leg playing football, but he and Jean just welcomed me so much. It was great and I felt so proud,\u201d Dudley said.\n\n\u201cI then asked Bert if he would pose for the big portrait and he said \u2018I\u2019d be very happy to do that\u2019. He sat for the portrait about eight times and I remember in one sitting he began to smile, exposing this toothless gap. He was painted sporting grey trousers and navy blue blazer with the white V on the pocket and included in the painting is a trophy Bert also won for best afield for Victoria.\n\n\u201cTowards the end Bert said, \u2018You know I really love this painting and I\u2019m going to tell everybody about the greatest artist in the world\u2019, and he did. He sent many people to me to have their portraits painted. He was just great. No wonder I cried when he went to heaven.\n\nThough Bert and his wife Jean were thrilled with Dudley\u2019s gift, they had nowhere in their small home to hang the sizeable canvas. For a brief period the portrait found a wall in the city sports store of the former Collingwood footballer Ron Todd, but at some point in 1948 it was returned to Dudley\u2019s home and stored in a shed \u2013 which is where the work unfortunately came to grief.\n\nAs the artist explained, the painting toppled on to a steel table which pierced the canvas beyond repair.\n\nThe story might have ended then and there, were it not for this reporter\u2019s chance viewing of a photograph of the original portrait in a scrapbook in Jean\u2019s keep. Jean revealed that Dudley, now in his 80s, was the artist responsible and was alive and well in Melbourne\u2019s eastern suburbs.\n\nThe question then begged. Sixty years on, would Dudley be up for the job of repainting the portrait from the photograph of the original? Remarkably, Dudley explained that the very thought had recently crossed his mind and that yes, he would commit to the task of recreating the image of Deacon, who died suddenly while serving Carlton as club secretary back in 1974.\n\nAnd so it was that the new version of the old Bert Deacon was this week unveiled by Dudley in the presence of Bert\u2019s widow, Jean and son Robert. The portrait is basically true to the original, but boasts one slight embellishment - Dudley has painted in Bert\u2019s \u201947 Brownlow, which can be seen dangling from the trophy.\n\n\u201cTo think that 60 years on I\u2019ve brought that painting back to life,\u201d Dudley said. \u201cIsn\u2019t that a great story?\u201d\n\nDudley has also just completed a work of Deacon completing a high mark over Richmond\u2019s Roy Smeaton at Punt Road, based on a press photograph Bert handed him years before.\n\n\u201cBert had given me a copy of this photograph, which carried a handwritten message in the top left hand corner \u2013 \u2018To my friend Dud - regards, Bert Deacon\u2019,\u201d Drew said.\n\nRegrettably the photograph was later stolen and all was thought lost . . . until early last year when Jean again came to the rescue.\n\n\u201cI went out to Jean\u2019s house and sat down with her, during which time she showed me the family photo album . . . that\u2019s where I came across another copy of this photograph,\u201d Dudley said.\n\n\u201cI said to her, \u2018Jean, you must let me borrow this. I want to paint this picture\u2019. That happened about a year and a half ago\u2019.\u201d\n\nFor the past nine months, Drew, now in his early 80s, has put brush to canvas to recreate the Deacon image. The paint was still drying when he recently unveiled the canvas.\n\n\u201cBert actually told me that the Richmond fellow in front of the marking contest is George Smeaton and Jack Wrout is sandwiched between them,\u201d Drew said.\n\n\u201cRon Savage is the Carlton player watching on, but I\u2019m not sure of the identity of the other Richmond player.\u201d\n\nIt\u2019s not surprising that Drew is somewhat circumspect when asked what will become of the Bert Deacon artworks. Perhaps a Carlton-friendly benefactor might see fit to purchase the paintings and make them available on permanent loan to the Club.\n\n\u201cNobody knows the life of a painting,\u201d said the man who has also painted the portraits of such luminaries as Archbishop Daniel Mannix, King O\u2019Malley and \u201cWeary\u201d Dunlop.\n\nBut there can be no doubting the strength of the lifelong bond Dudley and Bert forged from the moment they met at the house in Hawker Avenue back in \u201948.\n\n\u201cI had a friendship with and a great admiration for this fellow, and his wife Jean,\u201d Dudley said.\n\n\u201cBert and I became great friends and I could tell you many stories about him. He was a wonderful man. The day he died I remember picking up a paper. It was all over the front page and I just cried.\n\n\u201cOne night we met in the city and we were on our way to my parents place in Albert Park for dinner. We caught the tram here as he didn\u2019t have a car then, nor did I. And I remember saying to him, I should have been as tall as you Bert, and he said to me \u2018Dud, diamonds were never made as big as bricks\u2019. So that made me feel good and every time I see someone bigger than me I think of the diamond.\u201d"}, {"url": "https://www.carltonfc.com.au/news/751558/dudley-drew-and-the-lost-painting-of-bert-deacon", "page_content": "\n\nDudley Drew talks to CFC TV about his memories of his friend Bert Deacon, and about the painting he has just completed of Deacon completing a high mark over Richmond\u2019s Roy Smeaton at Punt Road.\n\nClick here to view the video\n\nBack in 1948, a budding Melbourne artist named Dudley Drew was trying to eke out an existence in his adopted profession when, on the advice of his dear mother, he resolved to paint somebody famous.\n\nDudley\u2019s Mum volunteered the name of Carlton centre half-back the late great Bert Deacon. After all, Deacon had just come off a stellar season, having taken out the 1947 Brownlow Medal, represented Carlton in its eighth premiership and earned Victorian and All-Australian selection.\n\nHow well Dudley remembers the moment. \u201cMy mother was blind, and when Bert won the Brownlow I was sitting with Mum in the bedroom talking to her one night and she said, \u2018You should paint a portrait of Bert Deacon\u2019,\u201d Dudley explained.\n\n\u201cI said \u2018Do you think it\u2019s a good idea?\u2019 and she said \u2018I think it will be wonderful for you\u2019. I then said \u2018How do I do this?\u2019 and she said \u2018Go and see him\u2019.\u201d\n\nDudley made his way to 2 Hawker Avenue, Preston, where Bert and Jean then lived. \u201cWhen I got there this particular night, around about seven o\u2019clock, Bert was already in bed because he was injured - he\u2019d injured his leg playing football, but he and Jean just welcomed me so much. It was great and I felt so proud,\u201d Dudley said.\n\n\u201cI then asked Bert if he would pose for the big portrait and he said \u2018I\u2019d be very happy to do that\u2019. He sat for the portrait about eight times and I remember in one sitting he began to smile, exposing this toothless gap. He was painted sporting grey trousers and navy blue blazer with the white V on the pocket and included in the painting is a trophy Bert also won for best afield for Victoria.\n\n\u201cTowards the end Bert said, \u2018You know I really love this painting and I\u2019m going to tell everybody about the greatest artist in the world\u2019, and he did. He sent many people to me to have their portraits painted. He was just great. No wonder I cried when he went to heaven.\n\nThough Bert and his wife Jean were thrilled with Dudley\u2019s gift, they had nowhere in their small home to hang the sizeable canvas. For a brief period the portrait found a wall in the city sports store of the former Collingwood footballer Ron Todd, but at some point in 1948 it was returned to Dudley\u2019s home and stored in a shed \u2013 which is where the work unfortunately came to grief.\n\nAs the artist explained, the painting toppled on to a steel table which pierced the canvas beyond repair.\n\nThe story might have ended then and there, were it not for this reporter\u2019s chance viewing of a photograph of the original portrait in a scrapbook in Jean\u2019s keep. Jean revealed that Dudley, now in his 80s, was the artist responsible and was alive and well in Melbourne\u2019s eastern suburbs.\n\nThe question then begged. Sixty years on, would Dudley be up for the job of repainting the portrait from the photograph of the original? Remarkably, Dudley explained that the very thought had recently crossed his mind and that yes, he would commit to the task of recreating the image of Deacon, who died suddenly while serving Carlton as club secretary back in 1974.\n\nAnd so it was that the new version of the old Bert Deacon was this week unveiled by Dudley in the presence of Bert\u2019s widow, Jean and son Robert. The portrait is basically true to the original, but boasts one slight embellishment - Dudley has painted in Bert\u2019s \u201947 Brownlow, which can be seen dangling from the trophy.\n\n\u201cTo think that 60 years on I\u2019ve brought that painting back to life,\u201d Dudley said. \u201cIsn\u2019t that a great story?\u201d\n\nDudley has also just completed a work of Deacon completing a high mark over Richmond\u2019s Roy Smeaton at Punt Road, based on a press photograph Bert handed him years before.\n\n\u201cBert had given me a copy of this photograph, which carried a handwritten message in the top left hand corner \u2013 \u2018To my friend Dud - regards, Bert Deacon\u2019,\u201d Drew said.\n\nRegrettably the photograph was later stolen and all was thought lost . . . until early last year when Jean again came to the rescue.\n\n\u201cI went out to Jean\u2019s house and sat down with her, during which time she showed me the family photo album . . . that\u2019s where I came across another copy of this photograph,\u201d Dudley said.\n\n\u201cI said to her, \u2018Jean, you must let me borrow this. I want to paint this picture\u2019. That happened about a year and a half ago\u2019.\u201d\n\nFor the past nine months, Drew, now in his early 80s, has put brush to canvas to recreate the Deacon image. The paint was still drying when he recently unveiled the canvas.\n\n\u201cBert actually told me that the Richmond fellow in front of the marking contest is George Smeaton and Jack Wrout is sandwiched between them,\u201d Drew said.\n\n\u201cRon Savage is the Carlton player watching on, but I\u2019m not sure of the identity of the other Richmond player.\u201d\n\nIt\u2019s not surprising that Drew is somewhat circumspect when asked what will become of the Bert Deacon artworks. Perhaps a Carlton-friendly benefactor might see fit to purchase the paintings and make them available on permanent loan to the Club.\n\n\u201cNobody knows the life of a painting,\u201d said the man who has also painted the portraits of such luminaries as Archbishop Daniel Mannix, King O\u2019Malley and \u201cWeary\u201d Dunlop.\n\nBut there can be no doubting the strength of the lifelong bond Dudley and Bert forged from the moment they met at the house in Hawker Avenue back in \u201948.\n\n\u201cI had a friendship with and a great admiration for this fellow, and his wife Jean,\u201d Dudley said.\n\n\u201cBert and I became great friends and I could tell you many stories about him. He was a wonderful man. The day he died I remember picking up a paper. It was all over the front page and I just cried.\n\n\u201cOne night we met in the city and we were on our way to my parents place in Albert Park for dinner. We caught the tram here as he didn\u2019t have a car then, nor did I. And I remember saying to him, I should have been as tall as you Bert, and he said to me \u2018Dud, diamonds were never made as big as bricks\u2019. So that made me feel good and every time I see someone bigger than me I think of the diamond.\u201d\n\n\n\nPhoto Gallery\n\nClick here to view the Gallery of photos from the unveiling\n\nRelated Stories: Carlton Portraiture\n\nDecades on, Balharry Comes Through\n\nMonday, September 3, 2007\n\nA painting of former Carlton ruckman HW Balharry, pre-dating the VFL competition of 1897, has surfaced ... more\n\n\n\nBrushed up Bryce hits Canvas\n\nThursday, October 4, 2007\n\nBryce Gibbs as you\u2019ve never seen him before - a unique acrylic on canvas by Silvio Mannello ... more\n\n\n\nRelated Stories: The Blueseum\n\n60th Anniversary of historic Brownlow Medal count\n\nTuesday, September 25, 2007\n\nThe wife of the Blues\u2019 first medallist the late Bert Deacon, seeks assistance to find the 1947 medal ... more\n\n\n\n\n\n"}, {"url": "https://prabook.com/web/bert.deacon/2466480", "page_content": "Bert Deacon\n\nAustralian-rules footballer\n\nNovember 8, 1922 (age 51)\n\nA centre half back, Deacon began his league career in 1942. Deacon left Carlton after the 1951 season and became captain-coach for Preston in the Victorian Football Association (VFA), the club where he had played for prior to being recruited by Carlton. He later served as Carlton vice-president and club secretary. He is the centre half back in Carlton\"s official \"Team of the Century\". Office the field, Deacon worked for many years for long-serving VFL and Carlton president Sir Kenneth Luke. Bertram Deacon died of a heart attack on 3 January 1974 while on holiday at Balnarring. Deacon was just 51 years of age and died despite the desperate efforts of his Preston team-mate, Pat Foley to revive him."}, {"url": "https://www.dailymaverick.co.za/article/2021-12-26-archbishop-emeritus-of-cape-town-and-nobel-peace-laureate-desmond-tutu-lived-a-life-of-tenacity-constancy-and-courage/", "page_content": "Archbishop Emeritus Desmond Tutu and his wife Leah Tutu were one of the first people to cast their special vote in the local government elections at their home in Milnerton, Cape Town. (Photo: Brenton Geach)\n\nFirst published at AllAfrica.com\n\nSickly at birth, as an infant he survived polio, which left him with a permanently weakened right hand. As a teenager he suffered tuberculosis, which left adhesions on his lungs. Later in the 1980s, when he became, in Nelson Mandela\u2019s words \u201cpublic enemy number one\u201d to the apartheid regime, he survived a number of assassination attempts. And for the last 25 years of his life, he lived with recurrent bouts of prostate cancer.\n\nBut unlike two other iconic 20th century campaigners against structural injustice, Mahatma Gandhi and Martin Luther King Jr, he lived to see the first fruits of his radical but peaceful promotion of fundamental change in his own society. Not only that, he lived to bring the political leaders who liberated South Africa under the same piercing \u2013 at times angry \u2013 scrutiny to which he subjected the apartheid and other oppressive governments.\n\nTutu\u2019s advocacy ranged widely, beginning with appeals for sanctions against apartheid and continuing with campaigns against homophobia, for gender equality, against child marriage, against the occupation of the West Bank and Gaza, against oppression in nations from China and Burma to Panama, and in support of the \u201csecond wave\u201d of liberation which saw the growth of multi-party democracy across Africa from 1989.\n\nThe common factor which underlay Tutu\u2019s activism was his deep-rooted faith and its implications for how people \u2013 and later the environment \u2013 should be treated. If there was one thing which enraged him, it was to see the powerful inflict suffering on \u201cso-called ordinary people\u201d\u2014 \u201cso-called because in my theology nobody is ordinary\u201d.\n\nHe believed that every human being is created in the image of God, to be held in awe and reverence as if he or she is God. Therefore to mistreat a human being is not simply unjust, nor simply painful for the victim: it is blasphemous because it is \u201cspitting in the face of God\u201d.\n\n\u201cWhen I see innocent people suffering,\u201d he wrote, \u201cpushed around by the rich and powerful, then, as the prophet Jeremiah says, if I try to keep quiet it is as if the word of God burned like a fire in my breast.\u201d As he rose rapidly through the ranks of church leadership in the 1970s, he recognised that he was placing his life at risk. But he felt compelled to speak out, no matter the consequences.\n\nIn the 1970s, he was one of a generation of black church leaders who took office in multiracial South African churches, 80 percent of whose members were black, but which had until then been led by mostly white clergy. Emboldened by a confidence engendered by the philosophy of black consciousness, combined with theological studies undertaken abroad in Western democracies, the black theologians transformed churches into harbingers of what a liberated South Africa could look like.\n\nWith South Africa\u2019s most militant black leaders in prison, exile or internal banishment, and with the growing militant labour unions operating mainly on shop floors, the church leaders used their pulpits to become the most prominent anti-apartheid voices within South Africa at the time.\n\nThere was no difference between Desmond Tutu and most other black church leaders of his generation in their commitment to liberation. What most distinguished Tutu was his extraordinary powers of rhetoric and his willingness to alienate white Christians in declaring what he believed to be the truth.\n\nThe issue prompting his then-controversial appeals for economic sanctions against South Africa by the international community was the policy of forced removals. The apartheid government removed an estimated 3,5 million people \u2013 more than 10% of South Africans \u2013 from homes where many had lived for generations, and them dumped to eke out an existence in poverty-stricken rural \u201chomelands\u201d.\n\nIn sharply-worded, no-holds-barred attacks, Tutu skewered those he held responsible for apartheid\u2019s suffering, using language which got under the skins of white racists in a way few others could. When Cabinet ministers responded with fury, he would raise the stakes with even more defiant attacks. He told the apartheid government that they would go the way of Nero in Rome, of Hitler in Germany, of Amin in Uganda and Somoza in Nicaragua: they would, he said, \u201cbite the dust, and bite it comprehensively\u201d.\n\nWhen PW Botha, the apartheid president who operated military and police death squads, wagged his finger at him during a confrontation in 1988, Tutu angrily shook his finger back and told him: \u201cDon\u2019t think you\u2019re talking to a small boy!\u201d Abandoning restraint, he tore into Botha. \u201cI don\u2019t know whether that is how Jesus would have handled it,\u201d he said ruefully later, but \u201cour people have suffered for so long [and] I might never get this chance again.\u201d\n\nAs a consequence, Tutu was vilified and demonised, seen by some of his co-religionists as literally the devil incarnate for his strident denunciations of apartheid and support for sanctions to destroy it. He used to say that he had developed the hide of a rhinoceros in the face of attacks by white South Africans, but he actually found it painful to be the object of such hate. When, in contrast, he was lionised abroad, he became susceptible to the adulation which celebrity brought. But his spiritual confessor used to say that he had an acute self-awareness, and Tutu\u2019s coded acknowledgement of how he loved the limelight could be heard in his phrase, \u201cI love to be loved\u201d.\n\nOnce political apartheid was overthrown, and Tutu\u2019s friends had come to power, some of them began to disclose to him in confidence the mistakes their movement was making. He became an early critic of the new government, unable to keep to himself the criticisms which once again \u201cburned in his heart\u201d. Again, he denounced what he saw as misrule, sometimes using language as extravagant as that he had used against the perpetrators of apartheid \u2013 even against Mandela.\n\nWhen \u201cordinary\u201d people suffered, the old anger would return. In 2006, when Jacob Zuma went on trial for rape, his supporters heaped vilification and abuse on Zuma\u2019s accuser. Tutu pronounced Zuma unfit to rule because he failed to repudiate their behaviour. A month before Zuma became president in 2009, Tutu noted that he was doing so under suspicion of corruption, fraud, racketeering and money laundering: \u201cIs this why people died fighting apartheid?\u201d Tutu asked. \u201cIs this why people went into exile? Is this why people were tortured?\u201d\n\nAgain, those he censured often responded with scorn and derision. Typically, he would respond simply by saying he was \u201csad\u201d when he saw allies in the Struggle failing to live up to the high standards he set for them.\n\nTutu was born on October 7, 1931, the third child of Aletta Dorothea Mavoertsek Matlhare, a domestic worker, and Zacheriah Zililo Tutu, the principal of a church-run primary school. His older and younger brothers both died in infancy, leaving him with an older sister, Sylvia, and a younger sister, Gloria. The mortality rate in the family \u2013 40% \u2013 was average for a black South African family at the time.\n\nDesmond contracted polio before there was a vaccine and at a time when the death rate of sufferers in South Africa reached 25%. His father prepared for a funeral. Although he recovered, his right hand atrophied, leaving him with a weak grip and a lifelong habit of rubbing it to improve his circulation. Later, the propagandists of the apartheid-era South African Broadcasting Corporation turned the habit against him when he was under attack, their cameras zooming in on his hands as if he was wringing them in guilt.\n\nHe remained \u201cvery delicate\u201d through childhood, remembered his older sister, Sylvia, who died in 2020. He was diagnosed with tuberculosis at 15, when it was a disease of epidemic proportions in the overcrowded townships of post-World War 2 Johannesburg. At one stage during treatment, while coughing up blood, he resigned himself to death. He likely owed his life to the monks of the UK-based Community of the Resurrection (CR) \u2013 among whom the anti-apartheid activist Trevor Huddleston was the best known \u2013 who found him one of the few hospital beds available for black South Africans with TB.\n\nAdmiring the medical staff at the sanatorium to which he was confined for 21 months, he aspired to study medicine at the University of the Witwatersand. He was admitted to medical school but his family did not have the resources to pay for his study, and he followed his father into teaching instead.\n\nIn 1955, he married Nomalizo Leah Shenxane, also a teacher and a friend of his younger sister, Gloria. Leah \u2013 of whom he used to say that she was much more radical than he \u2013 was to become central to his achievements over their 66-year marriage. Soon after they married, Leah willingly joined him in giving up her teaching salary when they both decided to give up the profession in protest against what he called the \u201cthin gruel\u201d of apartheid education.\n\nAlthough active as a lay Christian, Desmond had not previously aspired to enter the church. \u201cIt wasn\u2019t for very highfalutin\u2019 ideals that I became a priest,\u201d he said later. \u201cThe easiest option was going to theological college.\u201d Leaving their two toddlers \u2013 Trevor Thamsanqa and Theresa Thandeka \u2013 with his parents, Desmond went to college in Johannesburg and Leah to a remote rural hospital to train as a nurse. Reunited afterwards, she struggled against the church\u2019s disregard of priests\u2019 wives. When Desmond was sent to Britain to study at King\u2019s College, London, in 1962, she successfully forced a showdown with the celibate monks who expected her to leave behind her children yet again.\n\nAfter four years and with a Master\u2019s degree in theology, Desmond returned home with Leah and their four children, Trevor and Thandi having been joined by Nontombi Naomi, born in Johannesburg, and Mpho Andrea, born in London. He taught at his alma mater, St Peter\u2019s College in Alice in the Eastern Cape, which had been forcibly removed from Johannesburg under apartheid and had become part of the inter-church Federal Theological Seminary (Fedsem) next door to the University of Fort Hare.\n\nTutu was to say later that he returned to South Africa as a theologian who did not question conventional Western thinking. But his first-hand exposure at Fedsem to the thinking of students such as Steve Biko and Barney Pityana, and his first experience of the use of state power to suppress dissent at Fort Hare in 1968, began to change his worldview.\n\nSpeaking three decades later, Professor Pityana described what happened when the university authorities expelled the whole student body after protests: \u201cWe had been surrounded by police, with dogs snarling at us. We were petrified for nearly two hours. Some people were crying\u2026 The staff of the university, the white people \u2013 some of them armed \u2013 these professors were watching and nobody said a word, nobody.\u2026 Desmond [came] almost from nowhere, in a cassock\u2026 broke the police cordon and came to be among us. I recall moving scenes of young women kneeling to pray with Desmond for blessings. Even today when I recall that I get very emotional.\u201d\n\nAfter subsequently teaching at the then University of Botswana, Lesotho and Swaziland in Roma, Lesotho, Tutu was offered the job of Africa secretary to a theological education fund of the World Council of Churches. Based in London, he paid 48 visits to 25 African countries over a three-year period, learning of successes achieved and pitfalls encountered by newly-independent nations across the continent. This was to stand him in good stead 30 years later when he began, earlier than most, to see the mistakes being made in newly-liberated South Africa. He also honed his theological thinking, drawing equally on what he saw as the strengths of the black theology being developed in the United States, African theology in newly-independent African nations, and the liberation theology of Latin America.\n\nWhen Tutu returned to South Africa as the first black Anglican dean of Johannesburg in 1975, he brought to the post a nuanced view of leadership in a South Africa that was about to be thrown into tumult by the Soweto uprising. \u201cI am firmly non-racial and so welcome the participation of all, both black and white, in the Struggle,\u201d he said. \u201cBut\u2026 at this stage the leadership of the Struggle must be firmly in black hands\u2026. However much [whites] want to identify with blacks it is an existential fact\u2026 that they have not really been victims of this baneful oppression and exploitation. It is a divide that can\u2019t be crossed and that must give blacks a primacy in determining the course and goal of the struggle. Whites must be willing to follow.\u201d\n\nFrom the pulpit of St Mary\u2019s Cathedral, Johannesburg, he began to speak out against apartheid, becoming widely known first for a 2,600-word letter to apartheid Prime Minister BJ Vorster, in which he wrote of \u201ca growing nightmarish fear\u201d of the inevitability of \u201cbloodshed and violence\u201d unless a national convention of legitimate leaders was convened to steer the country to democracy. Five weeks later the children of Soweto initiated the uprising of June 16, 1976.\n\nHe was not to stay at the cathedral for long. Within a year he was elected bishop of Lesotho and then recalled home two years later to become general secretary of the South African Council of Churches (SACC). It was in that capacity that he first saw the extent of the suffering caused by forced removals, and was moved particularly by an exchange with a young girl in one of apartheid\u2019s rural dumping grounds. It ended with him asking her: \u201cWhat happens if you can\u2019t borrow food?\u201d She replied: \u201cWe drink water to fill our stomachs.\u201d\n\nIn the first of a series of letters to PW Botha, he angrily denounced the removals as \u201cutterly diabolical and unacceptable to the Christian conscience\u2026\u201d Ignoring church lawyers\u2019 warnings that he risked being jailed under the government\u2019s draconian Terrorism Act of 1967, he began lobbying for sanctions overseas and was instrumental in persuading the Canadian and French prime ministers, and the United States Congress, to impose sanctions in the 1980s.\n\nThe drive for sanctions, perceived by the apartheid government as a bigger threat to its existence than the liberation movements\u2019 armed struggle, and the hatred it engendered among white South Africans, likely generated the most serious threats to his life. An order by a South African army officer to security forces to shoot him and his fellow clergymen, SACC president Peter Storey was disobeyed by black soldiers; the sabotage of the front tyre of a hired car at an airport was thwarted by an observant television cameraman and, ironically, a young white military officer; and an unsuccessful attempt by the \u201cCivil Cooperation Bureau\u201d, which operated military death squads, to recruit an ex-convict to kill him.\n\nIf the government had been brazen and determined enough, they could have had him killed. They made more serious attempts on the lives of other church leaders, notably Smangaliso Mkhatshwa, secretary-general of the Southern African Catholic Bishops\u2019 Conference, and Frank Chikane, a successor to Tutu as general secretary of the SACC. What probably saved Tutu was the fact that assassinating him \u2013 even jailing him \u2013 would have precipitated the very sanctions the government sought to avoid, especially after the Norwegian Nobel Committee awarded him the 1984 Peace Prize.\n\nDesmond Tutu\u2019s advocacy of sanctions was strongly resisted not only by supporters of apartheid, but by its liberal opponents. He argued with the opposition parliamentarian, Helen Suzman, telling her that when she said sanctions wouldn\u2019t work she was saying in effect that the last peaceful option for ending apartheid had been exhausted.\n\nFor Tutu, accepting that conclusion would have been momentous, for he would have had no option but to subscribe to armed Struggle. Never a pacifist in the mould of Gandhi or King, he embraced instead the just war theory. Originally developed by the African saint, Augustine of Hippo, and later the Italian monk, Thomas Aquinas, just war holds that it is legitimate to turn to violence when all peaceful means of bringing about change have been exhausted. When abroad, Tutu vigorously defended the liberation movements\u2019 decisions to launch armed struggle, but he never reached the point of endorsing them himself.\n\nThere was a period during the 1980s when international church campaigners for justice saw Tutu, at least in the West, as the world\u2019s most prominent religious leader after Pope John Paul II. The difference between the two leaders, one observed, was that John Paul II preached freedom and peace from the pulpit, Tutu \u2013 with fellow church leaders \u2013 promoted it on the streets.\n\nDuring the final uprising against apartheid which began in 1984 and continued until the elections of 1994, Tutu, Chikane, Storey, Tutu\u2019s deputy in the church, Michael Nuttall, and countless other clergy were repeatedly called upon to defuse violent confrontations between police and angry young people.\n\nTime and again, Tutu moved into the space between young people armed with bricks and stones on one side, and troops and police and soldiers with fingers on their triggers on the other. Time and again he roused the passions of the young with rabble-rousing rhetoric which scared the bejesus out of some of his white bishops, then channelled the anger of the crowd into constructive action with humour and stern admonition.\n\nAnd when black South Africans, pinned into ghettoes by troops and police, turned on one another at the height of the internal struggle against apartheid, Tutu joined his fellow clergy in facing down youngsters determined to attack those they saw as collaborators with apartheid.\n\nMost memorably, supported by friends such as Simeon Nkoane, a monk who became a bishop on the East Rand, and Leo Rakale, the monk who was the model for one of Alan Paton\u2019s principal characters in Cry the Beloved Country, he stepped in to rescue \u201cimpimpis\u201d \u2013 those accused of being police spies \u2013 from fiery, agonising deaths at the hands of comrades who sought to force tyres soaked with petrol over their bodies, then to set them alight.\n\nThe response of a British father who joined an adoring congregation in St Alban\u2019s Cathedral, north of London, to celebrate Tutu a few years later, was typical: \u201cThat,\u201d he told his son, \u201cis a very brave man.\u201d In New York, it was more his post-Nobel prize celebrity that evoked similar reactions. As he processed out of a packed Cathedral of St John the Divine, young people pressed to get close enough to touch his cassock as he passed.\n\nDesmond Tutu never joined the African National Congress (ANC), which has been the governing party since apartheid fell. But he was publicly associated with the movement from the time he became an early supporter of the domestic campaign to free Nelson Mandela. When abroad, Tutu would insist on meeting the ANC\u2019s exiled leader, Oliver Tambo \u2013 viewed by the apartheid government as a terrorist. Upon his return, he would announce his meetings and expound on Tambo\u2019s virtues as a committed Christian.\n\nHowever, as a church leader Tutu made efforts to eschew partisanship, agreeing in the 1980s to become a patron both of the United Democratic Front, aligned with the ANC, and the National Forum, a rival, black consciousness-aligned group of organisations. Most controversially in the church, soon after Mandela was released, Tutu banned priests in his church from joining any political party on the grounds that it would prevent them from ministering in congregations whose members belonged to competing parties.\n\nAlthough it did not become apparent to most white South Africans until after Mandela\u2019s release, Tutu had deep compassion for them. Apartheid dehumanised the oppressor more than it dehumanised the oppressed, he said. He supported conscientious objectors who refused compulsory military service and helped some flee abroad. He was thrilled when hundreds of young white South Africans joined the 1989 Defiance Campaign in Cape Town, which ramped up pressure on the newly-elected president, FW de Klerk, and helped to clear the way for Mandela\u2019s release.\n\nHe had a particular respect for repentant Afrikaners, and he longed in vain for De Klerk to follow in the footsteps of the dissenting white church leader, Beyers Naud\u00e9, who broke with his community and uninhibitedly backed the ANC in its struggle.\n\nAfter Mandela\u2019s release, Tutu announced that he had been an \u201cinterim leader\u201d while political leaders were jailed or in exile. He would still speak out on political issues as a church leader, he said, but he would now take a lower profile. When intra-communal violence broke out in black communities \u2013 sparked or stoked by forces of reaction seeking to stall the transition to democracy \u2013 Tutu and his fellow church leaders moved instinctively from anti-apartheid campaigning to trying to mediate among the leaders of rival political parties and defusing violence among their supporters.\n\nIt was presumably both for Tutu\u2019s credibility as an outspoken supporter of liberation and his role as a mediator that in 1995 Dullah Omar, President Mandela\u2019s justice minister and an admirer of Tutu\u2019s peacemaking on the streets, recommended him to chair of the post-apartheid Truth and Reconciliation Commission.\n\nThe commission was the product of a toughly-negotiated compromise between, on the one hand, those in the liberation movements who wanted apartheid leaders put on trial, and on the other, the leaders of the old regime who wanted blanket amnesty for their security forces, as had been granted in other countries transitioning to democracy. The uniquely South African compromise \u2013 amnesty but only in exchange for the truth \u2013 was forced upon Parliament by the fact that the liberation movements did not have military power commensurate with their legitimacy, and the old regime did not have enough legitimacy to continue to rule with military power alone.\n\nAlthough the commission was thus born as a consequence of realpolitik, Tutu seized it as an instrument of reconciliation. His approach was in line with a three-step process founded in his faith. In the first step, he said, those who had wronged others needed to confess their crimes \u2013 as they were required to do to receive amnesty. In the second step, he urged survivors and victims to consider forgiving perpetrators.\n\nIn the pulpit, Tutu would preach that victims were under a \u201cGospel imperative\u201d to forgive. But then, in the third step, those who had committed wrongs had to make restitution: \u201cIf I have stolen your pen, I can\u2019t really be contrite when I say, \u2018Please forgive me,\u2019 if at the same time I still keep your pen. If I am truly repentant, I will demonstrate this genuine repentance by returning your pen.\u201d\n\nThe most trenchant criticism of the truth and reconciliation process is that it failed to deal with mass violations of human rights such as forced removals, the pass laws which restricted the movements of black South Africans, and an inferior education system. The consequence was that the beneficiaries of apartheid were able to transfer the principal blame for the suffering it caused on a small coterie of its enforcers.\n\nHowever, dealing with those mass violations was not the mandate given to the commission by Parliament. Its task, initially to be completed in 18 months, was limited to investigating and reporting on gross violations of human rights \u2014 defined as killing, abduction, torture, and severe ill-treatment \u2014 in the period between the Sharpeville massacre of 1960 and Mandela\u2019s inauguration in 1994.\n\nWithin those constraints the commission succeeded in identifying and formally declaring as victims or survivors of violations more than 21,000 people. Backed by the threats of prosecutors, it also succeeded in flushing out members of police death squads, although the apartheid military largely boycotted the commission. While this has not yet been adequately researched, the process also reconciled many in black communities who fought on different sides of the Struggle.\n\nTutu\u2019s two greatest disappointments were the failure of most white South Africans to take the hand of reconciliation offered to them by black South Africans, and of the ANC government\u2019s failure to prosecute those who refused to apply for, or were denied, amnesty. He was also upset that the government failed to implement in full the commission\u2019s recommendations for token monetary grants which were part of its proposals for restitution.\n\nOnce the commission had completed its work, he was judged by most of his fellow commissioners to have been essential to the process, although he came in for widespread criticism for being overly sympathetic to Winnie Madikizela-Mandela and treating her with kid gloves during a hearing into human rights violations committed by her bodyguards during the late 1980s.\n\nIn 1988 Desmond Tutu was elected president of the All Africa Conference of Churches. Armed with his 1970s experiences, he made it a priority to travel to countries governed by oppressive rulers. Trading on his anti-apartheid credentials and celebrity to gain access to heads of state, he secured local church leaders audiences to press their cases for greater freedom for their people.\n\nHe also campaigned publicly for democracy and human rights. In Mobutu\u2019s Za\u00efre, Mengistu\u2019s Ethiopia, Bashir\u2019s Sudan and General Manuel Noriega\u2019s Panama, he preached to crowds, condemning specific human rights violations experienced in South Africa. His audiences responded with delight as they realised he was listing violations also being perpetrated upon them, although in Addis Ababa he was told an interpreter had been too scared to translate him accurately into Amharic.\n\nLater, President Mandela sent him to Nigeria to plead for the release of MKO Abiola, the winner of the 1993 election who had been detained after the military annulled the result. In an audience with General Sani Abacha, Tutu insisted on seeing Abiola, then publicly lambasted the general for lying to him about the conditions of Abiola\u2019s detention.\n\nAfter the 1994 Rwandan genocide and the subsequent flood of refugees into what was then Za\u00efre, he co-chaired a summit of heads of state from the Great Lakes Region, organised by former US President Jimmy Carter. There he challenged Uganda\u2019s President Yoweri Museveni over whether the death penalty should be used in trials of the perpetrators of the massacres.\n\nIt was one of Tutu\u2019s aphorisms that an \u201cAfrican communist\u201d is a contradiction in terms, if communism is defined as atheistic and materialistic \u2013 Africans are naturally spiritual beings, he said. On visits to Angola and Ethiopia, he asked ruling party officials how many true Marxists there were in their ranks \u2013 then relayed their surprisingly small estimates to delighted local church leaders.\n\nWhile Desmond Tutu was an enthusiastic ecumenist and promoter of inter-faith dialogue, he remained first and foremost an Anglican Christian, whose life was sustained by a deep spirituality and a firm faith \u2013 never lost in the face of injustice, despite sometimes clinging to it \u201cby the skin of my teeth\u201d.\n\nHe dismissed the Western convention of distinguishing between religion and politics. Separating the sacred from the secular was, he said, a result of the \u201cbaneful influence\u201d of \u201cHellenistic dualism\u201d on Western thought. He instead advocated an African worldview: God is the God of all life, whether religious or political. In this he could impress even sceptical American neoconservatives: the Catholic intellectual, Michael Novak, reviewing a collection of his writings and sermons, concluded: \u201cThe consistency of the thing is beautiful.\u201d\n\nTutu was an articulate exponent of what is described in his father\u2019s home language \u2013 isiXhosa \u2013 as ubuntu and in his mother\u2019s \u2013 Setswana \u2013 as botho, expressed best in the proverb \u201ca person is a person through other people\u201d. In his formulation, ubuntu or botho is Africa\u2019s gift to the world: a model for expressing the nature of human community and of all creation as a delicate network of interdependence, one which speaks of a global society in which there are no outsiders but all are insiders, created in God\u2019s image, and in which the welfare of every individual depends on the welfare of the other.\n\nAlthough he supported the secular foundation of the South African state, he opposed too rigid a separation of church and state. He thought it too sharply drawn in the United States and was disappointed when the new, democratic South African Parliament adopted a practice of opening proceedings with a time of silence. He felt that since the vast majority of South Africans were believers, there should be a rotating roster of prayers reflecting different religious traditions.\n\nDesmond Tutu had extraordinary personal qualities. The South African writer and Nobel literature laureate Nadine Gordimer said of him: \u201cHe has no fa\u00e7ade. The open interest, the fellow warmth that radiates from him\u2026 are what he is. I\u2019d call his lack of self-consciousness one of inherent gifts, the others have been developed by the exercise of character, the spiritual and intellectual muscle-building he has subjected and continues to subject himself to in service of the human congregation.\u201d\n\nHumour, deployed to serious effect when trying to defuse violence, and cackles of uproarious laughter were a Tutu trademark. But he observed that laughing and crying were often separated by a thin line, and he cried nearly as easily as he laughed \u2013 again, particularly when he witnessed the suffering of the innocent.\n\nHis lively personality was also the flip side of up to six or seven hours of silent prayer or worship spread through the day, usually beginning at around 4am when he was archbishop. A Canadian journalist who travelled with him on a difficult mission to Liberia wrote: \u201cInside this man whom much of the world knows as an ebullient, laughter-filled extrovert, a Nobel Peace laureate who holds audiences and congregations spellbound, lives a meditative, contemplative person\u2026\u201d\n\nTutu could combine the strict demeanour of an authoritarian bishop with the compassion of a gentle pastor who had an extraordinary capacity to fix in his mind and remember intimate personal details about people he had just met. His rapid ascent from priest to college lecturer to dean to bishop meant that his assignments as a full-time parish priest were short. But he took pride in his pastoral skills and combined his general secretary\u2019s duties at the South African Council of Churches with part-time supervision of a parish in Soweto.\n\nHe fervently supported the ordination of women as priests, the ordination of gay and lesbian priests and the blessing of same-sex unions, on the same grounds that he opposed apartheid \u2013 he could not accept discrimination against a group of people on the basis of an attribute they could not change, whether it was their race, their gender or their sexual orientation. In this he dissented from the stance of African Anglican churches, having to watch from the sidelines in retirement as his youngest daughter, Mpho, gave up her licence to act as a priest in South Africa when she married her wife.\n\nHe threw himself unreservedly and passionately into the causes he supported, often experimenting with new initiatives based on his gut feelings and uninterested in conducting post-mortems when they failed. He freely took risks, such as when, at the suggestion of an evangelical Oxford University chaplain, he made an \u201caltar call\u201d to a largely secular audience in the Oxford Union. Not a single person stood up to \u201cgive my life to Christ\u201d. Apparently unfazed, he moved on with no sign of concern.\n\nHe could also be quietly and teasingly provocative, once strolling around during a meeting of Anglican archbishops in Northern Ireland wearing a newly-acquired fisherman\u2019s sweater in rich Republican green.\n\nHe recognised that during the early years of his public life, he owed much of his influence to journalists who reported what he was saying. As a result he gave priority to speaking to them and was on friendly terms with the vast majority. Tough questioning by critical reporters helped him hone his arguments, and he developed a particular regard for the most sceptical, enjoying sparring with them. He almost never spoke off the record and was known at the Truth and Reconciliation Commission for his frankness.\n\nHe would not tolerate his integrity being impugned \u2013 he twice nearly derailed the commission in clashes with other commissioners when he felt it was being questioned. Damaging stand-offs were averted only when he brow-beat them into backing down.\n\nBut in public life, after years of denouncing injustice in no-holds-barred, unnuanced terms, once South Africa began to move to democracy, he began to feel that he had been too self-righteous and abrasive. He took to heart criticism from Lucas Mangope, one of the black leaders who took \u201cindependence\u201d under the apartheid system, that the churches had isolated and failed to extend pastoral care to them.\n\nTutu had a rocky relationship with Prince Mangosuthu Buthelezi, who worked within the system but resisted pressure from the apartheid government for the Zulu nation to give up their South African citizenship. But neither man gave up on trying to reach out to the other. Buthelezi, an Anglican, regularly agreed to meet \u201cmy archbishop\u201d when Tutu was trying to mediate peace in the transition to democracy, and Tutu subsequently invited him to family celebrations.\n\nTutu\u2019s attitude to money was utilitarian and he was accused by many of being a spendthrift. His wife, Leah, sometimes teasingly described him as a professional beggar; when he became archbishop of Cape Town, he told his staff that he knew how to raise money, he certainly knew how to spend it but that he left church treasurers to manage it. After retirement he earned substantial sums on the American speakers\u2019 circuit, where he was popular and highly regarded for his rhetorical skills. This secured him a financial independence which helped enable him to continue to speak his mind.\n\nExcept for travelling first class on airlines \u2013 enabling him to sleep properly and reducing the potential for other passengers to disturb him \u2013 he tried to live simply, retaining his home in Soweto until recently, and spending most of his time after retirement in a modest seaside suburb in Cape Town. His other tastes were also simple, and sweet: a rum and coke until medical treatment ended it, and rum and raisin ice-cream if it was available. If it wasn\u2019t, Leah would tell hosts, in choosing an alternative \u201cjust think of a five-year-old\u201d.\n\nHis decision in 1975 to uproot his family from London and return home to become dean of Johannesburg, strained their marriage. Back at home, Leah was whipped by police in a way he never was and harassed by traffic policemen who once arrested her, handcuffed her and dragged her to a police charge office \u2013 for late payment of her car licence. He reserved a special anger for those he thought were punishing him by attacking his family, and he felt guilt for not being able to protect them.\n\nA turning point in their marriage came for him when he was under fire from a police minister who was attacking him for his outspokenness. Should he keep quiet? he asked Leah. No, she said, she would far prefer him happy and imprisoned on Robben Island than unhappy and frustrated outside. She went on to march against apartheid with him.\n\nHe loved to give money away to his and Leah\u2019s favourite causes, such as the nutrition clinics founded by his physician for more than three decades, Dr Ingrid le Roux, and the work done by the renowned Stellenbosch University expert on tuberculosis, Professor Nulda Beyers. He and Leah were also patrons of the Phelophepa (good clean health) Trains, bringing attention and support to trains operating as mobile healthcare hospitals in impoverished rural areas.\n\nHis vocation as a priest recognised no distinction between work and personal life, which meant that his family had to share much of their time with him with others. Challenged by an outside consultant when he first became archbishop to rank the priority of time with family against the priorities of his office, he refused.\n\nHe is survived by Leah, his children \u2013 Trevor Thamsanqa Tutu, Theresa Thandeka Tutu-Gxashe, the Reverend Naomi Nontombi Tutu and the Reverend Mpho Andrea Tutu van Furth, and by grandchildren and great-grandchildren. DM\n\nJohn Allen, a former managing editor of AllAfrica, covered Desmond Tutu as a journalist for 45 years and was his press secretary for 13 of them. He is the author of the definitive Tutu biography, Rabble-Rouser for Peace, and the compiler and editor of three volumes of key Tutu texts. He has worked with the Apartheid Museum on Truth to Power, an exhibition on Desmond Tutu and the churches\u2019 roles in the Struggle, scheduled to open in 2022."}, {"url": "https://www.carltonfc.com.au/news/299729/family-reclaims-precious-deacon-artefact", "page_content": "Seventy years after the late Bert Deacon\u2019s best and fairest, Brownlow and Grand Final-winning season for Carlton, the Deacon family has reclaimed a timber-cased mantel clock awarded to him by the Club in 1947.\n\nThe art deco clock was presented to Deacon in the year he tied for what was then the Robert Reynolds Trophy (now John Nicholls Medal) with the then club captain Ern Henfry. The clock carries a silver-plated plaque upon which are inscribed the following words;\n\nCARLTON FOOTBALL CLUB\n\nEqual Best & Fairest\n\n1947\n\nWon by\n\nBert Deacon\n\n\n\nThe inscription on the mantel clock.\n\nAccording to the Carlton Annual Report of that year, only the trophies to Deacon and Henfry were presented in that year, along with an award to Jack Bennett for Most Consistent Player.\n\nAs the then secretary Harry Bell reported: \u201cApart from the two above-mentioned trophies your Committee decided to suspend all other club awards, as in their opinion the 21 players in the Final games had contributed equally in bringing the flag to Carlton, and therefore they felt that all should share equally in the other trophies, with the result that at the Annual Meeting, each of the remaining 18 players will be presented with a trophy to mark the winning of the premiership\u201d.\n\nFor almost 60 years, the clock sat on the mantelpiece in the loungeroom of the Deacon family home at 146 Wood Street, Preston. According to Bert\u2019s son Bob, \u201cthe clock was there from the time Dad and Mum built the house in 1950 until the day we moved after Mum died about seven years ago\u201d.\n\n\n\nDeacon's mantel clock.\n\nIn clearing the house after the death of their mother Jean, Bob and his older brother Brian resolved to share items with family friends. An old friend of Jean\u2019s from Kerang was given the mantel clock, but recently on-sold it to a dealer in Moonee Ponds. The dealer then arranged for the clock to go under the hammer through an auctioneer in Woodend last Sunday, by which time the Deacon boys were alerted.\n\n\u201cYou give the item away in good faith and you don\u2019t think any more of it \u2013 and then you get an email the Friday before the sale with an image of the mantel clock in the auction room,\u201d Bob said.\n\n\u201cBrian and I weren\u2019t happy that the item had ended up in an auction house and we initially thought the clock might have been stolen until we did a bit of investigating. The auctioneer to his credit was going to withdraw the item until it was determined the clock hadn\u2019t been stolen so I then instructed him to bid on the Deacon family\u2019s behalf, and it\u2019s such a relief that the item is now back with the family.\u201d\n\nFrom 1942, Bert Deacon represented the Carlton Football Club in 106 senior matches through a ten-year career interrupted by war. On January 3, 1974, he died of a heart attack in Balnarring, and at the time of his death officiated as Carlton secretary.\n\n\n\nThe famous Bert Deacon in action for Carlton.\n\nIt\u2019s not the first time that Bert\u2019s prized football artefacts have been lost to the Deacons. The coveted Brownlow Medal was stolen from Jean\u2019s purse (together with her father\u2019s war medals) in a kitchen break-in while she was gardening out the front of the Wood Street home. None of the medals were ever recovered, and a Brownlow replica is now in the keep of Brian\u2019s son.\n\nBob proudly protects the VFL certificate awarded to his father for winning the prized football trophy \u2013 and now the mantel clock.\n\nSo what will become of the item? According to Bob, it will be offered as a perpetual trophy to the winner of the Bert Deacon Golf Day tournament, which has been held at Flinders on the Wednesday between Christmas and New Year since 1950.\n\n\u201cIf the golf day folds, the clock will again be returned to the family,\u201d Bob said.\n\n\u201cBut for as long as it\u2019s in circulation, Dad will be remembered.\u201d"}, {"url": "https://wikidiff.com/tenacity/courage", "page_content": "Tenacity vs Courage - What's the difference? tenacity | courage |\n\nAs nouns the difference between tenacity and courage is that tenacity is the quality or state of being tenacious; as, tenacity, or retentiveness, of memory; tenacity, or persistency, of purpose while courage is the quality of a confident character not to be afraid or intimidated easily but without being incautious or inconsiderate.\n\n\n\nAs a verb courage is to encourage. is thatis the quality or state of being tenacious; as, tenacity, or retentiveness, of memory; tenacity, or persistency, of purpose whileis the quality of a confident character not to be afraid or intimidated easily but without being incautious or inconsiderate.to encourage. tenacity English Noun (tenacities) The quality or state of being tenacious; as, tenacity, or retentiveness, of memory; tenacity, or persistency, of purpose. * 2009 , , PHD Comics: Softball: younger and faster \u2014 Our opponents may be younger, faster and less out of shape than we are, but we have something they\u2019ll never have! \u2014 Tenure? \u2014 Tenacity! The quality of bodies which keeps them from parting without considerable force; cohesiveness; the effect of attraction; \u2013 as distinguished from brittleness, fragility, mobility, etc. The quality of bodies which makes them adhere to other bodies; adhesiveness; viscosity. The greatest longitudinal stress a substance can bear without tearing asunder, \u2013 usually expressed with reference to a unit area of the cross section of the substance, as the number of pounds per square inch, or kilograms per square centimeter, necessary to produce rupture. Synonyms * (state of being tenacious) retentiveness, persistency * (quality keeping bodies together) cohesiveness * (quality making bodies adhere) adhesiveness, viscosity Antonyms * (quality keeping bodies together) brittleness, fragility, mobility courage English Noun (-) The quality of a confident character not to be afraid or intimidated easily but without being incautious or inconsiderate. \"A great part of courage is the courage of having done the thing before.\" \u2014 It takes a lot of courage to be successful in business. The ability to do things which one finds frightening. \"Courage is not the absence of fear. It is acting in spite of it.\" \u2014 He plucked up the courage to tell her how he felt. Synonyms * See also Derived terms * courageous * discourage * encourage Related terms * cardiac Verb (courag) (label) To encourage. *: *:And wete yow wel sayd kynge Arthur vnto Vrres syster I shalle begynne to handle hym and serche vnto my power not presumyng vpon me that I am soo worthy to hele youre sone by my dedes / but I wille courage other men of worshyp to doo as I wylle doo *(William Tyndale) (1494-1536) *:Paul writeth unto Timothyto courage him. See also * fearlessness * bield * fearlessness * bield English abstract nouns ----"}, {"url": "https://www.indiatoday.in/education-today/gk-current-affairs/story/all-you-need-to-know-about-the-fierce-rajput-king-rana-sanga-1157581-2018-01-30", "page_content": "By India Today Web Desk: Maharana Sangram Singh was a fierce Rajput king who was known for his courage and tenacity. The king belonged to the Sisodiya clan of Rajput and was born on April 12, 1482.\n\nRead on to know more about him:\n\nMaharana Sangram Singh, or popularly known as Rana Sanga, was the grandson of Rana Kumbha, and the son of Rana Raimal\u00e2\u0080\u008b\n\nadvertisement He became the King of Mewar in 1508, after a battle of succession with his brothers, and ruled till 1528\n\nHe was the last ruler of medieval India who stood, united several Rajput states, and fought against the foreign invaders despite losing one arm, one eye and had close to 80 wounds on his body\n\nBattle of Khatoli\n\nIt was fought against Ibrahim Lodi in 1518. Both the armies met near the village of Khatoli on the borders of Haravati (Haraoti). The Sultan\u2019s army gave up and left the battleground after fighting for five hours. Rana Sanga captured a Lodi prince as a prisoner and released him after a few days on payment of a ransom. It was during this battle that the Maharana lost an arm by a sword cut, and an arrow made him lame for life\n\nDuring his rule, Mewar touched the pinnacle of prosperity and he developed and protected his environment from invasions from the Muslim rulers of Delhi, Gujarat, and Malwa\n\nBattle of Khanwa\n\nIt was the second major battle fought in modern-day India, after the Battle of Panipat. Rana united the Rajput and fought against the invading forces of the Mughal Emperor Babur. The fight was intense, but the Rajputs lost in the end.\n\nMaharana Sangram Singh died soon after, on January 30, 1528. It is believed that he was poisoned by some of his own chiefs who held his plans of renewing the fight with Babur to be suicidal\n\nThough he lost the battle to Babur, his tenacity and courage inspired many other kings including Rana Pratap\n\nInterested in General Knowledge and Current Affairs? Click here to stay informed and know what is happening around the world with our G.K. and Current Affairs section.\n\nTo get more updates on Current Affairs, send in your query by mail to education.intoday@gmail.com"}]}